/*
 * This test is for collations and character operations when using the
 * builtin provider with the C.UTF-8 locale.
 */

/* skip test if not UTF8 server encoding */
SELECT getdatabaseencoding() <> 'UTF8' AS skip_test \gset
\if :skip_test
\quit
\endif

SET client_encoding TO UTF8
ERROR: /*
 * This test is for collations and character operations when using the
 * builtin provider with the C.UTF-8 locale.
 */

/* skip test if not UTF8 server encoding */
SELECT getdatabaseencoding() <> 'UTF8' AS skip_test \gset
\if :skip_test
\quit
\endif

SET client_encoding TO UTF8

Parser Error: syntax error at or near "\"


--
-- Test PG_C_UTF8
--

CREATE COLLATION regress_pg_c_utf8 (
  provider = builtin, locale = 'C_UTF8')
ERROR: 

--
-- Test PG_C_UTF8
--

CREATE COLLATION regress_pg_c_utf8 (
  provider = builtin, locale = 'C_UTF8')

Parser Error: syntax error at or near "COLLATION"
 -- fails
CREATE COLLATION regress_pg_c_utf8 (
  provider = builtin, locale = 'C.UTF8')
ERROR:  -- fails
CREATE COLLATION regress_pg_c_utf8 (
  provider = builtin, locale = 'C.UTF8')

Parser Error: syntax error at or near "COLLATION"

DROP COLLATION regress_pg_c_utf8
ERROR: 
DROP COLLATION regress_pg_c_utf8

Not implemented Error: Cannot drop this type yet

CREATE COLLATION regress_pg_c_utf8 (
  provider = builtin, locale = 'C.UTF-8')
ERROR: 
CREATE COLLATION regress_pg_c_utf8 (
  provider = builtin, locale = 'C.UTF-8')

Parser Error: syntax error at or near "COLLATION"


CREATE TABLE test_pg_c_utf8 (
  t TEXT COLLATE PG_C_UTF8
)
ERROR: 

CREATE TABLE test_pg_c_utf8 (
  t TEXT COLLATE PG_C_UTF8
)

Catalog Error: Collation with name pg_c_utf8 does not exist!
Did you mean "gu"?

INSERT INTO test_pg_c_utf8 VALUES
  ('abc DEF 123abc'),
  ('ábc sßs ßss DÉF'),
  ('ǄxxǄ ǆxxǅ ǅxxǆ'),
  ('ȺȺȺ'),
  ('ⱥⱥⱥ'),
  ('ⱥȺ')
ERROR: 
INSERT INTO test_pg_c_utf8 VALUES
  ('abc DEF 123abc'),
  ('ábc sßs ßss DÉF'),
  ('ǄxxǄ ǆxxǅ ǅxxǆ'),
  ('ȺȺȺ'),
  ('ⱥⱥⱥ'),
  ('ⱥȺ')

Catalog Error: Table with name test_pg_c_utf8 does not exist!
Did you mean "TEXT_TBL"?


SELECT
    t, lower(t), initcap(t), upper(t),
    length(convert_to(t, 'UTF8')) AS t_bytes,
    length(convert_to(lower(t), 'UTF8')) AS lower_t_bytes,
    length(convert_to(initcap(t), 'UTF8')) AS initcap_t_bytes,
    length(convert_to(upper(t), 'UTF8')) AS upper_t_bytes
  FROM test_pg_c_utf8
ERROR: 

SELECT
    t, lower(t), initcap(t), upper(t),
    length(convert_to(t, 'UTF8')) AS t_bytes,
    length(convert_to(lower(t), 'UTF8')) AS lower_t_bytes,
    length(convert_to(initcap(t), 'UTF8')) AS initcap_t_bytes,
    length(convert_to(upper(t), 'UTF8')) AS upper_t_bytes
  FROM test_pg_c_utf8

Catalog Error: Table with name test_pg_c_utf8 does not exist!
Did you mean "TEXT_TBL"?


DROP TABLE test_pg_c_utf8
ERROR: 

DROP TABLE test_pg_c_utf8

Catalog Error: Table with name test_pg_c_utf8 does not exist!
Did you mean "TEXT_TBL"?


-- negative test: Final_Sigma not used for builtin locale C.UTF-8
SELECT lower('ΑΣ' COLLATE PG_C_UTF8)
ERROR: 

-- negative test: Final_Sigma not used for builtin locale C.UTF-8
SELECT lower('ΑΣ' COLLATE PG_C_UTF8)

Catalog Error: Collation with name pg_c_utf8 does not exist!
Did you mean "gu"?

SELECT lower('ΑͺΣͺ' COLLATE PG_C_UTF8)
ERROR: 
SELECT lower('ΑͺΣͺ' COLLATE PG_C_UTF8)

Catalog Error: Collation with name pg_c_utf8 does not exist!
Did you mean "gu"?

SELECT lower('Α΄Σ΄' COLLATE PG_C_UTF8)
ERROR: 
SELECT lower('Α΄Σ΄' COLLATE PG_C_UTF8)

Catalog Error: Collation with name pg_c_utf8 does not exist!
Did you mean "gu"?


-- properties

SELECT 'xyz' ~ '[[:alnum:]]' COLLATE PG_C_UTF8
ERROR: 

-- properties

SELECT 'xyz' ~ '[[:alnum:]]' COLLATE PG_C_UTF8

Catalog Error: Collation with name pg_c_utf8 does not exist!
Did you mean "gu"?

SELECT 'xyz' !~ '[[:upper:]]' COLLATE PG_C_UTF8
ERROR: 
SELECT 'xyz' !~ '[[:upper:]]' COLLATE PG_C_UTF8

Catalog Error: Collation with name pg_c_utf8 does not exist!
Did you mean "gu"?

SELECT '@' !~ '[[:alnum:]]' COLLATE PG_C_UTF8
ERROR: 
SELECT '@' !~ '[[:alnum:]]' COLLATE PG_C_UTF8

Catalog Error: Collation with name pg_c_utf8 does not exist!
Did you mean "gu"?

SELECT '=' ~ '[[:punct:]]' COLLATE PG_C_UTF8
ERROR: 
SELECT '=' ~ '[[:punct:]]' COLLATE PG_C_UTF8

Catalog Error: Collation with name pg_c_utf8 does not exist!
Did you mean "gu"?
 -- symbols are punctuation in posix
SELECT 'a8a' ~ '[[:digit:]]' COLLATE PG_C_UTF8
ERROR:  -- symbols are punctuation in posix
SELECT 'a8a' ~ '[[:digit:]]' COLLATE PG_C_UTF8

Catalog Error: Collation with name pg_c_utf8 does not exist!
Did you mean "gu"?

SELECT '൧' !~ '\d' COLLATE PG_C_UTF8
ERROR: 
SELECT '൧' !~ '\d' COLLATE PG_C_UTF8

Catalog Error: Collation with name pg_c_utf8 does not exist!
Did you mean "gu"?
 -- only 0-9 considered digits in posix

-- case mapping

SELECT 'xYz' ~* 'XyZ' COLLATE PG_C_UTF8
ERROR:  -- only 0-9 considered digits in posix

-- case mapping

SELECT 'xYz' ~* 'XyZ' COLLATE PG_C_UTF8

Catalog Error: Scalar Function with name ~* does not exist!
Did you mean "*"?

SELECT 'xAb' ~* '[W-Y]' COLLATE PG_C_UTF8
ERROR: 
SELECT 'xAb' ~* '[W-Y]' COLLATE PG_C_UTF8

Catalog Error: Scalar Function with name ~* does not exist!
Did you mean "*"?

SELECT 'xAb' !~* '[c-d]' COLLATE PG_C_UTF8
ERROR: 
SELECT 'xAb' !~* '[c-d]' COLLATE PG_C_UTF8

Catalog Error: Scalar Function with name !~* does not exist!
Did you mean "!~~*"?

SELECT 'Δ' ~* '[γ-λ]' COLLATE PG_C_UTF8
ERROR: 
SELECT 'Δ' ~* '[γ-λ]' COLLATE PG_C_UTF8

Catalog Error: Scalar Function with name ~* does not exist!
Did you mean "*"?

SELECT 'δ' ~* '[Γ-Λ]' COLLATE PG_C_UTF8
ERROR: 
SELECT 'δ' ~* '[Γ-Λ]' COLLATE PG_C_UTF8

Catalog Error: Scalar Function with name ~* does not exist!
Did you mean "*"?
 -- same as above with cases reversed

