
-----------
QUERY:
--
-- CREATE_TABLE
--

-- Error cases
CREATE TABLE unknowntab (
	u unknown    -- fail
);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'unknown    -- fail\n)' at line 7")

-----------
QUERY:


CREATE TYPE unknown_comptype AS (
	u unknown    -- fail
);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE unknown_comptype AS (\n\tu unknown    -- fail\n)' at line 1")

-----------
QUERY:


-- invalid: non-lowercase quoted reloptions identifiers
CREATE TABLE tas_case WITH ("Fillfactor" = 10) AS SELECT 1 a;
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'("Fillfactor" = 10) AS SELECT 1 a\' at line 2')

-----------
QUERY:


CREATE UNLOGGED TABLE unlogged1 (a int primary key);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'UNLOGGED TABLE unlogged1 (a int primary key)' at line 1")

-----------
QUERY:
			-- OK
CREATE TEMPORARY TABLE unlogged2 (a int primary key);
RESULT:
	[]

-----------
QUERY:
			-- OK
SELECT relname, relkind, relpersistence FROM pg_class WHERE relname ~ '^unlogged\d' ORDER BY relname;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '~ '^unlogged\\d' ORDER BY relname' at line 2")

-----------
QUERY:

REINDEX INDEX unlogged1_pkey;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX INDEX unlogged1_pkey' at line 1")

-----------
QUERY:

REINDEX INDEX unlogged2_pkey;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX INDEX unlogged2_pkey' at line 1")

-----------
QUERY:

SELECT relname, relkind, relpersistence FROM pg_class WHERE relname ~ '^unlogged\d' ORDER BY relname;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '~ '^unlogged\\d' ORDER BY relname' at line 1")

-----------
QUERY:

DROP TABLE unlogged2;
RESULT:
	[]

-----------
QUERY:

INSERT INTO unlogged1 VALUES (42);
RESULT:
	ERROR - (1146, "Table 'test.unlogged1' doesn't exist")

-----------
QUERY:

CREATE UNLOGGED TABLE public.unlogged2 (a int primary key);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'UNLOGGED TABLE public.unlogged2 (a int primary key)' at line 1")

-----------
QUERY:
		-- also OK
CREATE UNLOGGED TABLE pg_temp.unlogged3 (a int primary key);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'UNLOGGED TABLE pg_temp.unlogged3 (a int primary key)' at line 2")

-----------
QUERY:
	-- not OK
CREATE TABLE pg_temp.implicitly_temp (a int primary key);
RESULT:
	ERROR - (1049, "Unknown database 'pg_temp'")

-----------
QUERY:
		-- OK
CREATE TEMP TABLE explicitly_temp (a int primary key);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TEMP TABLE explicitly_temp (a int primary key)' at line 2")

-----------
QUERY:
			-- also OK
CREATE TEMP TABLE pg_temp.doubly_temp (a int primary key);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TEMP TABLE pg_temp.doubly_temp (a int primary key)' at line 2")

-----------
QUERY:
		-- also OK
CREATE TEMP TABLE public.temp_to_perm (a int primary key);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TEMP TABLE public.temp_to_perm (a int primary key)' at line 2")

-----------
QUERY:
		-- not OK
DROP TABLE unlogged1, public.unlogged2;
RESULT:
	ERROR - (1051, "Unknown table 'test.unlogged1,public.unlogged2'")

-----------
QUERY:


CREATE TABLE as_select1 AS SELECT * FROM pg_class WHERE relkind = 'r';
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:

CREATE TABLE as_select1 AS SELECT * FROM pg_class WHERE relkind = 'r';
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:

CREATE TABLE IF NOT EXISTS as_select1 AS SELECT * FROM pg_class WHERE relkind = 'r';
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:

DROP TABLE as_select1;
RESULT:
	ERROR - (1051, "Unknown table 'test.as_select1'")

-----------
QUERY:


PREPARE select1 AS SELECT 1 as a;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS SELECT 1 as a' at line 1")

-----------
QUERY:

CREATE TABLE as_select1 AS EXECUTE select1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'EXECUTE select1' at line 1")

-----------
QUERY:

CREATE TABLE as_select1 AS EXECUTE select1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'EXECUTE select1' at line 1")

-----------
QUERY:

SELECT * FROM as_select1;
RESULT:
	ERROR - (1146, "Table 'test.as_select1' doesn't exist")

-----------
QUERY:

CREATE TABLE IF NOT EXISTS as_select1 AS EXECUTE select1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'EXECUTE select1' at line 1")

-----------
QUERY:

DROP TABLE as_select1;
RESULT:
	ERROR - (1051, "Unknown table 'test.as_select1'")

-----------
QUERY:

DEALLOCATE select1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select1' at line 1")

-----------
QUERY:


-- create an extra wide table to test for issues related to that
-- (temporarily hide query, to avoid the long CREATE TABLE stmt)
-- \set ECHO none
SELECT 'CREATE TABLE extra_wide_table(firstc text, '|| array_to_string(array_agg('c'||i||' bool'),',')||', lastc text);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '', lastc text)' at line 4")

-----------
QUERY:
'
FROM generate_series(1, 1100) g(i)
-- \gexec
-- \set ECHO all
INSERT INTO extra_wide_table(firstc, lastc) VALUES('first col', 'last col');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''\nFROM generate_series(1, 1100) g(i)\n-- \\gexec\n-- \\set ECHO all\nINSERT INTO extr' at line 1")

-----------
QUERY:

SELECT firstc, lastc FROM extra_wide_table;
RESULT:
	ERROR - (1146, "Table 'test.extra_wide_table' doesn't exist")

-----------
QUERY:


-- check that tables with oids cannot be created anymore
CREATE TABLE withoid() WITH OIDS;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') WITH OIDS' at line 2")

-----------
QUERY:

CREATE TABLE withoid() WITH (oids);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') WITH (oids)' at line 1")

-----------
QUERY:

CREATE TABLE withoid() WITH (oids = true);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') WITH (oids = true)' at line 1")

-----------
QUERY:


-- but explicitly not adding oids is still supported
CREATE TEMP TABLE withoutoid() WITHOUT OIDS;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TEMP TABLE withoutoid() WITHOUT OIDS' at line 2")

-----------
QUERY:
 DROP TABLE withoutoid;
RESULT:
	ERROR - (1051, "Unknown table 'test.withoutoid'")

-----------
QUERY:

CREATE TEMP TABLE withoutoid() WITH (oids = false);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TEMP TABLE withoutoid() WITH (oids = false)' at line 1")

-----------
QUERY:
 DROP TABLE withoutoid;
RESULT:
	ERROR - (1051, "Unknown table 'test.withoutoid'")

-----------
QUERY:


-- check restriction with default expressions
-- invalid use of column reference in default expressions
CREATE TABLE default_expr_column (id int DEFAULT (id));
RESULT:
	ERROR - (3767, "Default value expression of column 'id' cannot refer to a column defined after it if that column is a generated column or has an expression as default value.")

-----------
QUERY:

CREATE TABLE default_expr_column (id int DEFAULT (bar.id));
RESULT:
	ERROR - (3767, "Default value expression of column 'id' cannot refer to a column defined after it if that column is a generated column or has an expression as default value.")

-----------
QUERY:

CREATE TABLE default_expr_agg_column (id int DEFAULT (avg(id)));
RESULT:
	ERROR - (1111, 'Invalid use of group function')

-----------
QUERY:

-- invalid column definition
CREATE TABLE default_expr_non_column (a int DEFAULT (avg(non_existent)));
RESULT:
	ERROR - (1111, 'Invalid use of group function')

-----------
QUERY:

-- invalid use of aggregate
CREATE TABLE default_expr_agg (a int DEFAULT (avg(1)));
RESULT:
	ERROR - (1111, 'Invalid use of group function')

-----------
QUERY:

-- invalid use of subquery
CREATE TABLE default_expr_agg (a int DEFAULT (select 1));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select 1))' at line 2")

-----------
QUERY:

-- invalid use of set-returning function
CREATE TABLE default_expr_agg (a int DEFAULT (generate_series(1,3)));
RESULT:
	ERROR - (3770, "Default value expression of column 'a' contains a disallowed function: `generate_series`.")

-----------
QUERY:


-- Verify that subtransaction rollback restores rd_createSubid.
BEGIN;
RESULT:
	[]

-----------
QUERY:

CREATE TABLE remember_create_subid (c int);
RESULT:
	[]

-----------
QUERY:

SAVEPOINT q;
RESULT:
	[]

-----------
QUERY:
 DROP TABLE remember_create_subid;
RESULT:
	[]

-----------
QUERY:
 ROLLBACK TO q;
RESULT:
	ERROR - (1305, 'SAVEPOINT q does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:

DROP TABLE remember_create_subid;
RESULT:
	ERROR - (1051, "Unknown table 'test.remember_create_subid'")

-----------
QUERY:


-- Verify that subtransaction rollback restores rd_firstRelfilenodeSubid.
CREATE TABLE remember_node_subid (c int);
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

ALTER TABLE remember_node_subid ALTER c TYPE bigint;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE bigint' at line 1")

-----------
QUERY:

SAVEPOINT q;
RESULT:
	[]

-----------
QUERY:
 DROP TABLE remember_node_subid;
RESULT:
	[]

-----------
QUERY:
 ROLLBACK TO q;
RESULT:
	ERROR - (1305, 'SAVEPOINT q does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:

DROP TABLE remember_node_subid;
RESULT:
	ERROR - (1051, "Unknown table 'test.remember_node_subid'")

-----------
QUERY:


--
-- Partitioned tables
--

-- cannot combine INHERITS and PARTITION BY (although grammar allows)
CREATE TABLE partitioned (
	a int
) INHERITS (some_table) PARTITION BY LIST (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INHERITS (some_table) PARTITION BY LIST (a)' at line 8")

-----------
QUERY:


-- cannot use more than 1 column as partition key for list partitioned table
CREATE TABLE partitioned (
	a1 int,
	a2 int
) PARTITION BY LIST (a1, a2);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ', a2)' at line 5")

-----------
QUERY:
	-- fail

-- prevent using prohibited expressions in the key
CREATE FUNCTION retset (a int) RETURNS SETOF int AS $$ SELECT 1; $$ LANGUAGE SQL IMMUTABLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SETOF int AS $$ SELECT 1; $$ LANGUAGE SQL IMMUTABLE' at line 4")

-----------
QUERY:

CREATE TABLE partitioned (
	a int
) PARTITION BY RANGE (retset(a));
RESULT:
	ERROR - (1064, "Constant, random or timezone-dependent expressions in (sub)partitioning function are not allowed near 'retset(a))' at line 3")

-----------
QUERY:

DROP FUNCTION retset(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int)' at line 1")

-----------
QUERY:


CREATE TABLE partitioned (
	a int
) PARTITION BY RANGE ((avg(a)));
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:


CREATE TABLE partitioned (
	a int,
	b int
) PARTITION BY RANGE ((avg(a) OVER (PARTITION BY b)));
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:


CREATE TABLE partitioned (
	a int
) PARTITION BY LIST ((a LIKE (SELECT 1)));
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:


CREATE TABLE partitioned (
	a int
) PARTITION BY RANGE ((42));
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:


CREATE FUNCTION const_func () RETURNS int AS $$ SELECT 1; $$ LANGUAGE SQL IMMUTABLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS $$ SELECT 1; $$ LANGUAGE SQL IMMUTABLE' at line 1")

-----------
QUERY:

CREATE TABLE partitioned (
	a int
) PARTITION BY RANGE (const_func());
RESULT:
	ERROR - (1064, "Constant, random or timezone-dependent expressions in (sub)partitioning function are not allowed near 'const_func())' at line 3")

-----------
QUERY:

DROP FUNCTION const_func();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:


-- only accept valid partitioning strategy
CREATE TABLE partitioned (
    a int
) PARTITION BY MAGIC (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MAGIC (a)' at line 4")

-----------
QUERY:


-- specified column must be present in the table
CREATE TABLE partitioned (
	a int
) PARTITION BY RANGE (b);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:


-- cannot use system columns in partition key
CREATE TABLE partitioned (
	a int
) PARTITION BY RANGE (xmin);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:


-- cannot use pseudotypes
CREATE TABLE partitioned (
	a int,
	b int
) PARTITION BY RANGE (((a, b)));
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE partitioned (
	a int,
	b int
) PARTITION BY RANGE (a, ('unknown'));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ', ('unknown'))' at line 4")

-----------
QUERY:


-- functions in key must be immutable
CREATE FUNCTION immut_func (a int) RETURNS int AS $$ SELECT a + random()::int; $$ LANGUAGE SQL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS $$ SELECT a + random()::int; $$ LANGUAGE SQL' at line 2")

-----------
QUERY:

CREATE TABLE partitioned (
	a int
) PARTITION BY RANGE (immut_func(a));
RESULT:
	ERROR - (1064, "Constant, random or timezone-dependent expressions in (sub)partitioning function are not allowed near 'immut_func(a))' at line 3")

-----------
QUERY:

DROP FUNCTION immut_func(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int)' at line 1")

-----------
QUERY:


-- prevent using columns of unsupported types in key (type must have a btree operator class)
CREATE TABLE partitioned (
	a point
) PARTITION BY LIST (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE partitioned (
	a point
) PARTITION BY LIST (a point_ops);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'point_ops)' at line 3")

-----------
QUERY:

CREATE TABLE partitioned (
	a point
) PARTITION BY RANGE (a);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE partitioned (
	a point
) PARTITION BY RANGE (a point_ops);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'point_ops)' at line 3")

-----------
QUERY:


-- cannot add NO INHERIT constraints to partitioned tables
CREATE TABLE partitioned (
	a int,
	CONSTRAINT check_a CHECK (a > 0) NO INHERIT
) PARTITION BY RANGE (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NO INHERIT\n) PARTITION BY RANGE (a)' at line 4")

-----------
QUERY:


-- some checks after successful creation of a partitioned table
CREATE FUNCTION plusone(a int) RETURNS INT AS $$ SELECT a+1; $$ LANGUAGE SQL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS $$ SELECT a+1; $$ LANGUAGE SQL' at line 2")

-----------
QUERY:


CREATE TABLE partitioned (
	a int,
	b int,
	c text,
	d text
) PARTITION BY RANGE (a oid_ops, plusone(b), c collate "default", d collate "C");
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'oid_ops, plusone(b), c collate "default", d collate "C")\' at line 6')

-----------
QUERY:


-- check relkind
SELECT relkind FROM pg_class WHERE relname = 'partitioned';
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:


-- prevent a function referenced in partition key from being dropped
DROP FUNCTION plusone(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int)' at line 2")

-----------
QUERY:


-- partitioned table cannot participate in regular inheritance
CREATE TABLE partitioned2 (
	a int,
	b text
) PARTITION BY RANGE ((a+1), substr(b, 1, 5));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ', substr(b, 1, 5))' at line 5")

-----------
QUERY:

CREATE TABLE fail () INHERITS (partitioned2);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') INHERITS (partitioned2)' at line 1")

-----------
QUERY:


-- Partition key in describe output
-- \d partitioned
-- \d+ partitioned2

INSERT INTO partitioned2 VALUES (1, 'hello');
RESULT:
	ERROR - (1146, "Table 'test.partitioned2' doesn't exist")

-----------
QUERY:

CREATE TABLE part2_1 PARTITION OF partitioned2 FOR VALUES FROM (-1, 'aaaaa') TO (100, 'ccccc');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF partitioned2 FOR VALUES FROM (-1, 'aaaaa') TO (100, 'ccccc')' at line 1")

-----------
QUERY:

-- \d+ part2_1

DROP TABLE partitioned, partitioned2;
RESULT:
	ERROR - (1051, "Unknown table 'test.partitioned,test.partitioned2'")

-----------
QUERY:


-- check reference to partitioned table/* REPLACED */ ''s rowtype in partition descriptor
create table partitioned (a int, b int)
  partition by list ((row(a, b)::partitioned));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::partitioned))' at line 3")

-----------
QUERY:

create table partitioned1
  partition of partitioned for values in ('(1,2)'::partitioned);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of partitioned for values in ('(1,2)'::partitioned)' at line 2")

-----------
QUERY:

create table partitioned2
  partition of partitioned for values in ('(2,4)'::partitioned);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of partitioned for values in ('(2,4)'::partitioned)' at line 2")

-----------
QUERY:

explain (costs off)
select * from partitioned where row(a,b)::partitioned = '(1,2)'::partitioned;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'costs off)\nselect * from partitioned where row(a,b)::partitioned = '(1,2)'::part' at line 1")

-----------
QUERY:

drop table partitioned;
RESULT:
	ERROR - (1051, "Unknown table 'test.partitioned'")

-----------
QUERY:


-- whole-row Var in partition key works too
create table partitioned (a int, b int)
  partition by list ((partitioned));
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

create table partitioned1
  partition of partitioned for values in ('(1,2)');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of partitioned for values in ('(1,2)')' at line 2")

-----------
QUERY:

create table partitioned2
  partition of partitioned for values in ('(2,4)');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of partitioned for values in ('(2,4)')' at line 2")

-----------
QUERY:

explain (costs off)
select * from partitioned where partitioned = '(1,2)'::partitioned;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'costs off)\nselect * from partitioned where partitioned = '(1,2)'::partitioned' at line 1")

-----------
QUERY:

-- \d+ partitioned1
drop table partitioned;
RESULT:
	ERROR - (1051, "Unknown table 'test.partitioned'")

-----------
QUERY:


-- check that dependencies of partition columns are handled correctly
create domain intdom1 as int;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'domain intdom1 as int' at line 2")

-----------
QUERY:


create table partitioned (
	a intdom1,
	b text
) partition by range (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'intdom1,\n\tb text\n) partition by range (a)' at line 2")

-----------
QUERY:


alter table partitioned drop column a;
RESULT:
	ERROR - (1146, "Table 'test.partitioned' doesn't exist")

-----------
QUERY:
  -- fail

drop domain intdom1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'domain intdom1' at line 3")

-----------
QUERY:
  -- fail, requires cascade

drop domain intdom1 cascade;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'domain intdom1 cascade' at line 3")

-----------
QUERY:


table partitioned;
RESULT:
	ERROR - (1146, "Table 'test.partitioned' doesn't exist")

-----------
QUERY:
  -- gone

-- likewise for columns used in partition expressions
create domain intdom1 as int;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'domain intdom1 as int' at line 4")

-----------
QUERY:


create table partitioned (
	a intdom1,
	b text
) partition by range (plusone(a));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'intdom1,\n\tb text\n) partition by range (plusone(a))' at line 2")

-----------
QUERY:


alter table partitioned drop column a;
RESULT:
	ERROR - (1146, "Table 'test.partitioned' doesn't exist")

-----------
QUERY:
  -- fail

drop domain intdom1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'domain intdom1' at line 3")

-----------
QUERY:
  -- fail, requires cascade

drop domain intdom1 cascade;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'domain intdom1 cascade' at line 3")

-----------
QUERY:


table partitioned;
RESULT:
	ERROR - (1146, "Table 'test.partitioned' doesn't exist")

-----------
QUERY:
  -- gone


--
-- Partitions
--

-- check partition bound syntax

CREATE TABLE list_parted (
	a int
) PARTITION BY LIST (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE part_p1 PARTITION OF list_parted FOR VALUES IN ('1');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN ('1')' at line 1")

-----------
QUERY:

CREATE TABLE part_p2 PARTITION OF list_parted FOR VALUES IN (2);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN (2)' at line 1")

-----------
QUERY:

CREATE TABLE part_p3 PARTITION OF list_parted FOR VALUES IN ((2+1));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN ((2+1))' at line 1")

-----------
QUERY:

CREATE TABLE part_null PARTITION OF list_parted FOR VALUES IN (null);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN (null)' at line 1")

-----------
QUERY:

-- \d+ list_parted

-- forbidden expressions for partition bound with list partitioned table
CREATE TABLE part_bogus_expr_fail PARTITION OF list_parted FOR VALUES IN (somename);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN (somename)' at line 4")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF list_parted FOR VALUES IN (somename.somename);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN (somename.somename)' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF list_parted FOR VALUES IN (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN (a)' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF list_parted FOR VALUES IN (sum(a));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN (sum(a))' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF list_parted FOR VALUES IN (sum(somename));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN (sum(somename))' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF list_parted FOR VALUES IN (sum(1));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN (sum(1))' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF list_parted FOR VALUES IN ((select 1));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN ((select 1))' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF list_parted FOR VALUES IN (generate_series(4, 6));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN (generate_series(4, 6))' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF list_parted FOR VALUES IN ((1+1) collate "POSIX");
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'OF list_parted FOR VALUES IN ((1+1) collate "POSIX")\' at line 1')

-----------
QUERY:


-- syntax does not allow empty list of values for list partitions
CREATE TABLE fail_part PARTITION OF list_parted FOR VALUES IN ();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES IN ()' at line 2")

-----------
QUERY:

-- trying to specify range for list partitioned table
CREATE TABLE fail_part PARTITION OF list_parted FOR VALUES FROM (1) TO (2);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES FROM (1) TO (2)' at line 2")

-----------
QUERY:

-- trying to specify modulus and remainder for list partitioned table
CREATE TABLE fail_part PARTITION OF list_parted FOR VALUES WITH (MODULUS 10, REMAINDER 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted FOR VALUES WITH (MODULUS 10, REMAINDER 1)' at line 2")

-----------
QUERY:


-- check default partition cannot be created more than once
CREATE TABLE part_default PARTITION OF list_parted DEFAULT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted DEFAULT' at line 2")

-----------
QUERY:

CREATE TABLE fail_default_part PARTITION OF list_parted DEFAULT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted DEFAULT' at line 1")

-----------
QUERY:


-- specified literal can/* REPLACED */ ''t be cast to the partition column data type
CREATE TABLE bools (
	a bool
) PARTITION BY LIST (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE bools_true PARTITION OF bools FOR VALUES IN (1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF bools FOR VALUES IN (1)' at line 1")

-----------
QUERY:

DROP TABLE bools;
RESULT:
	ERROR - (1051, "Unknown table 'test.bools'")

-----------
QUERY:


-- specified literal can be cast, and the cast might not be immutable
CREATE TABLE moneyp (
	a money
) PARTITION BY LIST (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'money\n) PARTITION BY LIST (a)' at line 3")

-----------
QUERY:

CREATE TABLE moneyp_10 PARTITION OF moneyp FOR VALUES IN (10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF moneyp FOR VALUES IN (10)' at line 1")

-----------
QUERY:

CREATE TABLE moneyp_11 PARTITION OF moneyp FOR VALUES IN ('11');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF moneyp FOR VALUES IN ('11')' at line 1")

-----------
QUERY:

CREATE TABLE moneyp_12 PARTITION OF moneyp FOR VALUES IN (to_char(12, '99')::int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF moneyp FOR VALUES IN (to_char(12, '99')::int)' at line 1")

-----------
QUERY:

DROP TABLE moneyp;
RESULT:
	ERROR - (1051, "Unknown table 'test.moneyp'")

-----------
QUERY:


-- cast is immutable
CREATE TABLE bigintp (
	a bigint
) PARTITION BY LIST (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE bigintp_10 PARTITION OF bigintp FOR VALUES IN (10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF bigintp FOR VALUES IN (10)' at line 1")

-----------
QUERY:

-- fails due to overlap:
CREATE TABLE bigintp_10_2 PARTITION OF bigintp FOR VALUES IN ('10');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF bigintp FOR VALUES IN ('10')' at line 2")

-----------
QUERY:

DROP TABLE bigintp;
RESULT:
	ERROR - (1051, "Unknown table 'test.bigintp'")

-----------
QUERY:


CREATE TABLE range_parted (
	a date
) PARTITION BY RANGE (a);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:


-- forbidden expressions for partition bounds with range partitioned table
CREATE TABLE part_bogus_expr_fail PARTITION OF range_parted
  FOR VALUES FROM (somename) TO ('2019-01-01');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted\n  FOR VALUES FROM (somename) TO ('2019-01-01')' at line 2")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF range_parted
  FOR VALUES FROM (somename.somename) TO ('2019-01-01');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted\n  FOR VALUES FROM (somename.somename) TO ('2019-01-01')' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF range_parted
  FOR VALUES FROM (a) TO ('2019-01-01');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted\n  FOR VALUES FROM (a) TO ('2019-01-01')' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF range_parted
  FOR VALUES FROM (max(a)) TO ('2019-01-01');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted\n  FOR VALUES FROM (max(a)) TO ('2019-01-01')' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF range_parted
  FOR VALUES FROM (max(somename)) TO ('2019-01-01');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted\n  FOR VALUES FROM (max(somename)) TO ('2019-01-01')' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF range_parted
  FOR VALUES FROM (max('2019-02-01'::date)) TO ('2019-01-01');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted\n  FOR VALUES FROM (max('2019-02-01'::date)) TO ('2019-01-01')' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF range_parted
  FOR VALUES FROM ((select 1)) TO ('2019-01-01');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted\n  FOR VALUES FROM ((select 1)) TO ('2019-01-01')' at line 1")

-----------
QUERY:

CREATE TABLE part_bogus_expr_fail PARTITION OF range_parted
  FOR VALUES FROM (generate_series(1, 3)) TO ('2019-01-01');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted\n  FOR VALUES FROM (generate_series(1, 3)) TO ('2019-01-01')' at line 1")

-----------
QUERY:


-- trying to specify list for range partitioned table
CREATE TABLE fail_part PARTITION OF range_parted FOR VALUES IN ('a');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted FOR VALUES IN ('a')' at line 2")

-----------
QUERY:

-- trying to specify modulus and remainder for range partitioned table
CREATE TABLE fail_part PARTITION OF range_parted FOR VALUES WITH (MODULUS 10, REMAINDER 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted FOR VALUES WITH (MODULUS 10, REMAINDER 1)' at line 2")

-----------
QUERY:

-- each of start and end bounds must have same number of values as the
-- length of the partition key
CREATE TABLE fail_part PARTITION OF range_parted FOR VALUES FROM ('a', 1) TO ('z');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted FOR VALUES FROM ('a', 1) TO ('z')' at line 3")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF range_parted FOR VALUES FROM ('a') TO ('z', 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted FOR VALUES FROM ('a') TO ('z', 1)' at line 1")

-----------
QUERY:


-- cannot specify null values in range bounds
CREATE TABLE fail_part PARTITION OF range_parted FOR VALUES FROM (null) TO (maxvalue);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted FOR VALUES FROM (null) TO (maxvalue)' at line 2")

-----------
QUERY:


-- trying to specify modulus and remainder for range partitioned table
CREATE TABLE fail_part PARTITION OF range_parted FOR VALUES WITH (MODULUS 10, REMAINDER 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted FOR VALUES WITH (MODULUS 10, REMAINDER 1)' at line 2")

-----------
QUERY:


-- check partition bound syntax for the hash partition
CREATE TABLE hash_parted (
	a int
) PARTITION BY HASH (a);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE hpart_1 PARTITION OF hash_parted FOR VALUES WITH (MODULUS 10, REMAINDER 0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted FOR VALUES WITH (MODULUS 10, REMAINDER 0)' at line 1")

-----------
QUERY:

CREATE TABLE hpart_2 PARTITION OF hash_parted FOR VALUES WITH (MODULUS 50, REMAINDER 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted FOR VALUES WITH (MODULUS 50, REMAINDER 1)' at line 1")

-----------
QUERY:

CREATE TABLE hpart_3 PARTITION OF hash_parted FOR VALUES WITH (MODULUS 200, REMAINDER 2);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted FOR VALUES WITH (MODULUS 200, REMAINDER 2)' at line 1")

-----------
QUERY:

CREATE TABLE hpart_4 PARTITION OF hash_parted FOR VALUES WITH (MODULUS 10, REMAINDER 3);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted FOR VALUES WITH (MODULUS 10, REMAINDER 3)' at line 1")

-----------
QUERY:

-- modulus 25 is factor of modulus of 50 but 10 is not a factor of 25.
CREATE TABLE fail_part PARTITION OF hash_parted FOR VALUES WITH (MODULUS 25, REMAINDER 3);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted FOR VALUES WITH (MODULUS 25, REMAINDER 3)' at line 2")

-----------
QUERY:

-- previous modulus 50 is factor of 150 but this modulus is not a factor of next modulus 200.
CREATE TABLE fail_part PARTITION OF hash_parted FOR VALUES WITH (MODULUS 150, REMAINDER 3);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted FOR VALUES WITH (MODULUS 150, REMAINDER 3)' at line 2")

-----------
QUERY:

-- overlapping remainders
CREATE TABLE fail_part PARTITION OF hash_parted FOR VALUES WITH (MODULUS 100, REMAINDER 3);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted FOR VALUES WITH (MODULUS 100, REMAINDER 3)' at line 2")

-----------
QUERY:

-- trying to specify range for the hash partitioned table
CREATE TABLE fail_part PARTITION OF hash_parted FOR VALUES FROM ('a', 1) TO ('z');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted FOR VALUES FROM ('a', 1) TO ('z')' at line 2")

-----------
QUERY:

-- trying to specify list value for the hash partitioned table
CREATE TABLE fail_part PARTITION OF hash_parted FOR VALUES IN (1000);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted FOR VALUES IN (1000)' at line 2")

-----------
QUERY:


-- trying to create default partition for the hash partitioned table
CREATE TABLE fail_default_part PARTITION OF hash_parted DEFAULT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted DEFAULT' at line 2")

-----------
QUERY:


-- check if compatible with the specified parent

-- cannot create as partition of a non-partitioned table
CREATE TABLE unparted (
	a int
);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF unparted FOR VALUES IN ('a');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF unparted FOR VALUES IN ('a')' at line 1")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF unparted FOR VALUES WITH (MODULUS 2, REMAINDER 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF unparted FOR VALUES WITH (MODULUS 2, REMAINDER 1)' at line 1")

-----------
QUERY:

DROP TABLE unparted;
RESULT:
	[]

-----------
QUERY:


-- cannot create a permanent rel as partition of a temp rel
CREATE TEMP TABLE temp_parted (
	a int
) PARTITION BY LIST (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TEMP TABLE temp_parted (\n\ta int\n) PARTITION BY LIST (a)' at line 2")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF temp_parted FOR VALUES IN ('a');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF temp_parted FOR VALUES IN ('a')' at line 1")

-----------
QUERY:

DROP TABLE temp_parted;
RESULT:
	ERROR - (1051, "Unknown table 'test.temp_parted'")

-----------
QUERY:


-- check for partition bound overlap and other invalid specifications

CREATE TABLE list_parted2 (
	a varchar
) PARTITION BY LIST (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') PARTITION BY LIST (a)' at line 5")

-----------
QUERY:

CREATE TABLE part_null_z PARTITION OF list_parted2 FOR VALUES IN (null, 'z');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted2 FOR VALUES IN (null, 'z')' at line 1")

-----------
QUERY:

CREATE TABLE part_ab PARTITION OF list_parted2 FOR VALUES IN ('a', 'b');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted2 FOR VALUES IN ('a', 'b')' at line 1")

-----------
QUERY:

CREATE TABLE list_parted2_def PARTITION OF list_parted2 DEFAULT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted2 DEFAULT' at line 1")

-----------
QUERY:


CREATE TABLE fail_part PARTITION OF list_parted2 FOR VALUES IN (null);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted2 FOR VALUES IN (null)' at line 1")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF list_parted2 FOR VALUES IN ('b', 'c');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted2 FOR VALUES IN ('b', 'c')' at line 1")

-----------
QUERY:

-- check default partition overlap
INSERT INTO list_parted2 VALUES('X');
RESULT:
	ERROR - (1146, "Table 'test.list_parted2' doesn't exist")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF list_parted2 FOR VALUES IN ('W', 'X', 'Y');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF list_parted2 FOR VALUES IN ('W', 'X', 'Y')' at line 1")

-----------
QUERY:


CREATE TABLE range_parted2 (
	a int
) PARTITION BY RANGE (a);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:


-- trying to create range partition with empty range
CREATE TABLE fail_part PARTITION OF range_parted2 FOR VALUES FROM (1) TO (0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (1) TO (0)' at line 2")

-----------
QUERY:

-- note that the range /* REPLACED */ ''[1, 1)/* REPLACED */ '' has no elements
CREATE TABLE fail_part PARTITION OF range_parted2 FOR VALUES FROM (1) TO (1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (1) TO (1)' at line 2")

-----------
QUERY:


CREATE TABLE part0 PARTITION OF range_parted2 FOR VALUES FROM (minvalue) TO (1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (minvalue) TO (1)' at line 1")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF range_parted2 FOR VALUES FROM (minvalue) TO (2);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (minvalue) TO (2)' at line 1")

-----------
QUERY:

CREATE TABLE part1 PARTITION OF range_parted2 FOR VALUES FROM (1) TO (10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (1) TO (10)' at line 1")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF range_parted2 FOR VALUES FROM (-1) TO (1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (-1) TO (1)' at line 1")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF range_parted2 FOR VALUES FROM (9) TO (maxvalue);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (9) TO (maxvalue)' at line 1")

-----------
QUERY:

CREATE TABLE part2 PARTITION OF range_parted2 FOR VALUES FROM (20) TO (30);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (20) TO (30)' at line 1")

-----------
QUERY:

CREATE TABLE part3 PARTITION OF range_parted2 FOR VALUES FROM (30) TO (40);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (30) TO (40)' at line 1")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF range_parted2 FOR VALUES FROM (10) TO (30);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (10) TO (30)' at line 1")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF range_parted2 FOR VALUES FROM (10) TO (50);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (10) TO (50)' at line 1")

-----------
QUERY:


-- Create a default partition for range partitioned table
CREATE TABLE range2_default PARTITION OF range_parted2 DEFAULT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 DEFAULT' at line 2")

-----------
QUERY:


-- More than one default partition is not allowed, so this should give error
CREATE TABLE fail_default_part PARTITION OF range_parted2 DEFAULT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 DEFAULT' at line 2")

-----------
QUERY:


-- Check if the range for default partitions overlap
INSERT INTO range_parted2 VALUES (85);
RESULT:
	ERROR - (1146, "Table 'test.range_parted2' doesn't exist")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF range_parted2 FOR VALUES FROM (80) TO (90);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (80) TO (90)' at line 1")

-----------
QUERY:

CREATE TABLE part4 PARTITION OF range_parted2 FOR VALUES FROM (90) TO (100);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted2 FOR VALUES FROM (90) TO (100)' at line 1")

-----------
QUERY:


-- now check for multi-column range partition key
CREATE TABLE range_parted3 (
	a int,
	b int
) PARTITION BY RANGE (a, (b+1));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ', (b+1))' at line 5")

-----------
QUERY:


CREATE TABLE part00 PARTITION OF range_parted3 FOR VALUES FROM (0, minvalue) TO (0, maxvalue);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted3 FOR VALUES FROM (0, minvalue) TO (0, maxvalue)' at line 1")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF range_parted3 FOR VALUES FROM (0, minvalue) TO (0, 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted3 FOR VALUES FROM (0, minvalue) TO (0, 1)' at line 1")

-----------
QUERY:


CREATE TABLE part10 PARTITION OF range_parted3 FOR VALUES FROM (1, minvalue) TO (1, 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted3 FOR VALUES FROM (1, minvalue) TO (1, 1)' at line 1")

-----------
QUERY:

CREATE TABLE part11 PARTITION OF range_parted3 FOR VALUES FROM (1, 1) TO (1, 10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted3 FOR VALUES FROM (1, 1) TO (1, 10)' at line 1")

-----------
QUERY:

CREATE TABLE part12 PARTITION OF range_parted3 FOR VALUES FROM (1, 10) TO (1, maxvalue);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted3 FOR VALUES FROM (1, 10) TO (1, maxvalue)' at line 1")

-----------
QUERY:

CREATE TABLE fail_part PARTITION OF range_parted3 FOR VALUES FROM (1, 10) TO (1, 20);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted3 FOR VALUES FROM (1, 10) TO (1, 20)' at line 1")

-----------
QUERY:

CREATE TABLE range3_default PARTITION OF range_parted3 DEFAULT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted3 DEFAULT' at line 1")

-----------
QUERY:


-- cannot create a partition that says column b is allowed to range
-- from -infinity to +infinity, while there exist partitions that have
-- more specific ranges
CREATE TABLE fail_part PARTITION OF range_parted3 FOR VALUES FROM (1, minvalue) TO (1, maxvalue);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted3 FOR VALUES FROM (1, minvalue) TO (1, maxvalue)' at line 4")

-----------
QUERY:


-- check for partition bound overlap and other invalid specifications for the hash partition
CREATE TABLE hash_parted2 (
	a varchar
) PARTITION BY HASH (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') PARTITION BY HASH (a)' at line 4")

-----------
QUERY:

CREATE TABLE h2part_1 PARTITION OF hash_parted2 FOR VALUES WITH (MODULUS 4, REMAINDER 2);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted2 FOR VALUES WITH (MODULUS 4, REMAINDER 2)' at line 1")

-----------
QUERY:

CREATE TABLE h2part_2 PARTITION OF hash_parted2 FOR VALUES WITH (MODULUS 8, REMAINDER 0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted2 FOR VALUES WITH (MODULUS 8, REMAINDER 0)' at line 1")

-----------
QUERY:

CREATE TABLE h2part_3 PARTITION OF hash_parted2 FOR VALUES WITH (MODULUS 8, REMAINDER 4);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted2 FOR VALUES WITH (MODULUS 8, REMAINDER 4)' at line 1")

-----------
QUERY:

CREATE TABLE h2part_4 PARTITION OF hash_parted2 FOR VALUES WITH (MODULUS 8, REMAINDER 5);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted2 FOR VALUES WITH (MODULUS 8, REMAINDER 5)' at line 1")

-----------
QUERY:

-- overlap with part_4
CREATE TABLE fail_part PARTITION OF hash_parted2 FOR VALUES WITH (MODULUS 2, REMAINDER 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted2 FOR VALUES WITH (MODULUS 2, REMAINDER 1)' at line 2")

-----------
QUERY:

-- modulus must be greater than zero
CREATE TABLE fail_part PARTITION OF hash_parted2 FOR VALUES WITH (MODULUS 0, REMAINDER 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted2 FOR VALUES WITH (MODULUS 0, REMAINDER 1)' at line 2")

-----------
QUERY:

-- remainder must be greater than or equal to zero and less than modulus
CREATE TABLE fail_part PARTITION OF hash_parted2 FOR VALUES WITH (MODULUS 8, REMAINDER 8);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF hash_parted2 FOR VALUES WITH (MODULUS 8, REMAINDER 8)' at line 2")

-----------
QUERY:


-- check schema propagation from parent

CREATE TABLE parted (
	a text,
	b int NOT NULL DEFAULT 0,
	CONSTRAINT check_a CHECK (length(a) > 0)
) PARTITION BY LIST (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:


CREATE TABLE part_a PARTITION OF parted FOR VALUES IN ('a');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF parted FOR VALUES IN ('a')' at line 1")

-----------
QUERY:


-- only inherited attributes (never local ones)
SELECT attname, attislocal, attinhcount FROM pg_attribute
  WHERE attrelid = 'part_a'::regclass and attnum > 0
  ORDER BY attnum;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass and attnum > 0\n  ORDER BY attnum' at line 3")

-----------
QUERY:


-- able to specify column default, column constraint, and table constraint

-- first check the /* REPLACED */ ''column specified more than once/* REPLACED */ '' error
CREATE TABLE part_b PARTITION OF parted (
	b NOT NULL,
	b DEFAULT 1,
	b CHECK (b >= 0),
	CONSTRAINT check_a CHECK (length(a) > 0)
) FOR VALUES IN ('b');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF parted (\n\tb NOT NULL,\n\tb DEFAULT 1,\n\tb CHECK (b >= 0),\n\tCONSTRAINT check_a CH' at line 4")

-----------
QUERY:


CREATE TABLE part_b PARTITION OF parted (
	b NOT NULL DEFAULT 1,
	CONSTRAINT check_a CHECK (length(a) > 0),
	CONSTRAINT check_b CHECK (b >= 0)
) FOR VALUES IN ('b');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF parted (\n\tb NOT NULL DEFAULT 1,\n\tCONSTRAINT check_a CHECK (length(a) > 0),\n\tC' at line 1")

-----------
QUERY:

-- conislocal should be false for any merged constraints, true otherwise
SELECT conname, conislocal, coninhcount FROM pg_constraint WHERE conrelid = 'part_b'::regclass ORDER BY coninhcount DESC, conname;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass ORDER BY coninhcount DESC, conname' at line 2")

-----------
QUERY:


-- Once check_b is added to the parent, it should be made non-local for part_b
ALTER TABLE parted ADD CONSTRAINT check_b CHECK (b >= 0);
RESULT:
	ERROR - (1146, "Table 'test.parted' doesn't exist")

-----------
QUERY:

SELECT conname, conislocal, coninhcount FROM pg_constraint WHERE conrelid = 'part_b'::regclass ORDER BY coninhcount DESC, conname;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass ORDER BY coninhcount DESC, conname' at line 1")

-----------
QUERY:


-- Neither check_a nor check_b are droppable from part_b
ALTER TABLE part_b DROP CONSTRAINT check_a;
RESULT:
	ERROR - (1146, "Table 'test.part_b' doesn't exist")

-----------
QUERY:

ALTER TABLE part_b DROP CONSTRAINT check_b;
RESULT:
	ERROR - (1146, "Table 'test.part_b' doesn't exist")

-----------
QUERY:


-- And dropping it from parted should leave no trace of them on part_b, unlike
-- traditional inheritance where they will be left behind, because they would
-- be local constraints.
ALTER TABLE parted DROP CONSTRAINT check_a, DROP CONSTRAINT check_b;
RESULT:
	ERROR - (1146, "Table 'test.parted' doesn't exist")

-----------
QUERY:

SELECT conname, conislocal, coninhcount FROM pg_constraint WHERE conrelid = 'part_b'::regclass ORDER BY coninhcount DESC, conname;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass ORDER BY coninhcount DESC, conname' at line 1")

-----------
QUERY:


-- specify PARTITION BY for a partition
CREATE TABLE fail_part_col_not_found PARTITION OF parted FOR VALUES IN ('c') PARTITION BY RANGE (c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF parted FOR VALUES IN ('c') PARTITION BY RANGE (c)' at line 2")

-----------
QUERY:

CREATE TABLE part_c PARTITION OF parted (b WITH OPTIONS NOT NULL DEFAULT 0) FOR VALUES IN ('c') PARTITION BY RANGE ((b));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF parted (b WITH OPTIONS NOT NULL DEFAULT 0) FOR VALUES IN ('c') PARTITION BY R' at line 1")

-----------
QUERY:


-- create a level-2 partition
CREATE TABLE part_c_1_10 PARTITION OF part_c FOR VALUES FROM (1) TO (10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF part_c FOR VALUES FROM (1) TO (10)' at line 2")

-----------
QUERY:


-- check that NOT NULL and default value are inherited correctly
create table parted_notnull_inh_test (a int default 1, b int not null default 0) partition by list (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

create table parted_notnull_inh_test1 partition of parted_notnull_inh_test (a not null, b default 1) for values in (1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of parted_notnull_inh_test (a not null, b default 1) for values in (1)' at line 1")

-----------
QUERY:

insert into parted_notnull_inh_test (b) values (null);
RESULT:
	ERROR - (1146, "Table 'test.parted_notnull_inh_test' doesn't exist")

-----------
QUERY:

-- note that while b/* REPLACED */ ''s default is overridden, a/* REPLACED */ ''s default is preserved
-- \d parted_notnull_inh_test1
drop table parted_notnull_inh_test;
RESULT:
	ERROR - (1051, "Unknown table 'test.parted_notnull_inh_test'")

-----------
QUERY:


-- check that collations are assigned in partition bound expressions
create table parted_boolean_col (a bool, b text) partition by list(a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

create table parted_boolean_less partition of parted_boolean_col
  for values in ('foo' < 'bar');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of parted_boolean_col\n  for values in ('foo' < 'bar')' at line 1")

-----------
QUERY:

create table parted_boolean_greater partition of parted_boolean_col
  for values in ('foo' > 'bar');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of parted_boolean_col\n  for values in ('foo' > 'bar')' at line 1")

-----------
QUERY:

drop table parted_boolean_col;
RESULT:
	ERROR - (1051, "Unknown table 'test.parted_boolean_col'")

-----------
QUERY:


-- check for a conflicting COLLATE clause
create table parted_collate_must_match (a text collate "C", b text collate "C")
  partition by range (a);
RESULT:
	ERROR - (1273, "Unknown collation: 'C'")

-----------
QUERY:

-- on the partition key
create table parted_collate_must_match1 partition of parted_collate_must_match
  (a collate "POSIX") for values from ('a') to ('m');
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'of parted_collate_must_match\n  (a collate "POSIX") for values from (\'a\') to (\'m\'\' at line 2')

-----------
QUERY:

-- on another column
create table parted_collate_must_match2 partition of parted_collate_must_match
  (b collate "POSIX") for values from ('m') to ('z');
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'of parted_collate_must_match\n  (b collate "POSIX") for values from (\'m\') to (\'z\'\' at line 2')

-----------
QUERY:

drop table parted_collate_must_match;
RESULT:
	ERROR - (1051, "Unknown table 'test.parted_collate_must_match'")

-----------
QUERY:


-- check that non-matching collations for partition bound
-- expressions are coerced to the right collation

create table test_part_coll_posix (a text) partition by range (a collate "POSIX");
RESULT:
	ERROR - (1273, "Unknown collation: 'POSIX'")

-----------
QUERY:

-- ok, collation is implicitly coerced
create table test_part_coll partition of test_part_coll_posix for values from ('a' collate "C") to ('g');
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'of test_part_coll_posix for values from (\'a\' collate "C") to (\'g\')\' at line 2')

-----------
QUERY:

-- ok
create table test_part_coll2 partition of test_part_coll_posix for values from ('g') to ('m');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of test_part_coll_posix for values from ('g') to ('m')' at line 2")

-----------
QUERY:

-- ok, collation is implicitly coerced
create table test_part_coll_cast partition of test_part_coll_posix for values from (name 'm' collate "C") to ('s');
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'of test_part_coll_posix for values from (name \'m\' collate "C") to (\'s\')\' at line 2')

-----------
QUERY:

-- ok /* REPLACED */ , partition collation silently overrides the default collation of type /* REPLACED */ ''name/* REPLACED */ ''
create table test_part_coll_cast2 partition of test_part_coll_posix for values from (name 's') to ('z');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of test_part_coll_posix for values from (name 's') to ('z')' at line 2")

-----------
QUERY:


drop table test_part_coll_posix;
RESULT:
	ERROR - (1051, "Unknown table 'test.test_part_coll_posix'")

-----------
QUERY:


-- Partition bound in describe output
-- \d+ part_b

-- Both partition bound and partition key in describe output
-- \d+ part_c

-- a level-2 partition/* REPLACED */ ''s constraint will include the parent/* REPLACED */ ''s expressions
-- \d+ part_c_1_10

-- Show partition count in the parent/* REPLACED */ ''s describe output
-- Tempted to include \d+ output listing partitions with bound info but
-- output could vary depending on the order in which partition oids are
-- returned.
-- \d parted
-- \d hash_parted

-- check that we get the expected partition constraints
CREATE TABLE range_parted4 (a int, b int, c int) PARTITION BY RANGE (abs(a), abs(b), c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ', abs(b), c)' at line 18")

-----------
QUERY:

CREATE TABLE unbounded_range_part PARTITION OF range_parted4 FOR VALUES FROM (MINVALUE, MINVALUE, MINVALUE) TO (MAXVALUE, MAXVALUE, MAXVALUE);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted4 FOR VALUES FROM (MINVALUE, MINVALUE, MINVALUE) TO (MAXVALUE, MA' at line 1")

-----------
QUERY:

-- \d+ unbounded_range_part
DROP TABLE unbounded_range_part;
RESULT:
	ERROR - (1051, "Unknown table 'test.unbounded_range_part'")

-----------
QUERY:

CREATE TABLE range_parted4_1 PARTITION OF range_parted4 FOR VALUES FROM (MINVALUE, MINVALUE, MINVALUE) TO (1, MAXVALUE, MAXVALUE);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted4 FOR VALUES FROM (MINVALUE, MINVALUE, MINVALUE) TO (1, MAXVALUE,' at line 1")

-----------
QUERY:

-- \d+ range_parted4_1
CREATE TABLE range_parted4_2 PARTITION OF range_parted4 FOR VALUES FROM (3, 4, 5) TO (6, 7, MAXVALUE);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted4 FOR VALUES FROM (3, 4, 5) TO (6, 7, MAXVALUE)' at line 2")

-----------
QUERY:

-- \d+ range_parted4_2
CREATE TABLE range_parted4_3 PARTITION OF range_parted4 FOR VALUES FROM (6, 8, MINVALUE) TO (9, MAXVALUE, MAXVALUE);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF range_parted4 FOR VALUES FROM (6, 8, MINVALUE) TO (9, MAXVALUE, MAXVALUE)' at line 2")

-----------
QUERY:

-- \d+ range_parted4_3
DROP TABLE range_parted4;
RESULT:
	ERROR - (1051, "Unknown table 'test.range_parted4'")

-----------
QUERY:


-- user-defined operator class in partition key
CREATE FUNCTION my_int4_sort(int4,int4) RETURNS int LANGUAGE sql
  AS $$ SELECT CASE WHEN $1 = $2 THEN 0 WHEN $1 > $2 THEN 1 ELSE -1 END; $$;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int4,int4) RETURNS int LANGUAGE sql\n  AS $$ SELECT CASE WHEN $1 = $2 THEN 0 WHEN' at line 2")

-----------
QUERY:

CREATE OPERATOR CLASS test_int4_ops FOR TYPE int4 USING btree AS
  OPERATOR 1 < (int4,int4), OPERATOR 2 <= (int4,int4),
  OPERATOR 3 = (int4,int4), OPERATOR 4 >= (int4,int4),
  OPERATOR 5 > (int4,int4), FUNCTION 1 my_int4_sort(int4,int4);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPERATOR CLASS test_int4_ops FOR TYPE int4 USING btree AS\n  OPERATOR 1 < (int4,i' at line 1")

-----------
QUERY:

CREATE TABLE partkey_t (a int4) PARTITION BY RANGE (a test_int4_ops);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'test_int4_ops)' at line 1")

-----------
QUERY:

CREATE TABLE partkey_t_1 PARTITION OF partkey_t FOR VALUES FROM (0) TO (1000);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF partkey_t FOR VALUES FROM (0) TO (1000)' at line 1")

-----------
QUERY:

INSERT INTO partkey_t VALUES (100);
RESULT:
	ERROR - (1146, "Table 'test.partkey_t' doesn't exist")

-----------
QUERY:

INSERT INTO partkey_t VALUES (200);
RESULT:
	ERROR - (1146, "Table 'test.partkey_t' doesn't exist")

-----------
QUERY:


-- cleanup
DROP TABLE parted, list_parted, range_parted, list_parted2, range_parted2, range_parted3;
RESULT:
	ERROR - (1051, "Unknown table 'test.parted,test.list_parted,test.range_parted,test.list_parted2,test.range_parted2,test.range_parted3'")

-----------
QUERY:

DROP TABLE partkey_t, hash_parted, hash_parted2;
RESULT:
	ERROR - (1051, "Unknown table 'test.partkey_t,test.hash_parted2'")

-----------
QUERY:

DROP OPERATOR CLASS test_int4_ops USING btree;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPERATOR CLASS test_int4_ops USING btree' at line 1")

-----------
QUERY:

DROP FUNCTION my_int4_sort(int4,int4);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int4,int4)' at line 1")

-----------
QUERY:


-- comments on partitioned tables columns
CREATE TABLE parted_col_comment (a int, b text) PARTITION BY LIST (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

COMMENT ON TABLE parted_col_comment IS 'Am partitioned table';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COMMENT ON TABLE parted_col_comment IS 'Am partitioned table'' at line 1")

-----------
QUERY:

COMMENT ON COLUMN parted_col_comment.a IS 'Partition key';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COMMENT ON COLUMN parted_col_comment.a IS 'Partition key'' at line 1")

-----------
QUERY:

SELECT obj_description('parted_col_comment'::regclass);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass)' at line 1")

-----------
QUERY:

-- \d+ parted_col_comment
DROP TABLE parted_col_comment;
RESULT:
	ERROR - (1051, "Unknown table 'test.parted_col_comment'")

-----------
QUERY:


-- specifying storage parameters for partitioned tables is not supported
CREATE TABLE parted_col_comment (a int, b text) PARTITION BY LIST (a) WITH (fillfactor=100);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(fillfactor=100)' at line 2")

-----------
QUERY:


-- list partitioning on array type column
CREATE TABLE arrlp (a int[]) PARTITION BY LIST (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '[]) PARTITION BY LIST (a)' at line 2")

-----------
QUERY:

CREATE TABLE arrlp12 PARTITION OF arrlp FOR VALUES IN ('{1}', '{2}');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF arrlp FOR VALUES IN ('{1}', '{2}')' at line 1")

-----------
QUERY:

-- \d+ arrlp12
DROP TABLE arrlp;
RESULT:
	ERROR - (1051, "Unknown table 'test.arrlp'")

-----------
QUERY:


-- partition on boolean column
create table boolspart (a bool) partition by list (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

create table boolspart_t partition of boolspart for values in (true);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of boolspart for values in (true)' at line 1")

-----------
QUERY:

create table boolspart_f partition of boolspart for values in (false);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of boolspart for values in (false)' at line 1")

-----------
QUERY:

-- \d+ boolspart
drop table boolspart;
RESULT:
	ERROR - (1051, "Unknown table 'test.boolspart'")

-----------
QUERY:


-- partitions mixing temporary and permanent relations
create table perm_parted (a int) partition by list (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

create temporary table temp_parted (a int) partition by list (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

create table perm_part partition of temp_parted default;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of temp_parted default' at line 1")

-----------
QUERY:
 -- error
create temp table temp_part partition of perm_parted default;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'temp table temp_part partition of perm_parted default' at line 2")

-----------
QUERY:
 -- error
create temp table temp_part partition of temp_parted default;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'temp table temp_part partition of temp_parted default' at line 2")

-----------
QUERY:
 -- ok
drop table perm_parted cascade;
RESULT:
	ERROR - (1051, "Unknown table 'test.perm_parted'")

-----------
QUERY:

drop table temp_parted cascade;
RESULT:
	ERROR - (1051, "Unknown table 'test.temp_parted'")

-----------
QUERY:


-- check that adding partitions to a table while it is being used is prevented
create table tab_part_create (a int) partition by list (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

create or replace function func_part_create() returns trigger
  language plpgsql as $$
  begin
    execute 'create table tab_part_create_1 partition of tab_part_create for values in (1)';
    return null;
  end $$;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'function func_part_create() returns trigger\n  language plpgsql as $$\n  begin\n   ' at line 1")

-----------
QUERY:

create trigger trig_part_create before insert on tab_part_create
  for each statement execute procedure func_part_create();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'statement execute procedure func_part_create()' at line 2")

-----------
QUERY:

insert into tab_part_create values (1);
RESULT:
	ERROR - (1146, "Table 'test.tab_part_create' doesn't exist")

-----------
QUERY:

drop table tab_part_create;
RESULT:
	ERROR - (1051, "Unknown table 'test.tab_part_create'")

-----------
QUERY:

drop function func_part_create();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:


-- test using a volatile expression as partition bound
create table volatile_partbound_test (partkey timestamp) partition by range (partkey);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:

create table volatile_partbound_test1 partition of volatile_partbound_test for values from (minvalue) to (current_timestamp);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of volatile_partbound_test for values from (minvalue) to (current_timestamp)' at line 1")

-----------
QUERY:

create table volatile_partbound_test2 partition of volatile_partbound_test for values from (current_timestamp) to (maxvalue);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of volatile_partbound_test for values from (current_timestamp) to (maxvalue)' at line 1")

-----------
QUERY:

-- this should go into the partition volatile_partbound_test2
insert into volatile_partbound_test values (current_timestamp);
RESULT:
	ERROR - (1146, "Table 'test.volatile_partbound_test' doesn't exist")

-----------
QUERY:

select tableoid::regclass from volatile_partbound_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass from volatile_partbound_test' at line 1")

-----------
QUERY:

drop table volatile_partbound_test;
RESULT:
	ERROR - (1051, "Unknown table 'test.volatile_partbound_test'")

-----------
QUERY:


-- test the case where a check constraint on default partition allows
-- to avoid scanning it when adding a new partition
create table defcheck (a int, b int) partition by list (b);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

create table defcheck_def (a int, c int, b int);
RESULT:
	[]

-----------
QUERY:

alter table defcheck_def drop c;
RESULT:
	[]

-----------
QUERY:

alter table defcheck attach partition defcheck_def default;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'attach partition defcheck_def default' at line 1")

-----------
QUERY:

alter table defcheck_def add check (b <= 0 and b is not null);
RESULT:
	[]

-----------
QUERY:

create table defcheck_1 partition of defcheck for values in (1, null);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of defcheck for values in (1, null)' at line 1")

-----------
QUERY:


-- test that complex default partition constraints are enforced correctly
insert into defcheck_def values (0, 0);
RESULT:
	[]

-----------
QUERY:

create table defcheck_0 partition of defcheck for values in (0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of defcheck for values in (0)' at line 1")

-----------
QUERY:

drop table defcheck;
RESULT:
	ERROR - (1051, "Unknown table 'test.defcheck'")

-----------
QUERY:


-- tests of column drop with partition tables and indexes using
-- predicates and expressions.
create table part_column_drop (
  useless_1 int,
  id int,
  useless_2 int,
  d int,
  b int,
  useless_3 int
) partition by range (id);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:

alter table part_column_drop drop column useless_1;
RESULT:
	ERROR - (1146, "Table 'test.part_column_drop' doesn't exist")

-----------
QUERY:

alter table part_column_drop drop column useless_2;
RESULT:
	ERROR - (1146, "Table 'test.part_column_drop' doesn't exist")

-----------
QUERY:

alter table part_column_drop drop column useless_3;
RESULT:
	ERROR - (1146, "Table 'test.part_column_drop' doesn't exist")

-----------
QUERY:

create index part_column_drop_b_pred on part_column_drop(b) where b = 1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where b = 1' at line 1")

-----------
QUERY:

create index part_column_drop_b_expr on part_column_drop((b = 1));
RESULT:
	ERROR - (1146, "Table 'test.part_column_drop' doesn't exist")

-----------
QUERY:

create index part_column_drop_d_pred on part_column_drop(d) where d = 2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where d = 2' at line 1")

-----------
QUERY:

create index part_column_drop_d_expr on part_column_drop((d = 2));
RESULT:
	ERROR - (1146, "Table 'test.part_column_drop' doesn't exist")

-----------
QUERY:

create table part_column_drop_1_10 partition of
  part_column_drop for values from (1) to (10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of\n  part_column_drop for values from (1) to (10)' at line 1")

-----------
QUERY:

-- \d part_column_drop
-- \d part_column_drop_1_10
drop table part_column_drop;
RESULT:
	ERROR - (1051, "Unknown table 'test.part_column_drop'")
