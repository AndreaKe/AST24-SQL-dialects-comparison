--
-- CREATE_TYPE
--

-- directory path and dlsuffix are passed to us in environment variables
-- \getenv libdir ''/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress''
-- \getenv dlsuffix ''.so''

-- \set regresslib /* REPLACED */ ''/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress'' ''/regress'' /* REPLACED */ ''.so''

--
-- Test the ''old style'' approach of making the I/O functions first,
-- with no explicit shell type creation.
--
CREATE FUNCTION widget_in(cstring)
   RETURNS widget
   AS /* REPLACED */ '/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress/regress.so'
   LANGUAGE C STRICT IMMUTABLE
ERROR: --
-- CREATE_TYPE
--

-- directory path and dlsuffix are passed to us in environment variables
-- \getenv libdir ''/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress''
-- \getenv dlsuffix ''.so''

-- \set regresslib /* REPLACED */ ''/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress'' ''/regress'' /* REPLACED */ ''.so''

--
-- Test the ''old style'' approach of making the I/O functions first,
-- with no explicit shell type creation.
--
CREATE FUNCTION widget_in(cstring)
   RETURNS widget
   AS /* REPLACED */ '/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress/regress.so'
   LANGUAGE C STRICT IMMUTABLE

Parser Error: syntax error at or near "RETURNS"


CREATE FUNCTION widget_out(widget)
   RETURNS cstring
   AS /* REPLACED */ '/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress/regress.so'
   LANGUAGE C STRICT IMMUTABLE
ERROR: 

CREATE FUNCTION widget_out(widget)
   RETURNS cstring
   AS /* REPLACED */ '/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress/regress.so'
   LANGUAGE C STRICT IMMUTABLE

Parser Error: syntax error at or near "RETURNS"


CREATE FUNCTION int44in(cstring)
   RETURNS city_budget
   AS /* REPLACED */ '/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress/regress.so'
   LANGUAGE C STRICT IMMUTABLE
ERROR: 

CREATE FUNCTION int44in(cstring)
   RETURNS city_budget
   AS /* REPLACED */ '/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress/regress.so'
   LANGUAGE C STRICT IMMUTABLE

Parser Error: syntax error at or near "RETURNS"


CREATE FUNCTION int44out(city_budget)
   RETURNS cstring
   AS /* REPLACED */ '/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress/regress.so'
   LANGUAGE C STRICT IMMUTABLE
ERROR: 

CREATE FUNCTION int44out(city_budget)
   RETURNS cstring
   AS /* REPLACED */ '/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress/regress.so'
   LANGUAGE C STRICT IMMUTABLE

Parser Error: syntax error at or near "RETURNS"


CREATE TYPE widget (
   internallength = 24,
   input = widget_in,
   output = widget_out,
   typmod_in = numerictypmodin,
   typmod_out = numerictypmodout,
   alignment = double
)
ERROR: 

CREATE TYPE widget (
   internallength = 24,
   input = widget_in,
   output = widget_out,
   typmod_in = numerictypmodin,
   typmod_out = numerictypmodout,
   alignment = double
)

Parser Error: syntax error at or near "("


CREATE TYPE city_budget (
   internallength = 16,
   input = int44in,
   output = int44out,
   element = int4,
   category = 'x',   -- just to verify the system will take it
   preferred = true  -- ditto
)
ERROR: 

CREATE TYPE city_budget (
   internallength = 16,
   input = int44in,
   output = int44out,
   element = int4,
   category = 'x',   -- just to verify the system will take it
   preferred = true  -- ditto
)

Parser Error: syntax error at or near "("


-- Test creation and destruction of shell types
CREATE TYPE shell
ERROR: 

-- Test creation and destruction of shell types
CREATE TYPE shell

Parser Error: syntax error at end of input

CREATE TYPE shell
ERROR: 
CREATE TYPE shell

Parser Error: syntax error at end of input
   -- fail, type already present
DROP TYPE shell
ERROR:    -- fail, type already present
DROP TYPE shell

Catalog Error: Type with name shell does not exist!
Did you mean "null"?

DROP TYPE shell
ERROR: 
DROP TYPE shell

Catalog Error: Type with name shell does not exist!
Did you mean "null"?
     -- fail, type not exist

-- also, let''s leave one around for purposes of pg_dump testing
CREATE TYPE myshell
ERROR:      -- fail, type not exist

-- also, let''s leave one around for purposes of pg_dump testing
CREATE TYPE myshell

Parser Error: syntax error at end of input


--
-- Test type-related default values (broken in releases before PG 7.2)
--
-- This part of the test also exercises the ''new style'' approach of making
-- a shell type and then filling it in.
--
CREATE TYPE int42
ERROR: 

--
-- Test type-related default values (broken in releases before PG 7.2)
--
-- This part of the test also exercises the ''new style'' approach of making
-- a shell type and then filling it in.
--
CREATE TYPE int42

Parser Error: syntax error at end of input

CREATE TYPE text_w_default
ERROR: 
CREATE TYPE text_w_default

Parser Error: syntax error at end of input


-- Make dummy I/O routines using the existing internal support for int4, text
CREATE FUNCTION int42_in(cstring)
   RETURNS int42
   AS 'int4in'
   LANGUAGE internal STRICT IMMUTABLE
ERROR: 

-- Make dummy I/O routines using the existing internal support for int4, text
CREATE FUNCTION int42_in(cstring)
   RETURNS int42
   AS 'int4in'
   LANGUAGE internal STRICT IMMUTABLE

Parser Error: syntax error at or near "RETURNS"

CREATE FUNCTION int42_out(int42)
   RETURNS cstring
   AS 'int4out'
   LANGUAGE internal STRICT IMMUTABLE
ERROR: 
CREATE FUNCTION int42_out(int42)
   RETURNS cstring
   AS 'int4out'
   LANGUAGE internal STRICT IMMUTABLE

Parser Error: syntax error at or near "RETURNS"

CREATE FUNCTION text_w_default_in(cstring)
   RETURNS text_w_default
   AS 'textin'
   LANGUAGE internal STRICT IMMUTABLE
ERROR: 
CREATE FUNCTION text_w_default_in(cstring)
   RETURNS text_w_default
   AS 'textin'
   LANGUAGE internal STRICT IMMUTABLE

Parser Error: syntax error at or near "RETURNS"

CREATE FUNCTION text_w_default_out(text_w_default)
   RETURNS cstring
   AS 'textout'
   LANGUAGE internal STRICT IMMUTABLE
ERROR: 
CREATE FUNCTION text_w_default_out(text_w_default)
   RETURNS cstring
   AS 'textout'
   LANGUAGE internal STRICT IMMUTABLE

Parser Error: syntax error at or near "RETURNS"


CREATE TYPE int42 (
   internallength = 4,
   input = int42_in,
   output = int42_out,
   alignment = int4,
   default = 42,
   passedbyvalue
)
ERROR: 

CREATE TYPE int42 (
   internallength = 4,
   input = int42_in,
   output = int42_out,
   alignment = int4,
   default = 42,
   passedbyvalue
)

Parser Error: syntax error at or near "("


CREATE TYPE text_w_default (
   internallength = variable,
   input = text_w_default_in,
   output = text_w_default_out,
   alignment = int4,
   default = 'zippo'
)
ERROR: 

CREATE TYPE text_w_default (
   internallength = variable,
   input = text_w_default_in,
   output = text_w_default_out,
   alignment = int4,
   default = 'zippo'
)

Parser Error: syntax error at or near "("


CREATE TABLE default_test (f1 text_w_default, f2 int42)
ERROR: 

CREATE TABLE default_test (f1 text_w_default, f2 int42)

Catalog Error: Type with name text_w_default does not exist!
Did you mean "text"?


INSERT INTO default_test DEFAULT VALUES
ERROR: 

INSERT INTO default_test DEFAULT VALUES

Catalog Error: Table with name default_test does not exist!
Did you mean "temp.information_schema.tables"?


SELECT * FROM default_test
ERROR: 

SELECT * FROM default_test

Catalog Error: Table with name default_test does not exist!
Did you mean "temp.information_schema.tables"?


-- We need a shell type to test some CREATE TYPE failure cases with
CREATE TYPE bogus_type
ERROR: 

-- We need a shell type to test some CREATE TYPE failure cases with
CREATE TYPE bogus_type

Parser Error: syntax error at end of input


-- invalid: non-lowercase quoted identifiers
CREATE TYPE bogus_type (
	"Internallength" = 4,
	"Input" = int42_in,
	"Output" = int42_out,
	"Alignment" = int4,
	"Default" = 42,
	"Passedbyvalue"
)
ERROR: 

-- invalid: non-lowercase quoted identifiers
CREATE TYPE bogus_type (
	"Internallength" = 4,
	"Input" = int42_in,
	"Output" = int42_out,
	"Alignment" = int4,
	"Default" = 42,
	"Passedbyvalue"
)

Parser Error: syntax error at or near "("


-- invalid: input/output function incompatibility
CREATE TYPE bogus_type (INPUT = array_in,
    OUTPUT = array_out,
    ELEMENT = int,
    INTERNALLENGTH = 32)
ERROR: 

-- invalid: input/output function incompatibility
CREATE TYPE bogus_type (INPUT = array_in,
    OUTPUT = array_out,
    ELEMENT = int,
    INTERNALLENGTH = 32)

Parser Error: syntax error at or near "("


DROP TYPE bogus_type
ERROR: 

DROP TYPE bogus_type

Catalog Error: Type with name bogus_type does not exist!
Did you mean "bit"?


-- It no longer is possible to issue CREATE TYPE without making a shell first
CREATE TYPE bogus_type (INPUT = array_in,
    OUTPUT = array_out,
    ELEMENT = int,
    INTERNALLENGTH = 32)
ERROR: 

-- It no longer is possible to issue CREATE TYPE without making a shell first
CREATE TYPE bogus_type (INPUT = array_in,
    OUTPUT = array_out,
    ELEMENT = int,
    INTERNALLENGTH = 32)

Parser Error: syntax error at or near "("


-- Test stand-alone composite type

CREATE TYPE default_test_row AS (f1 text_w_default, f2 int42)
ERROR: 

-- Test stand-alone composite type

CREATE TYPE default_test_row AS (f1 text_w_default, f2 int42)

Parser Error: syntax error at or near "("


CREATE FUNCTION get_default_test() RETURNS SETOF default_test_row AS '
  SELECT * FROM default_test;
' LANGUAGE SQL
ERROR: 

CREATE FUNCTION get_default_test() RETURNS SETOF default_test_row AS '
  SELECT * FROM default_test;
' LANGUAGE SQL

Parser Error: syntax error at or near "RETURNS"


SELECT * FROM get_default_test()
ERROR: 

SELECT * FROM get_default_test()

Catalog Error: Table Function with name get_default_test does not exist!
Did you mean "test_all_types"?


-- Test comments
COMMENT ON TYPE bad IS 'bad comment'
ERROR: 

-- Test comments
COMMENT ON TYPE bad IS 'bad comment'

Catalog Error: Type with name bad does not exist!
Did you mean "bit"?

COMMENT ON TYPE default_test_row IS 'good comment'
ERROR: 
COMMENT ON TYPE default_test_row IS 'good comment'

Catalog Error: Type with name default_test_row does not exist!
Did you mean "date"?

COMMENT ON TYPE default_test_row IS NULL
ERROR: 
COMMENT ON TYPE default_test_row IS NULL

Catalog Error: Type with name default_test_row does not exist!
Did you mean "date"?

COMMENT ON COLUMN default_test_row.nope IS 'bad comment'
ERROR: 
COMMENT ON COLUMN default_test_row.nope IS 'bad comment'

Catalog Error: Table with name default_test_row does not exist!
Did you mean "temp.information_schema.tables"?

COMMENT ON COLUMN default_test_row.f1 IS 'good comment'
ERROR: 
COMMENT ON COLUMN default_test_row.f1 IS 'good comment'

Catalog Error: Table with name default_test_row does not exist!
Did you mean "temp.information_schema.tables"?

COMMENT ON COLUMN default_test_row.f1 IS NULL
ERROR: 
COMMENT ON COLUMN default_test_row.f1 IS NULL

Catalog Error: Table with name default_test_row does not exist!
Did you mean "temp.information_schema.tables"?


-- Check shell type create for existing types
CREATE TYPE text_w_default
ERROR: 

-- Check shell type create for existing types
CREATE TYPE text_w_default

Parser Error: syntax error at end of input
		-- should fail

DROP TYPE default_test_row CASCADE
ERROR: 		-- should fail

DROP TYPE default_test_row CASCADE

Catalog Error: Type with name default_test_row does not exist!
Did you mean "date"?


DROP TABLE default_test
ERROR: 

DROP TABLE default_test

Catalog Error: Table with name default_test does not exist!
Did you mean "temp.information_schema.tables"?


-- Check dependencies are established when creating a new type
CREATE TYPE base_type
ERROR: 

-- Check dependencies are established when creating a new type
CREATE TYPE base_type

Parser Error: syntax error at end of input

CREATE FUNCTION base_fn_in(cstring) RETURNS base_type AS 'boolin'
    LANGUAGE internal IMMUTABLE STRICT
ERROR: 
CREATE FUNCTION base_fn_in(cstring) RETURNS base_type AS 'boolin'
    LANGUAGE internal IMMUTABLE STRICT

Parser Error: syntax error at or near "RETURNS"

CREATE FUNCTION base_fn_out(base_type) RETURNS cstring AS 'boolout'
    LANGUAGE internal IMMUTABLE STRICT
ERROR: 
CREATE FUNCTION base_fn_out(base_type) RETURNS cstring AS 'boolout'
    LANGUAGE internal IMMUTABLE STRICT

Parser Error: syntax error at or near "RETURNS"

CREATE TYPE base_type(INPUT = base_fn_in, OUTPUT = base_fn_out)
ERROR: 
CREATE TYPE base_type(INPUT = base_fn_in, OUTPUT = base_fn_out)

Parser Error: syntax error at or near "("

DROP FUNCTION base_fn_in(cstring)
ERROR: 
DROP FUNCTION base_fn_in(cstring)

Parser Error: syntax error at or near "("
 -- error
DROP FUNCTION base_fn_out(base_type)
ERROR:  -- error
DROP FUNCTION base_fn_out(base_type)

Parser Error: syntax error at or near "("
 -- error
DROP TYPE base_type
ERROR:  -- error
DROP TYPE base_type

Catalog Error: Type with name base_type does not exist!
Did you mean "date"?
 -- error
DROP TYPE base_type CASCADE
ERROR:  -- error
DROP TYPE base_type CASCADE

Catalog Error: Type with name base_type does not exist!
Did you mean "date"?


-- Check usage of typmod with a user-defined type
-- (we have borrowed numeric''s typmod functions)

CREATE TEMP TABLE mytab (foo widget(42,13,7))
ERROR: 

-- Check usage of typmod with a user-defined type
-- (we have borrowed numeric''s typmod functions)

CREATE TEMP TABLE mytab (foo widget(42,13,7))

Parser Error: A maximum of two modifiers is supported
     -- should fail
CREATE TEMP TABLE mytab (foo widget(42,13))
ERROR:      -- should fail
CREATE TEMP TABLE mytab (foo widget(42,13))

Catalog Error: Type with name widget does not exist!
Did you mean "bit"?


SELECT format_type(atttypid,atttypmod) FROM pg_attribute
WHERE attrelid = 'mytab'::regclass AND attnum > 0
ERROR: 

SELECT format_type(atttypid,atttypmod) FROM pg_attribute
WHERE attrelid = 'mytab'::regclass AND attnum > 0

Catalog Error: Type with name regclass does not exist!
Did you mean "real"?


-- might as well exercise the widget type while we''re here
INSERT INTO mytab VALUES ('(1,2,3)'), ('(-44,5.5,12)')
ERROR: 

-- might as well exercise the widget type while we''re here
INSERT INTO mytab VALUES ('(1,2,3)'), ('(-44,5.5,12)')

Catalog Error: Table with name mytab does not exist!
Did you mean "temp.information_schema.tables"?

TABLE mytab
ERROR: 
TABLE mytab

Catalog Error: Table with name mytab does not exist!
Did you mean "temp.information_schema.tables"?


-- and test format_type() a bit more, too
select format_type('varchar'::regtype, 42)
ERROR: 

-- and test format_type() a bit more, too
select format_type('varchar'::regtype, 42)

Catalog Error: Type with name regtype does not exist!
Did you mean "date"?

select format_type('bpchar'::regtype, null)
ERROR: 
select format_type('bpchar'::regtype, null)

Catalog Error: Type with name regtype does not exist!
Did you mean "date"?

-- this behavior difference is intentional
select format_type('bpchar'::regtype, -1)
ERROR: 
-- this behavior difference is intentional
select format_type('bpchar'::regtype, -1)

Catalog Error: Type with name regtype does not exist!
Did you mean "date"?


-- Test non-error-throwing APIs using widget, which still throws errors
SELECT pg_input_is_valid('(1,2,3)', 'widget')
ERROR: 

-- Test non-error-throwing APIs using widget, which still throws errors
SELECT pg_input_is_valid('(1,2,3)', 'widget')

Catalog Error: Scalar Function with name pg_input_is_valid does not exist!
Did you mean "json_valid"?

SELECT pg_input_is_valid('(1,2)', 'widget')
ERROR: 
SELECT pg_input_is_valid('(1,2)', 'widget')

Catalog Error: Scalar Function with name pg_input_is_valid does not exist!
Did you mean "json_valid"?
  -- hard error expected
SELECT pg_input_is_valid('{"(1,2,3)"}', 'widget[]')
ERROR:   -- hard error expected
SELECT pg_input_is_valid('{"(1,2,3)"}', 'widget[]')

Catalog Error: Scalar Function with name pg_input_is_valid does not exist!
Did you mean "json_valid"?

SELECT pg_input_is_valid('{"(1,2)"}', 'widget[]')
ERROR: 
SELECT pg_input_is_valid('{"(1,2)"}', 'widget[]')

Catalog Error: Scalar Function with name pg_input_is_valid does not exist!
Did you mean "json_valid"?
  -- hard error expected
SELECT pg_input_is_valid('("(1,2,3)")', 'mytab')
ERROR:   -- hard error expected
SELECT pg_input_is_valid('("(1,2,3)")', 'mytab')

Catalog Error: Scalar Function with name pg_input_is_valid does not exist!
Did you mean "json_valid"?

SELECT pg_input_is_valid('("(1,2)")', 'mytab')
ERROR: 
SELECT pg_input_is_valid('("(1,2)")', 'mytab')

Catalog Error: Scalar Function with name pg_input_is_valid does not exist!
Did you mean "json_valid"?
  -- hard error expected

-- Test creation of an operator over a user-defined type

CREATE FUNCTION pt_in_widget(point, widget)
   RETURNS bool
   AS /* REPLACED */ '/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress/regress.so'
   LANGUAGE C STRICT
ERROR:   -- hard error expected

-- Test creation of an operator over a user-defined type

CREATE FUNCTION pt_in_widget(point, widget)
   RETURNS bool
   AS /* REPLACED */ '/home/keuscha/Documents/FS2024/AST/project/postgresql/src/test/regress/regress.so'
   LANGUAGE C STRICT

Parser Error: syntax error at or near "RETURNS"


CREATE OPERATOR <% (
   leftarg = point,
   rightarg = widget,
   procedure = pt_in_widget,
   commutator = >% ,
   negator = >=%
)
ERROR: 

CREATE OPERATOR <% (
   leftarg = point,
   rightarg = widget,
   procedure = pt_in_widget,
   commutator = >% ,
   negator = >=%
)

Parser Error: syntax error at or near "OPERATOR"


SELECT point '(1,2)' <% widget '(0,0,3)' AS t,
       point '(1,2)' <% widget '(0,0,1)' AS f
ERROR: 

SELECT point '(1,2)' <% widget '(0,0,3)' AS t,
       point '(1,2)' <% widget '(0,0,1)' AS f

Catalog Error: Scalar Function with name <% does not exist!
Did you mean "%"?


-- exercise city_budget type
CREATE TABLE city (
	name		name,
	location 	box,
	budget 		city_budget
)
ERROR: 

-- exercise city_budget type
CREATE TABLE city (
	name		name,
	location 	box,
	budget 		city_budget
)

Catalog Error: Type with name name does not exist!
Did you mean "date"?


INSERT INTO city VALUES
('Podunk', '(1,2),(3,4)', '100,127,1000'),
('Gotham', '(1000,34),(1100,334)', '123456,127,-1000,6789')
ERROR: 

INSERT INTO city VALUES
('Podunk', '(1,2),(3,4)', '100,127,1000'),
('Gotham', '(1000,34),(1100,334)', '123456,127,-1000,6789')

Catalog Error: Table with name city does not exist!
Did you mean "pg_type"?


TABLE city
ERROR: 

TABLE city

Catalog Error: Table with name city does not exist!
Did you mean "pg_type"?


--
-- Test CREATE/ALTER TYPE using a type that''s compatible with varchar,
-- so we can re-use those support functions
--
CREATE TYPE myvarchar
ERROR: 

--
-- Test CREATE/ALTER TYPE using a type that''s compatible with varchar,
-- so we can re-use those support functions
--
CREATE TYPE myvarchar

Parser Error: syntax error at end of input


CREATE FUNCTION myvarcharin(cstring, oid, integer) RETURNS myvarchar
LANGUAGE internal IMMUTABLE PARALLEL SAFE STRICT AS 'varcharin'
ERROR: 

CREATE FUNCTION myvarcharin(cstring, oid, integer) RETURNS myvarchar
LANGUAGE internal IMMUTABLE PARALLEL SAFE STRICT AS 'varcharin'

Parser Error: syntax error at or near "RETURNS"


CREATE FUNCTION myvarcharout(myvarchar) RETURNS cstring
LANGUAGE internal IMMUTABLE PARALLEL SAFE STRICT AS 'varcharout'
ERROR: 

CREATE FUNCTION myvarcharout(myvarchar) RETURNS cstring
LANGUAGE internal IMMUTABLE PARALLEL SAFE STRICT AS 'varcharout'

Parser Error: syntax error at or near "RETURNS"


CREATE FUNCTION myvarcharsend(myvarchar) RETURNS bytea
LANGUAGE internal STABLE PARALLEL SAFE STRICT AS 'varcharsend'
ERROR: 

CREATE FUNCTION myvarcharsend(myvarchar) RETURNS bytea
LANGUAGE internal STABLE PARALLEL SAFE STRICT AS 'varcharsend'

Parser Error: syntax error at or near "RETURNS"


CREATE FUNCTION myvarcharrecv(internal, oid, integer) RETURNS myvarchar
LANGUAGE internal STABLE PARALLEL SAFE STRICT AS 'varcharrecv'
ERROR: 

CREATE FUNCTION myvarcharrecv(internal, oid, integer) RETURNS myvarchar
LANGUAGE internal STABLE PARALLEL SAFE STRICT AS 'varcharrecv'

Parser Error: syntax error at or near "RETURNS"


-- fail, it''s still a shell:
ALTER TYPE myvarchar SET (storage = extended)
ERROR: 

-- fail, it''s still a shell:
ALTER TYPE myvarchar SET (storage = extended)

Parser Error: syntax error at or near "TYPE"


CREATE TYPE myvarchar (
    input = myvarcharin,
    output = myvarcharout,
    alignment = integer,
    storage = main
)
ERROR: 

CREATE TYPE myvarchar (
    input = myvarcharin,
    output = myvarcharout,
    alignment = integer,
    storage = main
)

Parser Error: syntax error at or near "("


-- want to check updating of a domain over the target type, too
CREATE DOMAIN myvarchardom AS myvarchar
ERROR: 

-- want to check updating of a domain over the target type, too
CREATE DOMAIN myvarchardom AS myvarchar

Parser Error: syntax error at or near "DOMAIN"


ALTER TYPE myvarchar SET (storage = plain)
ERROR: 

ALTER TYPE myvarchar SET (storage = plain)

Parser Error: syntax error at or near "TYPE"
  -- not allowed

ALTER TYPE myvarchar SET (storage = extended)
ERROR:   -- not allowed

ALTER TYPE myvarchar SET (storage = extended)

Parser Error: syntax error at or near "TYPE"


ALTER TYPE myvarchar SET (
    send = myvarcharsend,
    receive = myvarcharrecv,
    typmod_in = varchartypmodin,
    typmod_out = varchartypmodout,
    -- these are bogus, but it''s safe as long as we don''t use the type:
    analyze = ts_typanalyze,
    subscript = raw_array_subscript_handler
)
ERROR: 

ALTER TYPE myvarchar SET (
    send = myvarcharsend,
    receive = myvarcharrecv,
    typmod_in = varchartypmodin,
    typmod_out = varchartypmodout,
    -- these are bogus, but it''s safe as long as we don''t use the type:
    analyze = ts_typanalyze,
    subscript = raw_array_subscript_handler
)

Parser Error: syntax error at or near "TYPE"


SELECT typinput, typoutput, typreceive, typsend, typmodin, typmodout,
       typanalyze, typsubscript, typstorage
FROM pg_type WHERE typname = 'myvarchar'
RESULT: 
	[]


SELECT typinput, typoutput, typreceive, typsend, typmodin, typmodout,
       typanalyze, typsubscript, typstorage
FROM pg_type WHERE typname = '_myvarchar'
RESULT: 
	[]


SELECT typinput, typoutput, typreceive, typsend, typmodin, typmodout,
       typanalyze, typsubscript, typstorage
FROM pg_type WHERE typname = 'myvarchardom'
RESULT: 
	[]


SELECT typinput, typoutput, typreceive, typsend, typmodin, typmodout,
       typanalyze, typsubscript, typstorage
FROM pg_type WHERE typname = '_myvarchardom'
RESULT: 
	[]


-- ensure dependencies are straight
DROP FUNCTION myvarcharsend(myvarchar)
ERROR: 

-- ensure dependencies are straight
DROP FUNCTION myvarcharsend(myvarchar)

Parser Error: syntax error at or near "("
  -- fail
DROP TYPE myvarchar
ERROR:   -- fail
DROP TYPE myvarchar

Catalog Error: Type with name myvarchar does not exist!
Did you mean "varchar"?
  -- fail

DROP TYPE myvarchar CASCADE
ERROR:   -- fail

DROP TYPE myvarchar CASCADE

Catalog Error: Type with name myvarchar does not exist!
Did you mean "varchar"?


