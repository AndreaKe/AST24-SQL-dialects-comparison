--
-- Verify system catalog foreign key relationships
--
DO $doblock$
declare
  fk record
ProgrammingError: --
-- Verify system catalog foreign key relationships
--
DO $doblock$
declare
  fk record

unterminated dollar-quoted string at or near "$doblock$
declare
  fk record
"
LINE 4: DO $doblock$
           ^


  nkeys integer
ProgrammingError: 
  nkeys integer

syntax error at or near "nkeys"
LINE 2:   nkeys integer
          ^


  cmd text
ProgrammingError: 
  cmd text

syntax error at or near "cmd"
LINE 2:   cmd text
          ^


  err record
ProgrammingError: 
  err record

syntax error at or near "err"
LINE 2:   err record
          ^


begin
  for fk in select * from pg_get_catalog_foreign_keys()
  loop
    raise notice 'checking % % => % %',
      fk.fktable, fk.fkcols, fk.pktable, fk.pkcols
ProgrammingError: 
begin
  for fk in select * from pg_get_catalog_foreign_keys()
  loop
    raise notice 'checking % % => % %',
      fk.fktable, fk.fkcols, fk.pktable, fk.pkcols

syntax error at or near "for"
LINE 3:   for fk in select * from pg_get_catalog_foreign_keys()
          ^


    nkeys := array_length(fk.fkcols, 1)
ProgrammingError: 
    nkeys := array_length(fk.fkcols, 1)

syntax error at or near "nkeys"
LINE 2:     nkeys := array_length(fk.fkcols, 1)
            ^


    cmd := 'SELECT ctid'
ProgrammingError: 
    cmd := 'SELECT ctid'

syntax error at or near "cmd"
LINE 2:     cmd := 'SELECT ctid'
            ^


    for i in 1 .. nkeys loop
      cmd := cmd || ', ' || quote_ident(fk.fkcols[i])
ProgrammingError: 
    for i in 1 .. nkeys loop
      cmd := cmd || ', ' || quote_ident(fk.fkcols[i])

syntax error at or near "for"
LINE 2:     for i in 1 .. nkeys loop
            ^


    end loop
ProgrammingError: 
    end loop

syntax error at or near "loop"
LINE 2:     end loop
                ^


    if fk.is_array then
      cmd := cmd || ' FROM (SELECT ctid'
ProgrammingError: 
    if fk.is_array then
      cmd := cmd || ' FROM (SELECT ctid'

syntax error at or near "if"
LINE 2:     if fk.is_array then
            ^


      for i in 1 .. nkeys-1 loop
        cmd := cmd || ', ' || quote_ident(fk.fkcols[i])
ProgrammingError: 
      for i in 1 .. nkeys-1 loop
        cmd := cmd || ', ' || quote_ident(fk.fkcols[i])

syntax error at or near "for"
LINE 2:       for i in 1 .. nkeys-1 loop
              ^


      end loop
ProgrammingError: 
      end loop

syntax error at or near "loop"
LINE 2:       end loop
                  ^


      cmd := cmd || ', unnest(' || quote_ident(fk.fkcols[nkeys])
ProgrammingError: 
      cmd := cmd || ', unnest(' || quote_ident(fk.fkcols[nkeys])

syntax error at or near "cmd"
LINE 2:       cmd := cmd || ', unnest(' || quote_ident(fk.fkcols[nke...
              ^


      cmd := cmd || ') as ' || quote_ident(fk.fkcols[nkeys])
ProgrammingError: 
      cmd := cmd || ') as ' || quote_ident(fk.fkcols[nkeys])

syntax error at or near "cmd"
LINE 2:       cmd := cmd || ') as ' || quote_ident(fk.fkcols[nkeys])
              ^


      cmd := cmd || ' FROM ' || fk.fktable::text || ') fk WHERE '
ProgrammingError: 
      cmd := cmd || ' FROM ' || fk.fktable::text || ') fk WHERE '

syntax error at or near "cmd"
LINE 2:       cmd := cmd || ' FROM ' || fk.fktable::text || ') fk WH...
              ^


    else
      cmd := cmd || ' FROM ' || fk.fktable::text || ' fk WHERE '
ProgrammingError: 
    else
      cmd := cmd || ' FROM ' || fk.fktable::text || ' fk WHERE '

syntax error at or near "else"
LINE 2:     else
            ^


    end if
ProgrammingError: 
    end if

syntax error at or near "if"
LINE 2:     end if
                ^


    if fk.is_opt then
      for i in 1 .. nkeys loop
        cmd := cmd || quote_ident(fk.fkcols[i]) || ' != 0 AND '
ProgrammingError: 
    if fk.is_opt then
      for i in 1 .. nkeys loop
        cmd := cmd || quote_ident(fk.fkcols[i]) || ' != 0 AND '

syntax error at or near "if"
LINE 2:     if fk.is_opt then
            ^


      end loop
ProgrammingError: 
      end loop

syntax error at or near "loop"
LINE 2:       end loop
                  ^


    end if
ProgrammingError: 
    end if

syntax error at or near "if"
LINE 2:     end if
                ^


    cmd := cmd || 'NOT EXISTS(SELECT 1 FROM ' || fk.pktable::text || ' pk WHERE '
ProgrammingError: 
    cmd := cmd || 'NOT EXISTS(SELECT 1 FROM ' || fk.pktable::text || ' pk WHERE '

syntax error at or near "cmd"
LINE 2:     cmd := cmd || 'NOT EXISTS(SELECT 1 FROM ' || fk.pktable:...
            ^


    for i in 1 .. nkeys loop
      if i > 1 then cmd := cmd || ' AND '
ProgrammingError: 
    for i in 1 .. nkeys loop
      if i > 1 then cmd := cmd || ' AND '

syntax error at or near "for"
LINE 2:     for i in 1 .. nkeys loop
            ^

 end if
ProgrammingError:  end if

syntax error at or near "if"
LINE 1:  end if
             ^


      cmd := cmd || 'pk.' || quote_ident(fk.pkcols[i])
ProgrammingError: 
      cmd := cmd || 'pk.' || quote_ident(fk.pkcols[i])

syntax error at or near "cmd"
LINE 2:       cmd := cmd || 'pk.' || quote_ident(fk.pkcols[i])
              ^


      cmd := cmd || ' = fk.' || quote_ident(fk.fkcols[i])
ProgrammingError: 
      cmd := cmd || ' = fk.' || quote_ident(fk.fkcols[i])

syntax error at or near "cmd"
LINE 2:       cmd := cmd || ' = fk.' || quote_ident(fk.fkcols[i])
              ^


    end loop
ProgrammingError: 
    end loop

syntax error at or near "loop"
LINE 2:     end loop
                ^


    cmd := cmd || ')'
ProgrammingError: 
    cmd := cmd || ')'

syntax error at or near "cmd"
LINE 2:     cmd := cmd || ')'
            ^


    -- raise notice ''cmd = %'', cmd /* REPLACED */,
    for err in execute cmd loop
      raise warning 'FK VIOLATION IN %(%): %', fk.fktable, fk.fkcols, err
ProgrammingError: 
    -- raise notice ''cmd = %'', cmd /* REPLACED */,
    for err in execute cmd loop
      raise warning 'FK VIOLATION IN %(%): %', fk.fktable, fk.fkcols, err

syntax error at or near "for"
LINE 3:     for err in execute cmd loop
            ^


    end loop
ProgrammingError: 
    end loop

syntax error at or near "loop"
LINE 2:     end loop
                ^


  end loop
ProgrammingError: 
  end loop

syntax error at or near "loop"
LINE 2:   end loop
              ^


end
$doblock$
ProgrammingError: 
end
$doblock$

unterminated dollar-quoted string at or near "$doblock$
"
LINE 3: $doblock$
        ^



