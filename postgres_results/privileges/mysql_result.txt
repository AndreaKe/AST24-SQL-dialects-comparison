
-----------
QUERY:
--
-- Test access privileges
--

-- Clean up in case a prior regression run failed

-- Suppress NOTICE messages when users/groups don/* REPLACED */ ''t exist
SET client_min_messages TO 'warning';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO 'warning'' at line 8")

-----------
QUERY:


DROP ROLE IF EXISTS regress_priv_group1;
RESULT:
	[]

-----------
QUERY:

DROP ROLE IF EXISTS regress_priv_group2;
RESULT:
	[]

-----------
QUERY:


DROP ROLE IF EXISTS regress_priv_user1;
RESULT:
	[]

-----------
QUERY:

DROP ROLE IF EXISTS regress_priv_user2;
RESULT:
	[]

-----------
QUERY:

DROP ROLE IF EXISTS regress_priv_user3;
RESULT:
	[]

-----------
QUERY:

DROP ROLE IF EXISTS regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

DROP ROLE IF EXISTS regress_priv_user5;
RESULT:
	[]

-----------
QUERY:

DROP ROLE IF EXISTS regress_priv_user6;
RESULT:
	[]

-----------
QUERY:

DROP ROLE IF EXISTS regress_priv_user7;
RESULT:
	[]

-----------
QUERY:


SELECT lo_unlink(oid) FROM pg_largeobject_metadata WHERE oid >= 1000 AND oid < 3000 ORDER BY oid;
RESULT:
	ERROR - (1146, "Table 'test.pg_largeobject_metadata' doesn't exist")

-----------
QUERY:


RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:


-- test proper begins here

CREATE USER regress_priv_user1;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user2;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user3;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user5;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user5;
RESULT:
	ERROR - (1396, "Operation CREATE USER failed for 'regress_priv_user5'@'%'")

-----------
QUERY:
	-- duplicate
CREATE USER regress_priv_user6;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user7;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user8;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user9;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user10;
RESULT:
	[]

-----------
QUERY:

CREATE ROLE regress_priv_role;
RESULT:
	[]

-----------
QUERY:


-- circular ADMIN OPTION grants should be disallowed
GRANT regress_priv_user1 TO regress_priv_user2 WITH ADMIN OPTION;
RESULT:
	[]

-----------
QUERY:

GRANT regress_priv_user1 TO regress_priv_user3 WITH ADMIN OPTION GRANTED BY regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY regress_priv_user2' at line 1")

-----------
QUERY:

GRANT regress_priv_user1 TO regress_priv_user2 WITH ADMIN OPTION GRANTED BY regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY regress_priv_user3' at line 1")

-----------
QUERY:


-- need CASCADE to revoke grant or admin option if dependent grants exist
REVOKE ADMIN OPTION FOR regress_priv_user1 FROM regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPTION FOR regress_priv_user1 FROM regress_priv_user2' at line 2")

-----------
QUERY:
 -- fail
REVOKE regress_priv_user1 FROM regress_priv_user2;
RESULT:
	[]

-----------
QUERY:
 -- fail
SELECT member::regrole, admin_option FROM pg_auth_members WHERE roleid = 'regress_priv_user1'::regrole;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regrole, admin_option FROM pg_auth_members WHERE roleid = 'regress_priv_user1'' at line 2")

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

REVOKE ADMIN OPTION FOR regress_priv_user1 FROM regress_priv_user2 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPTION FOR regress_priv_user1 FROM regress_priv_user2 CASCADE' at line 1")

-----------
QUERY:

SELECT member::regrole, admin_option FROM pg_auth_members WHERE roleid = 'regress_priv_user1'::regrole;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regrole, admin_option FROM pg_auth_members WHERE roleid = 'regress_priv_user1'' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:

REVOKE regress_priv_user1 FROM regress_priv_user2 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:

SELECT member::regrole, admin_option FROM pg_auth_members WHERE roleid = 'regress_priv_user1'::regrole;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regrole, admin_option FROM pg_auth_members WHERE roleid = 'regress_priv_user1'' at line 1")

-----------
QUERY:


-- inferred grantor must be a role with ADMIN OPTION
GRANT regress_priv_user1 TO regress_priv_user2 WITH ADMIN OPTION;
RESULT:
	[]

-----------
QUERY:

GRANT regress_priv_user2 TO regress_priv_user3;
RESULT:
	[]

-----------
QUERY:

SET ROLE regress_priv_user3;
RESULT:
	ERROR - (3530, '`regress_priv_user3`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

GRANT regress_priv_user1 TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

SELECT grantor::regrole FROM pg_auth_members WHERE roleid = 'regress_priv_user1'::regrole and member = 'regress_priv_user4'::regrole;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regrole FROM pg_auth_members WHERE roleid = 'regress_priv_user1'::regrole and ' at line 1")

-----------
QUERY:

RESET ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ROLE' at line 1")

-----------
QUERY:

REVOKE regress_priv_user2 FROM regress_priv_user3;
RESULT:
	[]

-----------
QUERY:

REVOKE regress_priv_user1 FROM regress_priv_user2 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:


-- test GRANTED BY with DROP OWNED and REASSIGN OWNED
GRANT regress_priv_user1 TO regress_priv_user2 WITH ADMIN OPTION;
RESULT:
	[]

-----------
QUERY:

GRANT regress_priv_user1 TO regress_priv_user3 GRANTED BY regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY regress_priv_user2' at line 1")

-----------
QUERY:

DROP ROLE regress_priv_user2;
RESULT:
	[]

-----------
QUERY:
 -- fail, dependency
REASSIGN OWNED BY regress_priv_user2 TO regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REASSIGN OWNED BY regress_priv_user2 TO regress_priv_user4' at line 2")

-----------
QUERY:

DROP ROLE regress_priv_user2;
RESULT:
	ERROR - (1396, "Operation DROP ROLE failed for 'regress_priv_user2'@'%'")

-----------
QUERY:
 -- still fail, REASSIGN OWNED doesn/* REPLACED */ ''t help
DROP OWNED BY regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNED BY regress_priv_user2' at line 2")

-----------
QUERY:

DROP ROLE regress_priv_user2;
RESULT:
	ERROR - (1396, "Operation DROP ROLE failed for 'regress_priv_user2'@'%'")

-----------
QUERY:
 -- ok now, DROP OWNED does the job

-- test that removing granted role or grantee role removes dependency
GRANT regress_priv_user1 TO regress_priv_user3 WITH ADMIN OPTION;
RESULT:
	[]

-----------
QUERY:

GRANT regress_priv_user1 TO regress_priv_user4 GRANTED BY regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY regress_priv_user3' at line 1")

-----------
QUERY:

DROP ROLE regress_priv_user3;
RESULT:
	[]

-----------
QUERY:
 -- should fail, dependency
DROP ROLE regress_priv_user4;
RESULT:
	[]

-----------
QUERY:
 -- ok
DROP ROLE regress_priv_user3;
RESULT:
	ERROR - (1396, "Operation DROP ROLE failed for 'regress_priv_user3'@'%'")

-----------
QUERY:
 -- ok now
GRANT regress_priv_user1 TO regress_priv_user5 WITH ADMIN OPTION;
RESULT:
	[]

-----------
QUERY:

GRANT regress_priv_user1 TO regress_priv_user6 GRANTED BY regress_priv_user5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY regress_priv_user5' at line 1")

-----------
QUERY:

DROP ROLE regress_priv_user5;
RESULT:
	[]

-----------
QUERY:
 -- should fail, dependency
DROP ROLE regress_priv_user1, regress_priv_user5;
RESULT:
	ERROR - (1396, "Operation DROP ROLE failed for 'regress_priv_user5'@'%'")

-----------
QUERY:
 -- ok, despite order

-- recreate the roles we just dropped
CREATE USER regress_priv_user1;
RESULT:
	ERROR - (1396, "Operation CREATE USER failed for 'regress_priv_user1'@'%'")

-----------
QUERY:

CREATE USER regress_priv_user2;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user3;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

CREATE USER regress_priv_user5;
RESULT:
	[]

-----------
QUERY:


GRANT pg_read_all_data TO regress_priv_user6;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `pg_read_all_data`@`%`')

-----------
QUERY:

GRANT pg_write_all_data TO regress_priv_user7;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `pg_write_all_data`@`%`')

-----------
QUERY:

GRANT pg_read_all_settings TO regress_priv_user8 WITH ADMIN OPTION;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `pg_read_all_settings`@`%`')

-----------
QUERY:

GRANT regress_priv_user9 TO regress_priv_user8;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user8;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user8' at line 1")

-----------
QUERY:

GRANT pg_read_all_settings TO regress_priv_user9 WITH ADMIN OPTION;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `pg_read_all_settings`@`%`')

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user9;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user9' at line 1")

-----------
QUERY:

GRANT pg_read_all_settings TO regress_priv_user10;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `pg_read_all_settings`@`%`')

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user8;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user8' at line 1")

-----------
QUERY:

REVOKE pg_read_all_settings FROM regress_priv_user10 GRANTED BY regress_priv_user9;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY regress_priv_user9' at line 1")

-----------
QUERY:

REVOKE ADMIN OPTION FOR pg_read_all_settings FROM regress_priv_user9;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPTION FOR pg_read_all_settings FROM regress_priv_user9' at line 1")

-----------
QUERY:

REVOKE pg_read_all_settings FROM regress_priv_user9;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `pg_read_all_settings`@`%`')

-----------
QUERY:


RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 1")

-----------
QUERY:

REVOKE regress_priv_user9 FROM regress_priv_user8;
RESULT:
	[]

-----------
QUERY:

REVOKE ADMIN OPTION FOR pg_read_all_settings FROM regress_priv_user8;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPTION FOR pg_read_all_settings FROM regress_priv_user8' at line 1")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user8;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user8' at line 1")

-----------
QUERY:

SET ROLE pg_read_all_settings;
RESULT:
	ERROR - (3530, '`pg_read_all_settings`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

RESET ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ROLE' at line 1")

-----------
QUERY:


RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 1")

-----------
QUERY:

REVOKE SET OPTION FOR pg_read_all_settings FROM regress_priv_user8;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SET OPTION FOR pg_read_all_settings FROM regress_priv_user8' at line 1")

-----------
QUERY:

GRANT pg_read_all_stats TO regress_priv_user8 WITH SET FALSE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SET FALSE' at line 1")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user8;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user8' at line 1")

-----------
QUERY:

SET ROLE pg_read_all_settings;
RESULT:
	ERROR - (3530, '`pg_read_all_settings`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:
  -- fail, no SET option any more
SET ROLE pg_read_all_stats;
RESULT:
	ERROR - (3530, '`pg_read_all_stats`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:
     -- fail, granted without SET option
RESET ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ROLE' at line 2")

-----------
QUERY:


RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 1")

-----------
QUERY:

REVOKE pg_read_all_settings FROM regress_priv_user8;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `pg_read_all_settings`@`%`')

-----------
QUERY:


DROP USER regress_priv_user10;
RESULT:
	[]

-----------
QUERY:

DROP USER regress_priv_user9;
RESULT:
	[]

-----------
QUERY:

DROP USER regress_priv_user8;
RESULT:
	[]

-----------
QUERY:


CREATE GROUP regress_priv_group1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP regress_priv_group1' at line 1")

-----------
QUERY:

CREATE GROUP regress_priv_group2 WITH ADMIN regress_priv_user1 USER regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP regress_priv_group2 WITH ADMIN regress_priv_user1 USER regress_priv_user2' at line 1")

-----------
QUERY:


ALTER GROUP regress_priv_group1 ADD USER regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP regress_priv_group1 ADD USER regress_priv_user4' at line 1")

-----------
QUERY:


GRANT regress_priv_group2 TO regress_priv_user2 GRANTED BY regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY regress_priv_user1' at line 1")

-----------
QUERY:

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 1")

-----------
QUERY:

ALTER GROUP regress_priv_group2 ADD USER regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP regress_priv_group2 ADD USER regress_priv_user2' at line 1")

-----------
QUERY:

ALTER GROUP regress_priv_group2 ADD USER regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP regress_priv_group2 ADD USER regress_priv_user2' at line 1")

-----------
QUERY:
	-- duplicate
ALTER GROUP regress_priv_group2 DROP USER regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP regress_priv_group2 DROP USER regress_priv_user2' at line 2")

-----------
QUERY:

ALTER USER regress_priv_user2 PASSWORD 'verysecret';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''verysecret'' at line 1")

-----------
QUERY:
 -- not permitted
RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 2")

-----------
QUERY:

ALTER GROUP regress_priv_group2 DROP USER regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP regress_priv_group2 DROP USER regress_priv_user2' at line 1")

-----------
QUERY:

REVOKE ADMIN OPTION FOR regress_priv_group2 FROM regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPTION FOR regress_priv_group2 FROM regress_priv_user1' at line 1")

-----------
QUERY:

GRANT regress_priv_group2 TO regress_priv_user4 WITH ADMIN OPTION;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `regress_priv_group2`@`%`')

-----------
QUERY:


-- prepare non-leakproof function for later
CREATE FUNCTION leak(integer,integer) RETURNS boolean
  AS 'int4lt'
  LANGUAGE internal IMMUTABLE STRICT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'integer,integer) RETURNS boolean\n  AS 'int4lt'\n  LANGUAGE internal IMMUTABLE STR' at line 2")

-----------
QUERY:
  -- but deliberately not LEAKPROOF
ALTER FUNCTION leak(integer,integer) OWNER TO regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(integer,integer) OWNER TO regress_priv_user1' at line 2")

-----------
QUERY:


-- test owner privileges

GRANT regress_priv_role TO regress_priv_user1 WITH ADMIN OPTION GRANTED BY regress_priv_role;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY regress_priv_role' at line 3")

-----------
QUERY:
 -- error, doesn/* REPLACED */ ''t have ADMIN OPTION
GRANT regress_priv_role TO regress_priv_user1 WITH ADMIN OPTION GRANTED BY CURRENT_ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY CURRENT_ROLE' at line 2")

-----------
QUERY:

REVOKE ADMIN OPTION FOR regress_priv_role FROM regress_priv_user1 GRANTED BY foo;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPTION FOR regress_priv_role FROM regress_priv_user1 GRANTED BY foo' at line 1")

-----------
QUERY:
 -- error
REVOKE ADMIN OPTION FOR regress_priv_role FROM regress_priv_user1 GRANTED BY regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPTION FOR regress_priv_role FROM regress_priv_user1 GRANTED BY regress_priv_use' at line 2")

-----------
QUERY:
 -- warning, noop
REVOKE ADMIN OPTION FOR regress_priv_role FROM regress_priv_user1 GRANTED BY CURRENT_USER;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPTION FOR regress_priv_role FROM regress_priv_user1 GRANTED BY CURRENT_USER' at line 2")

-----------
QUERY:

REVOKE regress_priv_role FROM regress_priv_user1 GRANTED BY CURRENT_ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY CURRENT_ROLE' at line 1")

-----------
QUERY:

DROP ROLE regress_priv_role;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 1")

-----------
QUERY:

SELECT session_user, current_user;
RESULT:
	ERROR - (1054, "Unknown column 'session_user' in 'field list'")

-----------
QUERY:


CREATE TABLE atest1 ( a int, b text );
RESULT:
	[]

-----------
QUERY:

SELECT * FROM atest1;
RESULT:
	()

-----------
QUERY:

INSERT INTO atest1 VALUES (1, 'one');
RESULT:
	[]

-----------
QUERY:

DELETE FROM atest1;
RESULT:
	[]

-----------
QUERY:

UPDATE atest1 SET a = 1 WHERE b = 'blech';
RESULT:
	[]

-----------
QUERY:

TRUNCATE atest1;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK atest1 IN ACCESS EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'atest1 IN ACCESS EXCLUSIVE MODE' at line 1")

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:


REVOKE ALL ON atest1 FROM PUBLIC;
RESULT:
	ERROR - (1147, "There is no such grant defined for user 'PUBLIC' on host '%' on table 'atest1'")

-----------
QUERY:

SELECT * FROM atest1;
RESULT:
	()

-----------
QUERY:


GRANT ALL ON atest1 TO regress_priv_user2;
RESULT:
	[]

-----------
QUERY:

GRANT SELECT ON atest1 TO regress_priv_user3, regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

SELECT * FROM atest1;
RESULT:
	()

-----------
QUERY:


CREATE TABLE atest2 (col1 varchar(10), col2 boolean);
RESULT:
	[]

-----------
QUERY:

GRANT SELECT ON atest2 TO regress_priv_user2;
RESULT:
	[]

-----------
QUERY:

GRANT UPDATE ON atest2 TO regress_priv_user3;
RESULT:
	[]

-----------
QUERY:

GRANT INSERT ON atest2 TO regress_priv_user4 GRANTED BY CURRENT_USER;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY CURRENT_USER' at line 1")

-----------
QUERY:

GRANT TRUNCATE ON atest2 TO regress_priv_user5 GRANTED BY CURRENT_ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY CURRENT_ROLE' at line 1")

-----------
QUERY:


GRANT TRUNCATE ON atest2 TO regress_priv_user4 GRANTED BY regress_priv_user5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GRANTED BY regress_priv_user5' at line 1")

-----------
QUERY:
  -- error


SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 4")

-----------
QUERY:

SELECT session_user, current_user;
RESULT:
	ERROR - (1054, "Unknown column 'session_user' in 'field list'")

-----------
QUERY:


-- try various combinations of queries on atest1 and atest2

SELECT * FROM atest1;
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT * FROM atest2;
RESULT:
	()

-----------
QUERY:
 -- ok
INSERT INTO atest1 VALUES (2, 'two');
RESULT:
	[]

-----------
QUERY:
 -- ok
INSERT INTO atest2 VALUES ('foo', true);
RESULT:
	[]

-----------
QUERY:
 -- fail
INSERT INTO atest1 SELECT 1, b FROM atest1;
RESULT:
	[]

-----------
QUERY:
 -- ok
UPDATE atest1 SET a = 1 WHERE a = 2;
RESULT:
	[]

-----------
QUERY:
 -- ok
UPDATE atest2 SET col2 = NOT col2;
RESULT:
	[]

-----------
QUERY:
 -- fail
SELECT * FROM atest1 FOR UPDATE;
RESULT:
	((1, 'two'), (1, 'two'))

-----------
QUERY:
 -- ok
SELECT * FROM atest2 FOR UPDATE;
RESULT:
	(('foo', 0),)

-----------
QUERY:
 -- fail
DELETE FROM atest2;
RESULT:
	[]

-----------
QUERY:
 -- fail
TRUNCATE atest2;
RESULT:
	[]

-----------
QUERY:
 -- fail
BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK atest2 IN ACCESS EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'atest2 IN ACCESS EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- fail
COMMIT;
RESULT:
	[]

-----------
QUERY:

COPY atest2 FROM stdin;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COPY atest2 FROM stdin' at line 1")

-----------
QUERY:
 -- fail
GRANT ALL ON atest1 TO PUBLIC;
RESULT:
	ERROR - (1410, 'You are not allowed to create a user with GRANT')

-----------
QUERY:
 -- fail

-- checks in subquery, both ok
SELECT * FROM atest1 WHERE ( b IN ( SELECT col1 FROM atest2 ) );
RESULT:
	()

-----------
QUERY:

SELECT * FROM atest2 WHERE ( col1 IN ( SELECT b FROM atest1 ) );
RESULT:
	()

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user6;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user6' at line 1")

-----------
QUERY:

SELECT * FROM atest1;
RESULT:
	((1, 'two'), (1, 'two'))

-----------
QUERY:
 -- ok
SELECT * FROM atest2;
RESULT:
	()

-----------
QUERY:
 -- ok
INSERT INTO atest2 VALUES ('foo', true);
RESULT:
	[]

-----------
QUERY:
 -- fail

SET SESSION AUTHORIZATION regress_priv_user7;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user7' at line 3")

-----------
QUERY:

SELECT * FROM atest1;
RESULT:
	((1, 'two'), (1, 'two'))

-----------
QUERY:
 -- fail
SELECT * FROM atest2;
RESULT:
	(('foo', 1),)

-----------
QUERY:
 -- fail
INSERT INTO atest2 VALUES ('foo', true);
RESULT:
	[]

-----------
QUERY:
 -- ok
UPDATE atest2 SET col2 = true;
RESULT:
	[]

-----------
QUERY:
 -- ok
DELETE FROM atest2;
RESULT:
	[]

-----------
QUERY:
 -- ok

-- Make sure we are not able to modify system catalogs
UPDATE pg_catalog.pg_class SET relname = '123';
RESULT:
	ERROR - (1049, "Unknown database 'pg_catalog'")

-----------
QUERY:
 -- fail
DELETE FROM pg_catalog.pg_class;
RESULT:
	ERROR - (1049, "Unknown database 'pg_catalog'")

-----------
QUERY:
 -- fail
UPDATE pg_toast.pg_toast_1213 SET chunk_id = 1;
RESULT:
	ERROR - (1049, "Unknown database 'pg_toast'")

-----------
QUERY:
 -- fail

SET SESSION AUTHORIZATION regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user3' at line 3")

-----------
QUERY:

SELECT session_user, current_user;
RESULT:
	ERROR - (1054, "Unknown column 'session_user' in 'field list'")

-----------
QUERY:


SELECT * FROM atest1;
RESULT:
	((1, 'two'), (1, 'two'))

-----------
QUERY:
 -- ok
SELECT * FROM atest2;
RESULT:
	()

-----------
QUERY:
 -- fail
INSERT INTO atest1 VALUES (2, 'two');
RESULT:
	[]

-----------
QUERY:
 -- fail
INSERT INTO atest2 VALUES ('foo', true);
RESULT:
	[]

-----------
QUERY:
 -- fail
INSERT INTO atest1 SELECT 1, b FROM atest1;
RESULT:
	[]

-----------
QUERY:
 -- fail
UPDATE atest1 SET a = 1 WHERE a = 2;
RESULT:
	[]

-----------
QUERY:
 -- fail
UPDATE atest2 SET col2 = NULL;
RESULT:
	[]

-----------
QUERY:
 -- ok
UPDATE atest2 SET col2 = NOT col2;
RESULT:
	[]

-----------
QUERY:
 -- fails /* REPLACED */ , requires SELECT on atest2
UPDATE atest2 SET col2 = true FROM atest1 WHERE atest1.a = 5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM atest1 WHERE atest1.a = 5' at line 2")

-----------
QUERY:
 -- ok
SELECT * FROM atest1 FOR UPDATE;
RESULT:
	((1, 'two'), (1, 'two'), (1, 'two'), (1, 'two'), (1, 'two'), (1, 'two'))

-----------
QUERY:
 -- fail
SELECT * FROM atest2 FOR UPDATE;
RESULT:
	(('foo', None),)

-----------
QUERY:
 -- fail
DELETE FROM atest2;
RESULT:
	[]

-----------
QUERY:
 -- fail
TRUNCATE atest2;
RESULT:
	[]

-----------
QUERY:
 -- fail
BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK atest2 IN ACCESS EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'atest2 IN ACCESS EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- ok
COMMIT;
RESULT:
	[]

-----------
QUERY:

COPY atest2 FROM stdin;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COPY atest2 FROM stdin' at line 1")

-----------
QUERY:
 -- fail

-- checks in subquery, both fail
SELECT * FROM atest1 WHERE ( b IN ( SELECT col1 FROM atest2 ) );
RESULT:
	()

-----------
QUERY:

SELECT * FROM atest2 WHERE ( col1 IN ( SELECT b FROM atest1 ) );
RESULT:
	()

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:

COPY atest2 FROM stdin;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COPY atest2 FROM stdin' at line 1")

-----------
QUERY:
 -- ok
bar	true
-- \.
SELECT * FROM atest1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'bar\ttrue\n-- \\.\nSELECT * FROM atest1' at line 2")

-----------
QUERY:
 -- ok


-- test leaky-function protections in selfuncs

-- regress_priv_user1 will own a table and provide views for it.
SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 7")

-----------
QUERY:


CREATE TABLE atest12 as
  SELECT x AS a, 10001 - x AS b FROM generate_series(1,10000) x;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(1,10000) x' at line 2")

-----------
QUERY:

CREATE INDEX ON atest12 (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON atest12 (a)' at line 1")

-----------
QUERY:

CREATE INDEX ON atest12 (abs(a));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON atest12 (abs(a))' at line 1")

-----------
QUERY:

-- results below depend on having quite accurate stats for atest12, so...
ALTER TABLE atest12 SET (autovacuum_enabled = off);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SET (autovacuum_enabled = off)' at line 2")

-----------
QUERY:

SET default_statistics_target = 10000;
RESULT:
	ERROR - (1193, "Unknown system variable 'default_statistics_target'")

-----------
QUERY:

VACUUM ANALYZE atest12;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VACUUM ANALYZE atest12' at line 1")

-----------
QUERY:

RESET default_statistics_target;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'default_statistics_target' at line 1")

-----------
QUERY:


CREATE OPERATOR <<< (procedure = leak, leftarg = integer, rightarg = integer,
                     restrict = scalarltsel);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPERATOR <<< (procedure = leak, leftarg = integer, rightarg = integer,\n         ' at line 1")

-----------
QUERY:


-- views with leaky operator
CREATE VIEW atest12v AS
  SELECT * FROM atest12 WHERE b <<< 5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '< 5' at line 3")

-----------
QUERY:

CREATE VIEW atest12sbv WITH (security_barrier=true) AS
  SELECT * FROM atest12 WHERE b <<< 5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'WITH (security_barrier=true) AS\n  SELECT * FROM atest12 WHERE b <<< 5' at line 1")

-----------
QUERY:

GRANT SELECT ON atest12v TO PUBLIC;
RESULT:
	ERROR - (1146, "Table 'test.atest12v' doesn't exist")

-----------
QUERY:

GRANT SELECT ON atest12sbv TO PUBLIC;
RESULT:
	ERROR - (1146, "Table 'test.atest12sbv' doesn't exist")

-----------
QUERY:


-- This plan should use nestloop, knowing that few rows will be selected.
EXPLAIN (COSTS OFF) SELECT * FROM atest12v x, atest12v y WHERE x.a = y.b;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM atest12v x, atest12v y WHERE x.a = y.b' at line 2")

-----------
QUERY:


-- And this one.
EXPLAIN (COSTS OFF) SELECT * FROM atest12 x, atest12 y
  WHERE x.a = y.b and abs(y.a) <<< 5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM atest12 x, atest12 y\n  WHERE x.a = y.b and abs(y.a) <<<' at line 2")

-----------
QUERY:


-- This should also be a nestloop, but the security barrier forces the inner
-- scan to be materialized
EXPLAIN (COSTS OFF) SELECT * FROM atest12sbv x, atest12sbv y WHERE x.a = y.b;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM atest12sbv x, atest12sbv y WHERE x.a = y.b' at line 3")

-----------
QUERY:


-- Check if regress_priv_user2 can break security.
SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 2")

-----------
QUERY:


CREATE FUNCTION leak2(integer,integer) RETURNS boolean
  AS $$begin raise notice 'leak % %', $1, $2; return $1 > $2; end$$
  LANGUAGE plpgsql immutable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'integer,integer) RETURNS boolean\n  AS $$begin raise notice 'leak % %', $1, $2; r' at line 1")

-----------
QUERY:

CREATE OPERATOR >>> (procedure = leak2, leftarg = integer, rightarg = integer,
                     restrict = scalargtsel);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPERATOR >>> (procedure = leak2, leftarg = integer, rightarg = integer,\n        ' at line 1")

-----------
QUERY:


-- This should not show any /* REPLACED */ ''leak/* REPLACED */ '' notices before failing.
EXPLAIN (COSTS OFF) SELECT * FROM atest12 WHERE a >>> 0;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM atest12 WHERE a >>> 0' at line 2")

-----------
QUERY:


-- These plans should continue to use a nestloop, since they execute with the
-- privileges of the view owner.
EXPLAIN (COSTS OFF) SELECT * FROM atest12v x, atest12v y WHERE x.a = y.b;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM atest12v x, atest12v y WHERE x.a = y.b' at line 3")

-----------
QUERY:

EXPLAIN (COSTS OFF) SELECT * FROM atest12sbv x, atest12sbv y WHERE x.a = y.b;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM atest12sbv x, atest12sbv y WHERE x.a = y.b' at line 1")

-----------
QUERY:


-- A non-security barrier view does not guard against information leakage.
EXPLAIN (COSTS OFF) SELECT * FROM atest12v x, atest12v y
  WHERE x.a = y.b and abs(y.a) <<< 5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM atest12v x, atest12v y\n  WHERE x.a = y.b and abs(y.a) <' at line 2")

-----------
QUERY:


-- But a security barrier view isolates the leaky operator.
EXPLAIN (COSTS OFF) SELECT * FROM atest12sbv x, atest12sbv y
  WHERE x.a = y.b and abs(y.a) <<< 5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM atest12sbv x, atest12sbv y\n  WHERE x.a = y.b and abs(y.' at line 2")

-----------
QUERY:


-- Now regress_priv_user1 grants sufficient access to regress_priv_user2.
SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 2")

-----------
QUERY:

GRANT SELECT (a, b) ON atest12 TO PUBLIC;
RESULT:
	ERROR - (1146, "Table 'test.atest12' doesn't exist")

-----------
QUERY:

SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:


-- regress_priv_user2 should continue to get a good row estimate.
EXPLAIN (COSTS OFF) SELECT * FROM atest12v x, atest12v y WHERE x.a = y.b;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM atest12v x, atest12v y WHERE x.a = y.b' at line 2")

-----------
QUERY:


-- But not for this, due to lack of table-wide permissions needed
-- to make use of the expression index/* REPLACED */ ''s statistics.
EXPLAIN (COSTS OFF) SELECT * FROM atest12 x, atest12 y
  WHERE x.a = y.b and abs(y.a) <<< 5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM atest12 x, atest12 y\n  WHERE x.a = y.b and abs(y.a) <<<' at line 3")

-----------
QUERY:


-- clean up (regress_priv_user1/* REPLACED */ ''s objects are all dropped later)
DROP FUNCTION leak2(integer, integer) CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(integer, integer) CASCADE' at line 2")

-----------
QUERY:



-- groups

SET SESSION AUTHORIZATION regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user3' at line 3")

-----------
QUERY:

CREATE TABLE atest3 (one int, two int, three int);
RESULT:
	[]

-----------
QUERY:

GRANT DELETE ON atest3 TO GROUP regress_priv_group2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP regress_priv_group2' at line 1")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 1")

-----------
QUERY:


SELECT * FROM atest3;
RESULT:
	()

-----------
QUERY:
 -- fail
DELETE FROM atest3;
RESULT:
	[]

-----------
QUERY:
 -- ok

BEGIN;
RESULT:
	[]

-----------
QUERY:

RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 1")

-----------
QUERY:

ALTER ROLE regress_priv_user1 NOINHERIT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ROLE regress_priv_user1 NOINHERIT' at line 1")

-----------
QUERY:

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 1")

-----------
QUERY:

SAVEPOINT s1;
RESULT:
	[]

-----------
QUERY:

DELETE FROM atest3;
RESULT:
	[]

-----------
QUERY:
 -- ok because grant-level option is unchanged
ROLLBACK TO s1;
RESULT:
	[]

-----------
QUERY:

RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 1")

-----------
QUERY:

GRANT regress_priv_group2 TO regress_priv_user1 WITH INHERIT FALSE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INHERIT FALSE' at line 1")

-----------
QUERY:

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 1")

-----------
QUERY:

DELETE FROM atest3;
RESULT:
	[]

-----------
QUERY:
 -- fail
ROLLBACK TO s1;
RESULT:
	[]

-----------
QUERY:

RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 1")

-----------
QUERY:

REVOKE INHERIT OPTION FOR regress_priv_group2 FROM regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPTION FOR regress_priv_group2 FROM regress_priv_user1' at line 1")

-----------
QUERY:

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 1")

-----------
QUERY:

DELETE FROM atest3;
RESULT:
	[]

-----------
QUERY:
 -- also fail
ROLLBACK;
RESULT:
	[]

-----------
QUERY:


-- views

SET SESSION AUTHORIZATION regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user3' at line 3")

-----------
QUERY:


CREATE VIEW atestv1 AS SELECT * FROM atest1;
RESULT:
	[]

-----------
QUERY:
 -- ok
/* The next *should* fail, but it's not implemented that way yet. */
CREATE VIEW atestv2 AS SELECT * FROM atest2;
RESULT:
	[]

-----------
QUERY:

CREATE VIEW atestv3 AS SELECT * FROM atest3;
RESULT:
	[]

-----------
QUERY:
 -- ok
/* Empty view is a corner case that failed in 9.2. */
CREATE VIEW atestv0 AS SELECT 0 as x WHERE false;
RESULT:
	[]

-----------
QUERY:
 -- ok

SELECT * FROM atestv1;
RESULT:
	((1, 'two'), (1, 'two'), (1, 'two'), (1, 'two'), (1, 'two'), (1, 'two'))

-----------
QUERY:
 -- ok
SELECT * FROM atestv2;
RESULT:
	()

-----------
QUERY:
 -- fail
GRANT SELECT ON atestv1, atestv3 TO regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ', atestv3 TO regress_priv_user4' at line 2")

-----------
QUERY:

GRANT SELECT ON atestv2 TO regress_priv_user2;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:


SELECT * FROM atestv1;
RESULT:
	((1, 'two'), (1, 'two'), (1, 'two'), (1, 'two'), (1, 'two'), (1, 'two'))

-----------
QUERY:
 -- ok
SELECT * FROM atestv2;
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT * FROM atestv3;
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT * FROM atestv0;
RESULT:
	()

-----------
QUERY:
 -- fail

-- Appendrels excluded by constraints failed to check permissions in 8.4-9.2.
select * from
  ((select a.q1 as x from int8_tbl a offset 0)
   union all
   (select b.q2 as x from int8_tbl b offset 0)) ss
where false;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'offset 0)\n   union all\n   (select b.q2 as x from int8_tbl b offset 0)) ss\nwhere ' at line 5")

-----------
QUERY:


set constraint_exclusion = on;
RESULT:
	ERROR - (1193, "Unknown system variable 'constraint_exclusion'")

-----------
QUERY:

select * from
  ((select a.q1 as x, random() from int8_tbl a where q1 > 0)
   union all
   (select b.q2 as x, random() from int8_tbl b where q2 > 0)) ss
where x < 0;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '() from int8_tbl a where q1 > 0)\n   union all\n   (select b.q2 as x, random() fro' at line 2")

-----------
QUERY:

reset constraint_exclusion;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'constraint_exclusion' at line 1")

-----------
QUERY:


CREATE VIEW atestv4 AS SELECT * FROM atestv3;
RESULT:
	[]

-----------
QUERY:
 -- nested view
SELECT * FROM atestv4;
RESULT:
	()

-----------
QUERY:
 -- ok
GRANT SELECT ON atestv4 TO regress_priv_user2;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:


-- Two complex cases:

SELECT * FROM atestv3;
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT * FROM atestv4;
RESULT:
	()

-----------
QUERY:
 -- ok (even though regress_priv_user2 cannot access underlying atestv3)

SELECT * FROM atest2;
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT * FROM atestv2;
RESULT:
	()

-----------
QUERY:
 -- fail (even though regress_priv_user2 can access underlying atest2)

-- Test column level permissions

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 5")

-----------
QUERY:

CREATE TABLE atest5 (one int, two int unique, three int, four int unique);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE atest6 (one int, two int, blue int);
RESULT:
	[]

-----------
QUERY:

GRANT SELECT (one), INSERT (two), UPDATE (three) ON atest5 TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

GRANT ALL (one) ON atest5 TO regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one) ON atest5 TO regress_priv_user3' at line 1")

-----------
QUERY:


INSERT INTO atest5 VALUES (1,2,3);
RESULT:
	ERROR - (1136, "Column count doesn't match value count at row 1")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:

SELECT * FROM atest5;
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT one FROM atest5;
RESULT:
	()

-----------
QUERY:
 -- ok
COPY atest5 (one) TO stdout;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COPY atest5 (one) TO stdout' at line 2")

-----------
QUERY:
 -- ok
SELECT two FROM atest5;
RESULT:
	()

-----------
QUERY:
 -- fail
COPY atest5 (two) TO stdout;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COPY atest5 (two) TO stdout' at line 2")

-----------
QUERY:
 -- fail
SELECT atest5 FROM atest5;
RESULT:
	ERROR - (1054, "Unknown column 'atest5' in 'field list'")

-----------
QUERY:
 -- fail
COPY atest5 (one,two) TO stdout;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COPY atest5 (one,two) TO stdout' at line 2")

-----------
QUERY:
 -- fail
SELECT 1 FROM atest5;
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT 1 FROM atest5 a JOIN atest5 b USING (one);
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT 1 FROM atest5 a JOIN atest5 b USING (two);
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT 1 FROM atest5 a NATURAL JOIN atest5 b;
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT * FROM (atest5 a JOIN atest5 b USING (one)) j;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'j' at line 2")

-----------
QUERY:
 -- fail
SELECT j.* FROM (atest5 a JOIN atest5 b USING (one)) j;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'j' at line 2")

-----------
QUERY:
 -- fail
SELECT (j.*) IS NULL FROM (atest5 a JOIN atest5 b USING (one)) j;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '*) IS NULL FROM (atest5 a JOIN atest5 b USING (one)) j' at line 2")

-----------
QUERY:
 -- fail
SELECT one FROM (atest5 a JOIN atest5 b(one,x,y,z) USING (one)) j;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one)) j' at line 2")

-----------
QUERY:
 -- ok
SELECT j.one FROM (atest5 a JOIN atest5 b(one,x,y,z) USING (one)) j;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one)) j' at line 2")

-----------
QUERY:
 -- ok
SELECT two FROM (atest5 a JOIN atest5 b(one,x,y,z) USING (one)) j;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one)) j' at line 2")

-----------
QUERY:
 -- fail
SELECT j.two FROM (atest5 a JOIN atest5 b(one,x,y,z) USING (one)) j;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one)) j' at line 2")

-----------
QUERY:
 -- fail
SELECT y FROM (atest5 a JOIN atest5 b(one,x,y,z) USING (one)) j;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one)) j' at line 2")

-----------
QUERY:
 -- fail
SELECT j.y FROM (atest5 a JOIN atest5 b(one,x,y,z) USING (one)) j;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one)) j' at line 2")

-----------
QUERY:
 -- fail
SELECT * FROM (atest5 a JOIN atest5 b USING (one));
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT a.* FROM (atest5 a JOIN atest5 b USING (one));
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT (a.*) IS NULL FROM (atest5 a JOIN atest5 b USING (one));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '*) IS NULL FROM (atest5 a JOIN atest5 b USING (one))' at line 2")

-----------
QUERY:
 -- fail
SELECT two FROM (atest5 a JOIN atest5 b(one,x,y,z) USING (one));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one))' at line 2")

-----------
QUERY:
 -- fail
SELECT a.two FROM (atest5 a JOIN atest5 b(one,x,y,z) USING (one));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one))' at line 2")

-----------
QUERY:
 -- fail
SELECT y FROM (atest5 a JOIN atest5 b(one,x,y,z) USING (one));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one))' at line 2")

-----------
QUERY:
 -- fail
SELECT b.y FROM (atest5 a JOIN atest5 b(one,x,y,z) USING (one));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one))' at line 2")

-----------
QUERY:
 -- fail
SELECT y FROM (atest5 a LEFT JOIN atest5 b(one,x,y,z) USING (one));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one))' at line 2")

-----------
QUERY:
 -- fail
SELECT b.y FROM (atest5 a LEFT JOIN atest5 b(one,x,y,z) USING (one));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one,x,y,z) USING (one))' at line 2")

-----------
QUERY:
 -- fail
SELECT y FROM (atest5 a FULL JOIN atest5 b(one,x,y,z) USING (one));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FULL JOIN atest5 b(one,x,y,z) USING (one))' at line 2")

-----------
QUERY:
 -- fail
SELECT b.y FROM (atest5 a FULL JOIN atest5 b(one,x,y,z) USING (one));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FULL JOIN atest5 b(one,x,y,z) USING (one))' at line 2")

-----------
QUERY:
 -- fail
SELECT 1 FROM atest5 WHERE two = 2;
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT * FROM atest1, atest5;
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT atest1.* FROM atest1, atest5;
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT atest1.*,atest5.one FROM atest1, atest5;
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT atest1.*,atest5.one FROM atest1 JOIN atest5 ON (atest1.a = atest5.two);
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT atest1.*,atest5.one FROM atest1 JOIN atest5 ON (atest1.a = atest5.one);
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT one, two FROM atest5;
RESULT:
	()

-----------
QUERY:
 -- fail

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:

GRANT SELECT (one,two) ON atest6 TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:

SELECT one, two FROM atest5 NATURAL JOIN atest6;
RESULT:
	()

-----------
QUERY:
 -- fail still

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:

GRANT SELECT (two) ON atest5 TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:

SELECT one, two FROM atest5 NATURAL JOIN atest6;
RESULT:
	()

-----------
QUERY:
 -- ok now

-- test column-level privileges for INSERT and UPDATE
INSERT INTO atest5 (two) VALUES (3);
RESULT:
	[]

-----------
QUERY:
 -- ok
COPY atest5 FROM stdin;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COPY atest5 FROM stdin' at line 2")

-----------
QUERY:
 -- fail
COPY atest5 (two) FROM stdin;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COPY atest5 (two) FROM stdin' at line 2")

-----------
QUERY:
 -- ok
1
-- \.
INSERT INTO atest5 (three) VALUES (4);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '1\n-- \\.\nINSERT INTO atest5 (three) VALUES (4)' at line 2")

-----------
QUERY:
 -- fail
INSERT INTO atest5 VALUES (5,5,5);
RESULT:
	ERROR - (1136, "Column count doesn't match value count at row 1")

-----------
QUERY:
 -- fail
UPDATE atest5 SET three = 10;
RESULT:
	[]

-----------
QUERY:
 -- ok
UPDATE atest5 SET one = 8;
RESULT:
	[]

-----------
QUERY:
 -- fail
UPDATE atest5 SET three = 5, one = 2;
RESULT:
	[]

-----------
QUERY:
 -- fail
-- Check that column level privs are enforced in RETURNING
-- Ok.
INSERT INTO atest5(two) VALUES (6) ON CONFLICT (two) DO UPDATE set three = 10;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONFLICT (two) DO UPDATE set three = 10' at line 4")

-----------
QUERY:

-- Error. No SELECT on column three.
INSERT INTO atest5(two) VALUES (6) ON CONFLICT (two) DO UPDATE set three = 10 RETURNING atest5.three;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONFLICT (two) DO UPDATE set three = 10 RETURNING atest5.three' at line 2")

-----------
QUERY:

-- Ok.  May SELECT on column /* REPLACED */ ''one/* REPLACED */ '':
INSERT INTO atest5(two) VALUES (6) ON CONFLICT (two) DO UPDATE set three = 10 RETURNING atest5.one;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONFLICT (two) DO UPDATE set three = 10 RETURNING atest5.one' at line 2")

-----------
QUERY:

-- Check that column level privileges are enforced for EXCLUDED
-- Ok. we may select one
INSERT INTO atest5(two) VALUES (6) ON CONFLICT (two) DO UPDATE set three = EXCLUDED.one;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONFLICT (two) DO UPDATE set three = EXCLUDED.one' at line 3")

-----------
QUERY:

-- Error. No select rights on three
INSERT INTO atest5(two) VALUES (6) ON CONFLICT (two) DO UPDATE set three = EXCLUDED.three;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONFLICT (two) DO UPDATE set three = EXCLUDED.three' at line 2")

-----------
QUERY:

INSERT INTO atest5(two) VALUES (6) ON CONFLICT (two) DO UPDATE set one = 8;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONFLICT (two) DO UPDATE set one = 8' at line 1")

-----------
QUERY:
 -- fails (due to UPDATE)
INSERT INTO atest5(three) VALUES (4) ON CONFLICT (two) DO UPDATE set three = 10;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONFLICT (two) DO UPDATE set three = 10' at line 2")

-----------
QUERY:
 -- fails (due to INSERT)

-- Check that the columns in the inference require select privileges
INSERT INTO atest5(four) VALUES (4);
RESULT:
	[]

-----------
QUERY:
 -- fail

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:

GRANT INSERT (four) ON atest5 TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:


INSERT INTO atest5(four) VALUES (4) ON CONFLICT (four) DO UPDATE set three = 3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONFLICT (four) DO UPDATE set three = 3' at line 1")

-----------
QUERY:
 -- fails (due to SELECT)
INSERT INTO atest5(four) VALUES (4) ON CONFLICT ON CONSTRAINT atest5_four_key DO UPDATE set three = 3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONFLICT ON CONSTRAINT atest5_four_key DO UPDATE set three = 3' at line 2")

-----------
QUERY:
 -- fails (due to SELECT)
INSERT INTO atest5(four) VALUES (4);
RESULT:
	ERROR - (1062, "Duplicate entry '4' for key 'atest5.four'")

-----------
QUERY:
 -- ok

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:

GRANT SELECT (four) ON atest5 TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:


INSERT INTO atest5(four) VALUES (4) ON CONFLICT (four) DO UPDATE set three = 3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONFLICT (four) DO UPDATE set three = 3' at line 1")

-----------
QUERY:
 -- ok
INSERT INTO atest5(four) VALUES (4) ON CONFLICT ON CONSTRAINT atest5_four_key DO UPDATE set three = 3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONFLICT ON CONSTRAINT atest5_four_key DO UPDATE set three = 3' at line 2")

-----------
QUERY:
 -- ok

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:

REVOKE ALL (one) ON atest5 FROM regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one) ON atest5 FROM regress_priv_user4' at line 1")

-----------
QUERY:

GRANT SELECT (one,two,blue) ON atest6 TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:

SELECT one FROM atest5;
RESULT:
	((2,), (None,))

-----------
QUERY:
 -- fail
UPDATE atest5 SET one = 1;
RESULT:
	[]

-----------
QUERY:
 -- fail
SELECT atest6 FROM atest6;
RESULT:
	ERROR - (1054, "Unknown column 'atest6' in 'field list'")

-----------
QUERY:
 -- ok
COPY atest6 TO stdout;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COPY atest6 TO stdout' at line 2")

-----------
QUERY:
 -- ok

-- test column privileges with MERGE
SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 4")

-----------
QUERY:

CREATE TABLE mtarget (a int, b text);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE msource (a int, b text);
RESULT:
	[]

-----------
QUERY:

INSERT INTO mtarget VALUES (1, 'init1'), (2, 'init2');
RESULT:
	[]

-----------
QUERY:

INSERT INTO msource VALUES (1, 'source1'), (2, 'source2'), (3, 'source3');
RESULT:
	[]

-----------
QUERY:


GRANT SELECT (a) ON msource TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

GRANT SELECT (a) ON mtarget TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

GRANT INSERT (a,b) ON mtarget TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

GRANT UPDATE (b) ON mtarget TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:


--
-- test source privileges
--

-- fail (no SELECT priv on s.b)
MERGE INTO mtarget t USING msource s ON t.a = s.a
WHEN MATCHED THEN
	UPDATE SET b = s.b
WHEN NOT MATCHED THEN
	INSERT VALUES (a, NULL);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MERGE INTO mtarget t USING msource s ON t.a = s.a\nWHEN MATCHED THEN\n\tUPDATE SET ' at line 6")

-----------
QUERY:


-- fail (s.b used in the INSERTed values)
MERGE INTO mtarget t USING msource s ON t.a = s.a
WHEN MATCHED THEN
	UPDATE SET b = 'x'
WHEN NOT MATCHED THEN
	INSERT VALUES (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MERGE INTO mtarget t USING msource s ON t.a = s.a\nWHEN MATCHED THEN\n\tUPDATE SET ' at line 2")

-----------
QUERY:


-- fail (s.b used in the WHEN quals)
MERGE INTO mtarget t USING msource s ON t.a = s.a
WHEN MATCHED AND s.b = 'x' THEN
	UPDATE SET b = 'x'
WHEN NOT MATCHED THEN
	INSERT VALUES (a, NULL);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MERGE INTO mtarget t USING msource s ON t.a = s.a\nWHEN MATCHED AND s.b = 'x' THE' at line 2")

-----------
QUERY:


-- this should be ok since only s.a is accessed
BEGIN;
RESULT:
	[]

-----------
QUERY:

MERGE INTO mtarget t USING msource s ON t.a = s.a
WHEN MATCHED THEN
	UPDATE SET b = 'ok'
WHEN NOT MATCHED THEN
	INSERT VALUES (a, NULL);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MERGE INTO mtarget t USING msource s ON t.a = s.a\nWHEN MATCHED THEN\n\tUPDATE SET ' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 1")

-----------
QUERY:

GRANT SELECT (b) ON msource TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:


-- should now be ok
BEGIN;
RESULT:
	[]

-----------
QUERY:

MERGE INTO mtarget t USING msource s ON t.a = s.a
WHEN MATCHED THEN
	UPDATE SET b = s.b
WHEN NOT MATCHED THEN
	INSERT VALUES (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MERGE INTO mtarget t USING msource s ON t.a = s.a\nWHEN MATCHED THEN\n\tUPDATE SET ' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:


--
-- test target privileges
--

-- fail (no SELECT priv on t.b)
MERGE INTO mtarget t USING msource s ON t.a = s.a
WHEN MATCHED THEN
	UPDATE SET b = t.b
WHEN NOT MATCHED THEN
	INSERT VALUES (a, NULL);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MERGE INTO mtarget t USING msource s ON t.a = s.a\nWHEN MATCHED THEN\n\tUPDATE SET ' at line 6")

-----------
QUERY:


-- fail (no UPDATE on t.a)
MERGE INTO mtarget t USING msource s ON t.a = s.a
WHEN MATCHED THEN
	UPDATE SET b = s.b, a = t.a + 1
WHEN NOT MATCHED THEN
	INSERT VALUES (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MERGE INTO mtarget t USING msource s ON t.a = s.a\nWHEN MATCHED THEN\n\tUPDATE SET ' at line 2")

-----------
QUERY:


-- fail (no SELECT on t.b)
MERGE INTO mtarget t USING msource s ON t.a = s.a
WHEN MATCHED AND t.b IS NOT NULL THEN
	UPDATE SET b = s.b
WHEN NOT MATCHED THEN
	INSERT VALUES (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MERGE INTO mtarget t USING msource s ON t.a = s.a\nWHEN MATCHED AND t.b IS NOT NU' at line 2")

-----------
QUERY:


-- ok
BEGIN;
RESULT:
	[]

-----------
QUERY:

MERGE INTO mtarget t USING msource s ON t.a = s.a
WHEN MATCHED THEN
	UPDATE SET b = s.b;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MERGE INTO mtarget t USING msource s ON t.a = s.a\nWHEN MATCHED THEN\n\tUPDATE SET ' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:


-- fail (no DELETE)
MERGE INTO mtarget t USING msource s ON t.a = s.a
WHEN MATCHED AND t.b IS NOT NULL THEN
	DELETE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MERGE INTO mtarget t USING msource s ON t.a = s.a\nWHEN MATCHED AND t.b IS NOT NU' at line 2")

-----------
QUERY:


-- grant delete privileges
SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 2")

-----------
QUERY:

GRANT DELETE ON mtarget TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

-- should be ok now
BEGIN;
RESULT:
	[]

-----------
QUERY:

MERGE INTO mtarget t USING msource s ON t.a = s.a
WHEN MATCHED AND t.b IS NOT NULL THEN
	DELETE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MERGE INTO mtarget t USING msource s ON t.a = s.a\nWHEN MATCHED AND t.b IS NOT NU' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:


-- check error reporting with column privs
SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 2")

-----------
QUERY:

CREATE TABLE t1 (c1 int, c2 int, c3 int check (c3 < 5), primary key (c1, c2));
RESULT:
	[]

-----------
QUERY:

GRANT SELECT (c1) ON t1 TO regress_priv_user2;
RESULT:
	[]

-----------
QUERY:

GRANT INSERT (c1, c2, c3) ON t1 TO regress_priv_user2;
RESULT:
	[]

-----------
QUERY:

GRANT UPDATE (c1, c2, c3) ON t1 TO regress_priv_user2;
RESULT:
	[]

-----------
QUERY:


-- seed data
INSERT INTO t1 VALUES (1, 1, 1);
RESULT:
	[]

-----------
QUERY:

INSERT INTO t1 VALUES (1, 2, 1);
RESULT:
	[]

-----------
QUERY:

INSERT INTO t1 VALUES (2, 1, 2);
RESULT:
	[]

-----------
QUERY:

INSERT INTO t1 VALUES (2, 2, 2);
RESULT:
	[]

-----------
QUERY:

INSERT INTO t1 VALUES (3, 1, 3);
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:

INSERT INTO t1 (c1, c2) VALUES (1, 1);
RESULT:
	ERROR - (1062, "Duplicate entry '1-1' for key 't1.PRIMARY'")

-----------
QUERY:
 -- fail, but row not shown
UPDATE t1 SET c2 = 1;
RESULT:
	ERROR - (1062, "Duplicate entry '1-1' for key 't1.PRIMARY'")

-----------
QUERY:
 -- fail, but row not shown
INSERT INTO t1 (c1, c2) VALUES (null, null);
RESULT:
	ERROR - (1048, "Column 'c1' cannot be null")

-----------
QUERY:
 -- fail, but see columns being inserted
INSERT INTO t1 (c3) VALUES (null);
RESULT:
	ERROR - (1364, "Field 'c1' doesn't have a default value")

-----------
QUERY:
 -- fail, but see columns being inserted or have SELECT
INSERT INTO t1 (c1) VALUES (5);
RESULT:
	ERROR - (1364, "Field 'c2' doesn't have a default value")

-----------
QUERY:
 -- fail, but see columns being inserted or have SELECT
UPDATE t1 SET c3 = 10;
RESULT:
	ERROR - (3819, "Check constraint 't1_chk_1' is violated.")

-----------
QUERY:
 -- fail, but see columns with SELECT rights, or being modified

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:

DROP TABLE t1;
RESULT:
	[]

-----------
QUERY:


-- check error reporting with column privs on a partitioned table
CREATE TABLE errtst(a text, b text NOT NULL, c text, secret1 text, secret2 text) PARTITION BY LIST (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE errtst_part_1(secret2 text, c text, a text, b text NOT NULL, secret1 text);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE errtst_part_2(secret1 text, secret2 text, a text, c text, b text NOT NULL);
RESULT:
	[]

-----------
QUERY:


ALTER TABLE errtst ATTACH PARTITION errtst_part_1 FOR VALUES IN ('aaa');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ATTACH PARTITION errtst_part_1 FOR VALUES IN ('aaa')' at line 1")

-----------
QUERY:

ALTER TABLE errtst ATTACH PARTITION errtst_part_2 FOR VALUES IN ('aaaa');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ATTACH PARTITION errtst_part_2 FOR VALUES IN ('aaaa')' at line 1")

-----------
QUERY:


GRANT SELECT (a, b, c) ON TABLE errtst TO regress_priv_user2;
RESULT:
	ERROR - (1146, "Table 'test.errtst' doesn't exist")

-----------
QUERY:

GRANT UPDATE (a, b, c) ON TABLE errtst TO regress_priv_user2;
RESULT:
	ERROR - (1146, "Table 'test.errtst' doesn't exist")

-----------
QUERY:

GRANT INSERT (a, b, c) ON TABLE errtst TO regress_priv_user2;
RESULT:
	ERROR - (1146, "Table 'test.errtst' doesn't exist")

-----------
QUERY:


INSERT INTO errtst_part_1 (a, b, c, secret1, secret2)
VALUES ('aaa', 'bbb', 'ccc', 'the body', 'is in the attic');
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:


-- Perform a few updates that violate the NOT NULL constraint. Make sure
-- the error messages don/* REPLACED */ ''t leak the secret fields.

-- simple insert.
INSERT INTO errtst (a, b) VALUES ('aaa', NULL);
RESULT:
	ERROR - (1146, "Table 'test.errtst' doesn't exist")

-----------
QUERY:

-- simple update.
UPDATE errtst SET b = NULL;
RESULT:
	ERROR - (1146, "Table 'test.errtst' doesn't exist")

-----------
QUERY:

-- partitioning key is updated, doesn/* REPLACED */ ''t move the row.
UPDATE errtst SET a = 'aaa', b = NULL;
RESULT:
	ERROR - (1146, "Table 'test.errtst' doesn't exist")

-----------
QUERY:

-- row is moved to another partition.
UPDATE errtst SET a = 'aaaa', b = NULL;
RESULT:
	ERROR - (1146, "Table 'test.errtst' doesn't exist")

-----------
QUERY:


-- row is moved to another partition. This differs from the previous case in
-- that the new partition is excluded by constraint exclusion, so its
-- ResultRelInfo is not created at ExecInitModifyTable, but needs to be
-- constructed on the fly when the updated tuple is routed to it.
UPDATE errtst SET a = 'aaaa', b = NULL WHERE a = 'aaa';
RESULT:
	ERROR - (1146, "Table 'test.errtst' doesn't exist")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 1")

-----------
QUERY:

DROP TABLE errtst;
RESULT:
	ERROR - (1051, "Unknown table 'test.errtst'")

-----------
QUERY:


-- test column-level privileges when involved with DELETE
SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 2")

-----------
QUERY:

ALTER TABLE atest6 ADD COLUMN three integer;
RESULT:
	[]

-----------
QUERY:

GRANT DELETE ON atest5 TO regress_priv_user3;
RESULT:
	[]

-----------
QUERY:

GRANT SELECT (two) ON atest5 TO regress_priv_user3;
RESULT:
	[]

-----------
QUERY:

REVOKE ALL (one) ON atest5 FROM regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(one) ON atest5 FROM regress_priv_user3' at line 1")

-----------
QUERY:

GRANT SELECT (one) ON atest5 TO regress_priv_user4;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:

SELECT atest6 FROM atest6;
RESULT:
	ERROR - (1054, "Unknown column 'atest6' in 'field list'")

-----------
QUERY:
 -- fail
SELECT one FROM atest5 NATURAL JOIN atest6;
RESULT:
	()

-----------
QUERY:
 -- fail

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:

ALTER TABLE atest6 DROP COLUMN three;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:

SELECT atest6 FROM atest6;
RESULT:
	ERROR - (1054, "Unknown column 'atest6' in 'field list'")

-----------
QUERY:
 -- ok
SELECT one FROM atest5 NATURAL JOIN atest6;
RESULT:
	()

-----------
QUERY:
 -- ok

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:

ALTER TABLE atest6 DROP COLUMN two;
RESULT:
	[]

-----------
QUERY:

REVOKE SELECT (one,blue) ON atest6 FROM regress_priv_user4;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:

SELECT * FROM atest6;
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT 1 FROM atest6;
RESULT:
	()

-----------
QUERY:
 -- fail

SET SESSION AUTHORIZATION regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user3' at line 3")

-----------
QUERY:

DELETE FROM atest5 WHERE one = 1;
RESULT:
	[]

-----------
QUERY:
 -- fail
DELETE FROM atest5 WHERE two = 2;
RESULT:
	[]

-----------
QUERY:
 -- ok

-- check inheritance cases
SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 4")

-----------
QUERY:

CREATE TABLE atestp1 (f1 int, f2 int);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE atestp2 (fx int, fy int);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE atestc (fz int) INHERITS (atestp1, atestp2);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INHERITS (atestp1, atestp2)' at line 1")

-----------
QUERY:

GRANT SELECT(fx,fy,tableoid) ON atestp2 TO regress_priv_user2;
RESULT:
	ERROR - (1054, "Unknown column 'tableoid' in 'atestp2'")

-----------
QUERY:

GRANT SELECT(fx) ON atestc TO regress_priv_user2;
RESULT:
	ERROR - (1146, "Table 'test.atestc' doesn't exist")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:

SELECT fx FROM atestp2;
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT fy FROM atestp2;
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT atestp2 FROM atestp2;
RESULT:
	ERROR - (1054, "Unknown column 'atestp2' in 'field list'")

-----------
QUERY:
 -- ok
SELECT tableoid FROM atestp2;
RESULT:
	ERROR - (1054, "Unknown column 'tableoid' in 'field list'")

-----------
QUERY:
 -- ok
SELECT fy FROM atestc;
RESULT:
	ERROR - (1146, "Table 'test.atestc' doesn't exist")

-----------
QUERY:
 -- fail

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:

GRANT SELECT(fy,tableoid) ON atestc TO regress_priv_user2;
RESULT:
	ERROR - (1146, "Table 'test.atestc' doesn't exist")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:

SELECT fx FROM atestp2;
RESULT:
	()

-----------
QUERY:
 -- still ok
SELECT fy FROM atestp2;
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT atestp2 FROM atestp2;
RESULT:
	ERROR - (1054, "Unknown column 'atestp2' in 'field list'")

-----------
QUERY:
 -- ok
SELECT tableoid FROM atestp2;
RESULT:
	ERROR - (1054, "Unknown column 'tableoid' in 'field list'")

-----------
QUERY:
 -- ok

-- child/* REPLACED */ ''s permissions do not apply when operating on parent
SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 4")

-----------
QUERY:

REVOKE ALL ON atestc FROM regress_priv_user2;
RESULT:
	ERROR - (1147, "There is no such grant defined for user 'regress_priv_user2' on host '%' on table 'atestc'")

-----------
QUERY:

GRANT ALL ON atestp1 TO regress_priv_user2;
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:

SELECT f2 FROM atestp1;
RESULT:
	()

-----------
QUERY:
 -- ok
SELECT f2 FROM atestc;
RESULT:
	ERROR - (1146, "Table 'test.atestc' doesn't exist")

-----------
QUERY:
 -- fail
DELETE FROM atestp1;
RESULT:
	[]

-----------
QUERY:
 -- ok
DELETE FROM atestc;
RESULT:
	ERROR - (1146, "Table 'test.atestc' doesn't exist")

-----------
QUERY:
 -- fail
UPDATE atestp1 SET f1 = 1;
RESULT:
	[]

-----------
QUERY:
 -- ok
UPDATE atestc SET f1 = 1;
RESULT:
	ERROR - (1146, "Table 'test.atestc' doesn't exist")

-----------
QUERY:
 -- fail
TRUNCATE atestp1;
RESULT:
	[]

-----------
QUERY:
 -- ok
TRUNCATE atestc;
RESULT:
	ERROR - (1146, "Table 'test.atestc' doesn't exist")

-----------
QUERY:
 -- fail
BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK atestp1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'atestp1' at line 1")

-----------
QUERY:

END;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'END' at line 1")

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK atestc;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'atestc' at line 1")

-----------
QUERY:

END;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'END' at line 1")

-----------
QUERY:


-- privileges on functions, languages

-- switch to superuser
-- \c -

REVOKE ALL PRIVILEGES ON LANGUAGE sql FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'sql FROM PUBLIC' at line 6")

-----------
QUERY:

GRANT USAGE ON LANGUAGE sql TO regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'sql TO regress_priv_user1' at line 1")

-----------
QUERY:
 -- ok
GRANT USAGE ON LANGUAGE c TO PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'c TO PUBLIC' at line 2")

-----------
QUERY:
 -- fail

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:

GRANT USAGE ON LANGUAGE sql TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'sql TO regress_priv_user2' at line 1")

-----------
QUERY:
 -- fail
CREATE FUNCTION priv_testfunc1(int) RETURNS int AS 'select 2 * $1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int) RETURNS int AS 'select 2 * $1' at line 2")

-----------
QUERY:
' LANGUAGE sql;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' LANGUAGE sql' at line 1")

-----------
QUERY:

CREATE FUNCTION priv_testfunc2(int) RETURNS int AS 'select 3 * $1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int) RETURNS int AS 'select 3 * $1' at line 1")

-----------
QUERY:
' LANGUAGE sql;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' LANGUAGE sql' at line 1")

-----------
QUERY:

CREATE AGGREGATE priv_testagg1(int) (sfunc = int4pl, stype = int4);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testagg1(int) (sfunc = int4pl, stype = int4)' at line 1")

-----------
QUERY:

CREATE PROCEDURE priv_testproc1(int) AS 'select $1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int) AS 'select $1' at line 1")

-----------
QUERY:
' LANGUAGE sql;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' LANGUAGE sql' at line 1")

-----------
QUERY:


REVOKE ALL ON FUNCTION priv_testfunc1(int), priv_testfunc2(int), priv_testagg1(int) FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int), priv_testfunc2(int), priv_testagg1(int) FROM PUBLIC' at line 1")

-----------
QUERY:

GRANT EXECUTE ON FUNCTION priv_testfunc1(int), priv_testfunc2(int), priv_testagg1(int) TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int), priv_testfunc2(int), priv_testagg1(int) TO regress_priv_user2' at line 1")

-----------
QUERY:

REVOKE ALL ON FUNCTION priv_testproc1(int) FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) FROM PUBLIC' at line 1")

-----------
QUERY:
 -- fail, not a function
REVOKE ALL ON PROCEDURE priv_testproc1(int) FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) FROM PUBLIC' at line 2")

-----------
QUERY:

GRANT EXECUTE ON PROCEDURE priv_testproc1(int) TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) TO regress_priv_user2' at line 1")

-----------
QUERY:

GRANT USAGE ON FUNCTION priv_testfunc1(int) TO regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) TO regress_priv_user3' at line 1")

-----------
QUERY:
 -- semantic error
GRANT USAGE ON FUNCTION priv_testagg1(int) TO regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) TO regress_priv_user3' at line 2")

-----------
QUERY:
 -- semantic error
GRANT USAGE ON PROCEDURE priv_testproc1(int) TO regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) TO regress_priv_user3' at line 2")

-----------
QUERY:
 -- semantic error
GRANT ALL PRIVILEGES ON FUNCTION priv_testfunc1(int) TO regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) TO regress_priv_user4' at line 2")

-----------
QUERY:

GRANT ALL PRIVILEGES ON FUNCTION priv_testfunc_nosuch(int) TO regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) TO regress_priv_user4' at line 1")

-----------
QUERY:

GRANT ALL PRIVILEGES ON FUNCTION priv_testagg1(int) TO regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) TO regress_priv_user4' at line 1")

-----------
QUERY:

GRANT ALL PRIVILEGES ON PROCEDURE priv_testproc1(int) TO regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) TO regress_priv_user4' at line 1")

-----------
QUERY:


CREATE FUNCTION priv_testfunc4(boolean) RETURNS text
  AS 'select col1 from atest2 where col2 = $1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') RETURNS text\n  AS 'select col1 from atest2 where col2 = $1' at line 1")

-----------
QUERY:
'
  LANGUAGE sql SECURITY DEFINER;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''\n  LANGUAGE sql SECURITY DEFINER' at line 1")

-----------
QUERY:

GRANT EXECUTE ON FUNCTION priv_testfunc4(boolean) TO regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(boolean) TO regress_priv_user3' at line 1")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:

SELECT priv_testfunc1(5), priv_testfunc2(5);
RESULT:
	ERROR - (1305, 'FUNCTION test.priv_testfunc1 does not exist')

-----------
QUERY:
 -- ok
CREATE FUNCTION priv_testfunc3(int) RETURNS int AS 'select 2 * $1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int) RETURNS int AS 'select 2 * $1' at line 2")

-----------
QUERY:
' LANGUAGE sql;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' LANGUAGE sql' at line 1")

-----------
QUERY:
 -- fail
SELECT priv_testagg1(x) FROM (VALUES (1), (2), (3)) _(x);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(1), (2), (3)) _(x)' at line 2")

-----------
QUERY:
 -- ok
CALL priv_testproc1(6);
RESULT:
	ERROR - (1305, 'PROCEDURE test.priv_testproc1 does not exist')

-----------
QUERY:
 -- ok

SET SESSION AUTHORIZATION regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user3' at line 3")

-----------
QUERY:

SELECT priv_testfunc1(5);
RESULT:
	ERROR - (1305, 'FUNCTION test.priv_testfunc1 does not exist')

-----------
QUERY:
 -- fail
SELECT priv_testagg1(x) FROM (VALUES (1), (2), (3)) _(x);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(1), (2), (3)) _(x)' at line 2")

-----------
QUERY:
 -- fail
CALL priv_testproc1(6);
RESULT:
	ERROR - (1305, 'PROCEDURE test.priv_testproc1 does not exist')

-----------
QUERY:
 -- fail
SELECT col1 FROM atest2 WHERE col2 = true;
RESULT:
	()

-----------
QUERY:
 -- fail
SELECT priv_testfunc4(true);
RESULT:
	ERROR - (1305, 'FUNCTION test.priv_testfunc4 does not exist')

-----------
QUERY:
 -- ok

SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 3")

-----------
QUERY:

SELECT priv_testfunc1(5);
RESULT:
	ERROR - (1305, 'FUNCTION test.priv_testfunc1 does not exist')

-----------
QUERY:
 -- ok
SELECT priv_testagg1(x) FROM (VALUES (1), (2), (3)) _(x);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(1), (2), (3)) _(x)' at line 2")

-----------
QUERY:
 -- ok
CALL priv_testproc1(6);
RESULT:
	ERROR - (1305, 'PROCEDURE test.priv_testproc1 does not exist')

-----------
QUERY:
 -- ok

DROP FUNCTION priv_testfunc1(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int)' at line 3")

-----------
QUERY:
 -- fail
DROP AGGREGATE priv_testagg1(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AGGREGATE priv_testagg1(int)' at line 2")

-----------
QUERY:
 -- fail
DROP PROCEDURE priv_testproc1(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int)' at line 2")

-----------
QUERY:
 -- fail

-- \c -

DROP FUNCTION priv_testfunc1(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int)' at line 5")

-----------
QUERY:
 -- ok
-- restore to sanity
GRANT ALL PRIVILEGES ON LANGUAGE sql TO PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'sql TO PUBLIC' at line 3")

-----------
QUERY:


-- verify privilege checks on array-element coercions
BEGIN;
RESULT:
	[]

-----------
QUERY:

SELECT '{1}'::int4[]::int8[];
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::int4[]::int8[]' at line 1")

-----------
QUERY:

REVOKE ALL ON FUNCTION int8(integer) FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int8(integer) FROM PUBLIC' at line 1")

-----------
QUERY:

SELECT '{1}'::int4[]::int8[];
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::int4[]::int8[]' at line 1")

-----------
QUERY:
 --superuser, succeed
SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--superuser, succeed\nSET SESSION AUTHORIZATION regress_priv_user4' at line 1")

-----------
QUERY:

SELECT '{1}'::int4[]::int8[];
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::int4[]::int8[]' at line 1")

-----------
QUERY:
 --other user, fail
ROLLBACK;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--other user, fail\nROLLBACK' at line 1")

-----------
QUERY:


-- privileges on types

-- switch to superuser
-- \c -

CREATE TYPE priv_testtype1 AS (a int, b text);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE priv_testtype1 AS (a int, b text)' at line 6")

-----------
QUERY:

REVOKE USAGE ON TYPE priv_testtype1 FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testtype1 FROM PUBLIC' at line 1")

-----------
QUERY:

GRANT USAGE ON TYPE priv_testtype1 TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testtype1 TO regress_priv_user2' at line 1")

-----------
QUERY:

GRANT USAGE ON TYPE _priv_testtype1 TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '_priv_testtype1 TO regress_priv_user2' at line 1")

-----------
QUERY:
 -- fail
GRANT USAGE ON DOMAIN priv_testtype1 TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testtype1 TO regress_priv_user2' at line 2")

-----------
QUERY:
 -- fail

CREATE DOMAIN priv_testdomain1 AS int;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN priv_testdomain1 AS int' at line 3")

-----------
QUERY:

REVOKE USAGE on DOMAIN priv_testdomain1 FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testdomain1 FROM PUBLIC' at line 1")

-----------
QUERY:

GRANT USAGE ON DOMAIN priv_testdomain1 TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testdomain1 TO regress_priv_user2' at line 1")

-----------
QUERY:

GRANT USAGE ON TYPE priv_testdomain1 TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testdomain1 TO regress_priv_user2' at line 1")

-----------
QUERY:
 -- ok

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:


-- commands that should fail

CREATE AGGREGATE priv_testagg1a(priv_testdomain1) (sfunc = int4_sum, stype = bigint);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testagg1a(priv_testdomain1) (sfunc = int4_sum, stype = bigint)' at line 3")

-----------
QUERY:


CREATE DOMAIN priv_testdomain2a AS priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN priv_testdomain2a AS priv_testdomain1' at line 1")

-----------
QUERY:


CREATE DOMAIN priv_testdomain3a AS int;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN priv_testdomain3a AS int' at line 1")

-----------
QUERY:

CREATE FUNCTION castfunc(int) RETURNS priv_testdomain3a AS $$ SELECT $1::priv_testdomain3a $$ LANGUAGE SQL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int) RETURNS priv_testdomain3a AS $$ SELECT $1::priv_testdomain3a $$ LANGUAGE SQ' at line 1")

-----------
QUERY:

CREATE CAST (priv_testdomain1 AS priv_testdomain3a) WITH FUNCTION castfunc(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CAST (priv_testdomain1 AS priv_testdomain3a) WITH FUNCTION castfunc(int)' at line 1")

-----------
QUERY:

DROP FUNCTION castfunc(int) CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) CASCADE' at line 1")

-----------
QUERY:

DROP DOMAIN priv_testdomain3a;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN priv_testdomain3a' at line 1")

-----------
QUERY:


CREATE FUNCTION priv_testfunc5a(a priv_testdomain1) RETURNS int LANGUAGE SQL AS $$ SELECT $1 $$;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testdomain1) RETURNS int LANGUAGE SQL AS $$ SELECT $1 $$' at line 1")

-----------
QUERY:

CREATE FUNCTION priv_testfunc6a(b int) RETURNS priv_testdomain1 LANGUAGE SQL AS $$ SELECT $1::priv_testdomain1 $$;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testdomain1 LANGUAGE SQL AS $$ SELECT $1::priv_testdomain1 $$' at line 1")

-----------
QUERY:


CREATE OPERATOR !+! (PROCEDURE = int4pl, LEFTARG = priv_testdomain1, RIGHTARG = priv_testdomain1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPERATOR !+! (PROCEDURE = int4pl, LEFTARG = priv_testdomain1, RIGHTARG = priv_te' at line 1")

-----------
QUERY:


CREATE TABLE test5a (a int, b priv_testdomain1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testdomain1)' at line 1")

-----------
QUERY:

CREATE TABLE test6a OF priv_testtype1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF priv_testtype1' at line 1")

-----------
QUERY:

CREATE TABLE test10a (a int[], b priv_testtype1[]);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '[], b priv_testtype1[])' at line 1")

-----------
QUERY:


CREATE TABLE test9a (a int, b int);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE test9a ADD COLUMN c priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testdomain1' at line 1")

-----------
QUERY:

ALTER TABLE test9a ALTER COLUMN b TYPE priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE priv_testdomain1' at line 1")

-----------
QUERY:


CREATE TYPE test7a AS (a int, b priv_testdomain1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE test7a AS (a int, b priv_testdomain1)' at line 1")

-----------
QUERY:


CREATE TYPE test8a AS (a int, b int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE test8a AS (a int, b int)' at line 1")

-----------
QUERY:

ALTER TYPE test8a ADD ATTRIBUTE c priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE test8a ADD ATTRIBUTE c priv_testdomain1' at line 1")

-----------
QUERY:

ALTER TYPE test8a ALTER ATTRIBUTE b TYPE priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE test8a ALTER ATTRIBUTE b TYPE priv_testdomain1' at line 1")

-----------
QUERY:


CREATE TABLE test11a AS (SELECT 1::priv_testdomain1 AS a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::priv_testdomain1 AS a)' at line 1")

-----------
QUERY:


REVOKE ALL ON TYPE priv_testtype1 FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testtype1 FROM PUBLIC' at line 1")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:


-- commands that should succeed

CREATE AGGREGATE priv_testagg1b(priv_testdomain1) (sfunc = int4_sum, stype = bigint);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testagg1b(priv_testdomain1) (sfunc = int4_sum, stype = bigint)' at line 3")

-----------
QUERY:


CREATE DOMAIN priv_testdomain2b AS priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN priv_testdomain2b AS priv_testdomain1' at line 1")

-----------
QUERY:


CREATE DOMAIN priv_testdomain3b AS int;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN priv_testdomain3b AS int' at line 1")

-----------
QUERY:

CREATE FUNCTION castfunc(int) RETURNS priv_testdomain3b AS $$ SELECT $1::priv_testdomain3b $$ LANGUAGE SQL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int) RETURNS priv_testdomain3b AS $$ SELECT $1::priv_testdomain3b $$ LANGUAGE SQ' at line 1")

-----------
QUERY:

CREATE CAST (priv_testdomain1 AS priv_testdomain3b) WITH FUNCTION castfunc(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CAST (priv_testdomain1 AS priv_testdomain3b) WITH FUNCTION castfunc(int)' at line 1")

-----------
QUERY:


CREATE FUNCTION priv_testfunc5b(a priv_testdomain1) RETURNS int LANGUAGE SQL AS $$ SELECT $1 $$;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testdomain1) RETURNS int LANGUAGE SQL AS $$ SELECT $1 $$' at line 1")

-----------
QUERY:

CREATE FUNCTION priv_testfunc6b(b int) RETURNS priv_testdomain1 LANGUAGE SQL AS $$ SELECT $1::priv_testdomain1 $$;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testdomain1 LANGUAGE SQL AS $$ SELECT $1::priv_testdomain1 $$' at line 1")

-----------
QUERY:


CREATE OPERATOR !! (PROCEDURE = priv_testfunc5b, RIGHTARG = priv_testdomain1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPERATOR !! (PROCEDURE = priv_testfunc5b, RIGHTARG = priv_testdomain1)' at line 1")

-----------
QUERY:


CREATE TABLE test5b (a int, b priv_testdomain1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testdomain1)' at line 1")

-----------
QUERY:

CREATE TABLE test6b OF priv_testtype1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF priv_testtype1' at line 1")

-----------
QUERY:

CREATE TABLE test10b (a int[], b priv_testtype1[]);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '[], b priv_testtype1[])' at line 1")

-----------
QUERY:


CREATE TABLE test9b (a int, b int);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE test9b ADD COLUMN c priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testdomain1' at line 1")

-----------
QUERY:

ALTER TABLE test9b ALTER COLUMN b TYPE priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE priv_testdomain1' at line 1")

-----------
QUERY:


CREATE TYPE test7b AS (a int, b priv_testdomain1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE test7b AS (a int, b priv_testdomain1)' at line 1")

-----------
QUERY:


CREATE TYPE test8b AS (a int, b int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE test8b AS (a int, b int)' at line 1")

-----------
QUERY:

ALTER TYPE test8b ADD ATTRIBUTE c priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE test8b ADD ATTRIBUTE c priv_testdomain1' at line 1")

-----------
QUERY:

ALTER TYPE test8b ALTER ATTRIBUTE b TYPE priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE test8b ALTER ATTRIBUTE b TYPE priv_testdomain1' at line 1")

-----------
QUERY:


CREATE TABLE test11b AS (SELECT 1::priv_testdomain1 AS a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::priv_testdomain1 AS a)' at line 1")

-----------
QUERY:


REVOKE ALL ON TYPE priv_testtype1 FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'priv_testtype1 FROM PUBLIC' at line 1")

-----------
QUERY:


-- \c -
DROP AGGREGATE priv_testagg1b(priv_testdomain1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AGGREGATE priv_testagg1b(priv_testdomain1)' at line 2")

-----------
QUERY:

DROP DOMAIN priv_testdomain2b;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN priv_testdomain2b' at line 1")

-----------
QUERY:

DROP OPERATOR !! (NONE, priv_testdomain1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPERATOR !! (NONE, priv_testdomain1)' at line 1")

-----------
QUERY:

DROP FUNCTION priv_testfunc5b(a priv_testdomain1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(a priv_testdomain1)' at line 1")

-----------
QUERY:

DROP FUNCTION priv_testfunc6b(b int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(b int)' at line 1")

-----------
QUERY:

DROP TABLE test5b;
RESULT:
	ERROR - (1051, "Unknown table 'test.test5b'")

-----------
QUERY:

DROP TABLE test6b;
RESULT:
	ERROR - (1051, "Unknown table 'test.test6b'")

-----------
QUERY:

DROP TABLE test9b;
RESULT:
	[]

-----------
QUERY:

DROP TABLE test10b;
RESULT:
	ERROR - (1051, "Unknown table 'test.test10b'")

-----------
QUERY:

DROP TYPE test7b;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE test7b' at line 1")

-----------
QUERY:

DROP TYPE test8b;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE test8b' at line 1")

-----------
QUERY:

DROP CAST (priv_testdomain1 AS priv_testdomain3b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CAST (priv_testdomain1 AS priv_testdomain3b)' at line 1")

-----------
QUERY:

DROP FUNCTION castfunc(int) CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int) CASCADE' at line 1")

-----------
QUERY:

DROP DOMAIN priv_testdomain3b;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN priv_testdomain3b' at line 1")

-----------
QUERY:

DROP TABLE test11b;
RESULT:
	ERROR - (1051, "Unknown table 'test.test11b'")

-----------
QUERY:


DROP TYPE priv_testtype1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE priv_testtype1' at line 1")

-----------
QUERY:
 -- ok
DROP DOMAIN priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN priv_testdomain1' at line 2")

-----------
QUERY:
 -- ok


-- truncate
SET SESSION AUTHORIZATION regress_priv_user5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user5' at line 5")

-----------
QUERY:

TRUNCATE atest2;
RESULT:
	[]

-----------
QUERY:
 -- ok
TRUNCATE atest3;
RESULT:
	[]

-----------
QUERY:
 -- fail

-- has_table_privilege function

-- bad-input checks
select has_table_privilege(NULL,'pg_authid','select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege('pg_shad','select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege('nosuchuser','pg_authid','select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege('pg_authid','sel');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege(-999999,'pg_authid','update');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege(1,'select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:


-- superuser
-- \c -

select has_table_privilege(current_user,'pg_authid','select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege(current_user,'pg_authid','insert');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:


select has_table_privilege(t2.oid,'pg_authid','update')
from (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_roles' doesn't exist")

-----------
QUERY:

select has_table_privilege(t2.oid,'pg_authid','delete')
from (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_roles' doesn't exist")

-----------
QUERY:


-- /* REPLACED */ ''rule/* REPLACED */ '' privilege no longer exists, but for backwards compatibility
-- has_table_privilege still recognizes the keyword and says FALSE
select has_table_privilege(current_user,t1.oid,'rule')
from (select oid from pg_class where relname = 'pg_authid') as t1;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:

select has_table_privilege(current_user,t1.oid,'references')
from (select oid from pg_class where relname = 'pg_authid') as t1;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:


select has_table_privilege(t2.oid,t1.oid,'select')
from (select oid from pg_class where relname = 'pg_authid') as t1,
  (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:

select has_table_privilege(t2.oid,t1.oid,'insert')
from (select oid from pg_class where relname = 'pg_authid') as t1,
  (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:


select has_table_privilege('pg_authid','update');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege('pg_authid','delete');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege('pg_authid','truncate');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:


select has_table_privilege(t1.oid,'select')
from (select oid from pg_class where relname = 'pg_authid') as t1;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:

select has_table_privilege(t1.oid,'trigger')
from (select oid from pg_class where relname = 'pg_authid') as t1;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:


-- non-superuser
SET SESSION AUTHORIZATION regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user3' at line 2")

-----------
QUERY:


select has_table_privilege(current_user,'pg_class','select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege(current_user,'pg_class','insert');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:


select has_table_privilege(t2.oid,'pg_class','update')
from (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_roles' doesn't exist")

-----------
QUERY:

select has_table_privilege(t2.oid,'pg_class','delete')
from (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_roles' doesn't exist")

-----------
QUERY:


select has_table_privilege(current_user,t1.oid,'references')
from (select oid from pg_class where relname = 'pg_class') as t1;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:


select has_table_privilege(t2.oid,t1.oid,'select')
from (select oid from pg_class where relname = 'pg_class') as t1,
  (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:

select has_table_privilege(t2.oid,t1.oid,'insert')
from (select oid from pg_class where relname = 'pg_class') as t1,
  (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:


select has_table_privilege('pg_class','update');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege('pg_class','delete');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege('pg_class','truncate');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:


select has_table_privilege(t1.oid,'select')
from (select oid from pg_class where relname = 'pg_class') as t1;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:

select has_table_privilege(t1.oid,'trigger')
from (select oid from pg_class where relname = 'pg_class') as t1;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:


select has_table_privilege(current_user,'atest1','select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege(current_user,'atest1','insert');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:


select has_table_privilege(t2.oid,'atest1','update')
from (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_roles' doesn't exist")

-----------
QUERY:

select has_table_privilege(t2.oid,'atest1','delete')
from (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_roles' doesn't exist")

-----------
QUERY:


select has_table_privilege(current_user,t1.oid,'references')
from (select oid from pg_class where relname = 'atest1') as t1;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:


select has_table_privilege(t2.oid,t1.oid,'select')
from (select oid from pg_class where relname = 'atest1') as t1,
  (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:

select has_table_privilege(t2.oid,t1.oid,'insert')
from (select oid from pg_class where relname = 'atest1') as t1,
  (select oid from pg_roles where rolname = current_user) as t2;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:


select has_table_privilege('atest1','update');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege('atest1','delete');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:

select has_table_privilege('atest1','truncate');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:


select has_table_privilege(t1.oid,'select')
from (select oid from pg_class where relname = 'atest1') as t1;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:

select has_table_privilege(t1.oid,'trigger')
from (select oid from pg_class where relname = 'atest1') as t1;
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:


-- has_column_privilege function

-- bad-input checks (as non-super-user)
select has_column_privilege('pg_authid',NULL,'select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_column_privilege does not exist')

-----------
QUERY:

select has_column_privilege('pg_authid','nosuchcol','select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_column_privilege does not exist')

-----------
QUERY:

select has_column_privilege(9999,'nosuchcol','select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_column_privilege does not exist')

-----------
QUERY:

select has_column_privilege(9999,99::int2,'select');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::int2,'select')' at line 1")

-----------
QUERY:

select has_column_privilege('pg_authid',99::int2,'select');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::int2,'select')' at line 1")

-----------
QUERY:

select has_column_privilege(9999,99::int2,'select');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::int2,'select')' at line 1")

-----------
QUERY:


create temp table mytable(f1 int, f2 int, f3 int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'temp table mytable(f1 int, f2 int, f3 int)' at line 1")

-----------
QUERY:

alter table mytable drop column f2;
RESULT:
	ERROR - (1146, "Table 'test.mytable' doesn't exist")

-----------
QUERY:

select has_column_privilege('mytable','f2','select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_column_privilege does not exist')

-----------
QUERY:

select has_column_privilege('mytable','........pg.dropped.2........','select');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_column_privilege does not exist')

-----------
QUERY:

select has_column_privilege('mytable',2::int2,'select');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::int2,'select')' at line 1")

-----------
QUERY:

select has_column_privilege('mytable',99::int2,'select');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::int2,'select')' at line 1")

-----------
QUERY:

revoke select on table mytable from regress_priv_user3;
RESULT:
	ERROR - (1147, "There is no such grant defined for user 'regress_priv_user3' on host '%' on table 'mytable'")

-----------
QUERY:

select has_column_privilege('mytable',2::int2,'select');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::int2,'select')' at line 1")

-----------
QUERY:

select has_column_privilege('mytable',99::int2,'select');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::int2,'select')' at line 1")

-----------
QUERY:

drop table mytable;
RESULT:
	ERROR - (1051, "Unknown table 'test.mytable'")

-----------
QUERY:


-- Grant options

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:


CREATE TABLE atest4 (a int);
RESULT:
	[]

-----------
QUERY:


GRANT SELECT ON atest4 TO regress_priv_user2 WITH GRANT OPTION;
RESULT:
	[]

-----------
QUERY:

GRANT UPDATE ON atest4 TO regress_priv_user2;
RESULT:
	[]

-----------
QUERY:

GRANT SELECT ON atest4 TO GROUP regress_priv_group1 WITH GRANT OPTION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP regress_priv_group1 WITH GRANT OPTION' at line 1")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:


GRANT SELECT ON atest4 TO regress_priv_user3;
RESULT:
	[]

-----------
QUERY:

GRANT UPDATE ON atest4 TO regress_priv_user3;
RESULT:
	[]

-----------
QUERY:
 -- fail

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:


REVOKE SELECT ON atest4 FROM regress_priv_user3;
RESULT:
	[]

-----------
QUERY:
 -- does nothing
SELECT has_table_privilege('regress_priv_user3', 'atest4', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- true
REVOKE SELECT ON atest4 FROM regress_priv_user2;
RESULT:
	[]

-----------
QUERY:
 -- fail
REVOKE GRANT OPTION FOR SELECT ON atest4 FROM regress_priv_user2 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FOR SELECT ON atest4 FROM regress_priv_user2 CASCADE' at line 2")

-----------
QUERY:
 -- ok
SELECT has_table_privilege('regress_priv_user2', 'atest4', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- true
SELECT has_table_privilege('regress_priv_user3', 'atest4', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- false

SELECT has_table_privilege('regress_priv_user1', 'atest4', 'SELECT WITH GRANT OPTION');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- true


-- security-restricted operations
-- \c -
CREATE ROLE regress_sro_user;
RESULT:
	[]

-----------
QUERY:


-- Check that index expressions and predicates are run as the table/* REPLACED */ ''s owner

-- A dummy index function checking current_user
CREATE FUNCTION sro_ifun(int) RETURNS int AS $$
BEGIN
	-- Below we set the table/* REPLACED */ ''s owner to regress_sro_user
	ASSERT current_user = 'regress_sro_user',
		format('sro_ifun(%s) called by %s', $1, current_user);
	RETURN $1;
END;
$$ LANGUAGE plpgsql IMMUTABLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int) RETURNS int AS $$\nBEGIN\n\t-- Below we set the table/* REPLACED */ ''s owner ' at line 4")

-----------
QUERY:

-- Create a table owned by regress_sro_user
CREATE TABLE sro_tab (a int);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE sro_tab OWNER TO regress_sro_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNER TO regress_sro_user' at line 1")

-----------
QUERY:

INSERT INTO sro_tab VALUES (1), (2), (3);
RESULT:
	[]

-----------
QUERY:

-- Create an expression index with a predicate
CREATE INDEX sro_idx ON sro_tab ((sro_ifun(a) + sro_ifun(0)))
	WHERE sro_ifun(a + 10) > sro_ifun(10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'WHERE sro_ifun(a + 10) > sro_ifun(10)' at line 3")

-----------
QUERY:

DROP INDEX sro_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1")

-----------
QUERY:

-- Do the same concurrently
CREATE INDEX CONCURRENTLY sro_idx ON sro_tab ((sro_ifun(a) + sro_ifun(0)))
	WHERE sro_ifun(a + 10) > sro_ifun(10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'sro_idx ON sro_tab ((sro_ifun(a) + sro_ifun(0)))\n\tWHERE sro_ifun(a + 10) > sro_i' at line 2")

-----------
QUERY:

-- REINDEX
REINDEX TABLE sro_tab;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX TABLE sro_tab' at line 2")

-----------
QUERY:

REINDEX INDEX sro_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX INDEX sro_idx' at line 1")

-----------
QUERY:

REINDEX TABLE CONCURRENTLY sro_tab;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX TABLE CONCURRENTLY sro_tab' at line 1")

-----------
QUERY:

DROP INDEX sro_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1")

-----------
QUERY:

-- CLUSTER
CREATE INDEX sro_cluster_idx ON sro_tab ((sro_ifun(a) + sro_ifun(0)));
RESULT:
	ERROR - (3758, "Expression of functional index 'sro_cluster_idx' contains a disallowed function.")

-----------
QUERY:

CLUSTER sro_tab USING sro_cluster_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CLUSTER sro_tab USING sro_cluster_idx' at line 1")

-----------
QUERY:

DROP INDEX sro_cluster_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1")

-----------
QUERY:

-- BRIN index
CREATE INDEX sro_brin ON sro_tab USING brin ((sro_ifun(a) + sro_ifun(0)));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'USING brin ((sro_ifun(a) + sro_ifun(0)))' at line 2")

-----------
QUERY:

SELECT brin_desummarize_range('sro_brin', 0);
RESULT:
	ERROR - (1305, 'FUNCTION test.brin_desummarize_range does not exist')

-----------
QUERY:

SELECT brin_summarize_range('sro_brin', 0);
RESULT:
	ERROR - (1305, 'FUNCTION test.brin_summarize_range does not exist')

-----------
QUERY:

DROP TABLE sro_tab;
RESULT:
	[]

-----------
QUERY:

-- Check with a partitioned table
CREATE TABLE sro_ptab (a int) PARTITION BY RANGE (a);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:

ALTER TABLE sro_ptab OWNER TO regress_sro_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNER TO regress_sro_user' at line 1")

-----------
QUERY:

CREATE TABLE sro_part PARTITION OF sro_ptab FOR VALUES FROM (1) TO (10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF sro_ptab FOR VALUES FROM (1) TO (10)' at line 1")

-----------
QUERY:

ALTER TABLE sro_part OWNER TO regress_sro_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNER TO regress_sro_user' at line 1")

-----------
QUERY:

INSERT INTO sro_ptab VALUES (1), (2), (3);
RESULT:
	ERROR - (1146, "Table 'test.sro_ptab' doesn't exist")

-----------
QUERY:

CREATE INDEX sro_pidx ON sro_ptab ((sro_ifun(a) + sro_ifun(0)))
	WHERE sro_ifun(a + 10) > sro_ifun(10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'WHERE sro_ifun(a + 10) > sro_ifun(10)' at line 2")

-----------
QUERY:

REINDEX TABLE sro_ptab;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX TABLE sro_ptab' at line 1")

-----------
QUERY:

REINDEX INDEX CONCURRENTLY sro_pidx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX INDEX CONCURRENTLY sro_pidx' at line 1")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_sro_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_sro_user' at line 1")

-----------
QUERY:

CREATE FUNCTION unwanted_grant() RETURNS void LANGUAGE sql AS
	'GRANT regress_priv_group2 TO regress_sro_user';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'void LANGUAGE sql AS\n\t'GRANT regress_priv_group2 TO regress_sro_user'' at line 1")

-----------
QUERY:

CREATE FUNCTION mv_action() RETURNS bool LANGUAGE sql AS
	'DECLARE c CURSOR WITH HOLD FOR SELECT public.unwanted_grant();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS\n\t'DECLARE c CURSOR WITH HOLD FOR SELECT public.unwanted_grant()' at line 1")

-----------
QUERY:
 SELECT true';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''' at line 1")

-----------
QUERY:

-- REFRESH of this MV will queue a GRANT at end of transaction
CREATE MATERIALIZED VIEW sro_mv AS SELECT mv_action() WITH NO DATA;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MATERIALIZED VIEW sro_mv AS SELECT mv_action() WITH NO DATA' at line 2")

-----------
QUERY:

REFRESH MATERIALIZED VIEW sro_mv;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REFRESH MATERIALIZED VIEW sro_mv' at line 1")

-----------
QUERY:

-- \c -
REFRESH MATERIALIZED VIEW sro_mv;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REFRESH MATERIALIZED VIEW sro_mv' at line 2")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_sro_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_sro_user' at line 1")

-----------
QUERY:

-- INSERT to this table will queue a GRANT at end of transaction
CREATE TABLE sro_trojan_table ();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 2")

-----------
QUERY:

CREATE FUNCTION sro_trojan() RETURNS trigger LANGUAGE plpgsql AS
	'BEGIN PERFORM public.unwanted_grant();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'trigger LANGUAGE plpgsql AS\n\t'BEGIN PERFORM public.unwanted_grant()' at line 1")

-----------
QUERY:
 RETURN NULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'RETURN NULL' at line 1")

-----------
QUERY:
 END';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'END'' at line 1")

-----------
QUERY:

CREATE CONSTRAINT TRIGGER t AFTER INSERT ON sro_trojan_table
    INITIALLY DEFERRED FOR EACH ROW EXECUTE PROCEDURE sro_trojan();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONSTRAINT TRIGGER t AFTER INSERT ON sro_trojan_table\n    INITIALLY DEFERRED FOR' at line 1")

-----------
QUERY:

-- Now, REFRESH will issue such an INSERT, queueing the GRANT
CREATE OR REPLACE FUNCTION mv_action() RETURNS bool LANGUAGE sql AS
	'INSERT INTO public.sro_trojan_table DEFAULT VALUES;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FUNCTION mv_action() RETURNS bool LANGUAGE sql AS\n\t'INSERT INTO public.sro_troja' at line 2")

-----------
QUERY:
 SELECT true';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''' at line 1")

-----------
QUERY:

REFRESH MATERIALIZED VIEW sro_mv;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REFRESH MATERIALIZED VIEW sro_mv' at line 1")

-----------
QUERY:

-- \c -
REFRESH MATERIALIZED VIEW sro_mv;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REFRESH MATERIALIZED VIEW sro_mv' at line 2")

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:
 SET CONSTRAINTS ALL IMMEDIATE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ALL IMMEDIATE' at line 1")

-----------
QUERY:
 REFRESH MATERIALIZED VIEW sro_mv;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REFRESH MATERIALIZED VIEW sro_mv' at line 1")

-----------
QUERY:
 COMMIT;
RESULT:
	[]

-----------
QUERY:


-- REFRESH MATERIALIZED VIEW CONCURRENTLY use of eval_const_expressions()
SET SESSION AUTHORIZATION regress_sro_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_sro_user' at line 2")

-----------
QUERY:

CREATE FUNCTION unwanted_grant_nofail(int) RETURNS int
	IMMUTABLE LANGUAGE plpgsql AS $$
BEGIN
	PERFORM public.unwanted_grant();
	RAISE WARNING 'owned';
	RETURN 1;
EXCEPTION WHEN OTHERS THEN
	RETURN 2;
END$$;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int) RETURNS int\n\tIMMUTABLE LANGUAGE plpgsql AS $$\nBEGIN\n\tPERFORM public.unwante' at line 1")

-----------
QUERY:

CREATE MATERIALIZED VIEW sro_index_mv AS SELECT 1 AS c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MATERIALIZED VIEW sro_index_mv AS SELECT 1 AS c' at line 1")

-----------
QUERY:

CREATE UNIQUE INDEX ON sro_index_mv (c) WHERE unwanted_grant_nofail(1) > 0;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON sro_index_mv (c) WHERE unwanted_grant_nofail(1) > 0' at line 1")

-----------
QUERY:

-- \c -
REFRESH MATERIALIZED VIEW CONCURRENTLY sro_index_mv;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REFRESH MATERIALIZED VIEW CONCURRENTLY sro_index_mv' at line 2")

-----------
QUERY:

REFRESH MATERIALIZED VIEW sro_index_mv;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REFRESH MATERIALIZED VIEW sro_index_mv' at line 1")

-----------
QUERY:


DROP OWNED BY regress_sro_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNED BY regress_sro_user' at line 1")

-----------
QUERY:

DROP ROLE regress_sro_user;
RESULT:
	[]

-----------
QUERY:



-- Admin options

SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 3")

-----------
QUERY:

CREATE FUNCTION dogrant_ok() RETURNS void LANGUAGE sql SECURITY DEFINER AS
	'GRANT regress_priv_group2 TO regress_priv_user5';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'void LANGUAGE sql SECURITY DEFINER AS\n\t'GRANT regress_priv_group2 TO regress_pri' at line 1")

-----------
QUERY:

GRANT regress_priv_group2 TO regress_priv_user5;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `regress_priv_group2`@`%`')

-----------
QUERY:
 -- ok: had ADMIN OPTION
SET ROLE regress_priv_group2;
RESULT:
	ERROR - (3530, '`regress_priv_group2`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

GRANT regress_priv_group2 TO regress_priv_user5;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `regress_priv_group2`@`%`')

-----------
QUERY:
 -- fails: SET ROLE suspended privilege

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:

GRANT regress_priv_group2 TO regress_priv_user5;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `regress_priv_group2`@`%`')

-----------
QUERY:
 -- fails: no ADMIN OPTION
SELECT dogrant_ok();
RESULT:
	ERROR - (1305, 'FUNCTION test.dogrant_ok does not exist')

-----------
QUERY:
			-- ok: SECURITY DEFINER conveys ADMIN
SET ROLE regress_priv_group2;
RESULT:
	ERROR - (3530, '`regress_priv_group2`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

GRANT regress_priv_group2 TO regress_priv_user5;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `regress_priv_group2`@`%`')

-----------
QUERY:
 -- fails: SET ROLE did not help

SET SESSION AUTHORIZATION regress_priv_group2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_group2' at line 3")

-----------
QUERY:

GRANT regress_priv_group2 TO regress_priv_user5;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `regress_priv_group2`@`%`')

-----------
QUERY:
 -- fails: no self-admin

SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 3")

-----------
QUERY:

DROP FUNCTION dogrant_ok();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:

REVOKE regress_priv_group2 FROM regress_priv_user5;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `regress_priv_group2`@`%`')

-----------
QUERY:



-- has_sequence_privilege tests
-- \c -

CREATE SEQUENCE x_seq;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SEQUENCE x_seq' at line 4")

-----------
QUERY:


GRANT USAGE on x_seq to regress_priv_user2;
RESULT:
	ERROR - (1146, "Table 'test.x_seq' doesn't exist")

-----------
QUERY:


SELECT has_sequence_privilege('regress_priv_user1', 'atest1', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_sequence_privilege does not exist')

-----------
QUERY:

SELECT has_sequence_privilege('regress_priv_user1', 'x_seq', 'INSERT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_sequence_privilege does not exist')

-----------
QUERY:

SELECT has_sequence_privilege('regress_priv_user1', 'x_seq', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_sequence_privilege does not exist')

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:


SELECT has_sequence_privilege('x_seq', 'USAGE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_sequence_privilege does not exist')

-----------
QUERY:


-- largeobject privilege tests
-- \c -
SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 3")

-----------
QUERY:


SELECT lo_create(1001);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_create does not exist')

-----------
QUERY:

SELECT lo_create(1002);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_create does not exist')

-----------
QUERY:

SELECT lo_create(1003);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_create does not exist')

-----------
QUERY:

SELECT lo_create(1004);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_create does not exist')

-----------
QUERY:

SELECT lo_create(1005);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_create does not exist')

-----------
QUERY:


GRANT ALL ON LARGE OBJECT 1001 TO PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT 1001 TO PUBLIC' at line 1")

-----------
QUERY:

GRANT SELECT ON LARGE OBJECT 1003 TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT 1003 TO regress_priv_user2' at line 1")

-----------
QUERY:

GRANT SELECT,UPDATE ON LARGE OBJECT 1004 TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT 1004 TO regress_priv_user2' at line 1")

-----------
QUERY:

GRANT ALL ON LARGE OBJECT 1005 TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT 1005 TO regress_priv_user2' at line 1")

-----------
QUERY:

GRANT SELECT ON LARGE OBJECT 1005 TO regress_priv_user2 WITH GRANT OPTION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT 1005 TO regress_priv_user2 WITH GRANT OPTION' at line 1")

-----------
QUERY:


GRANT SELECT, INSERT ON LARGE OBJECT 1001 TO PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT 1001 TO PUBLIC' at line 1")

-----------
QUERY:
	-- to be failed
GRANT SELECT, UPDATE ON LARGE OBJECT 1001 TO nosuchuser;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT 1001 TO nosuchuser' at line 2")

-----------
QUERY:
	-- to be failed
GRANT SELECT, UPDATE ON LARGE OBJECT  999 TO PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT  999 TO PUBLIC' at line 2")

-----------
QUERY:
	-- to be failed

-- \c -
SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 4")

-----------
QUERY:


SELECT lo_create(2001);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_create does not exist')

-----------
QUERY:

SELECT lo_create(2002);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_create does not exist')

-----------
QUERY:
	-- allowed, for now
SELECT lowrite(lo_open(1001, x'40000'::int), 'abcd');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'40000'::int), 'abcd')' at line 2")

-----------
QUERY:

SELECT loread(lo_open(1002, x'40000'::int), 32);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'40000'::int), 32)' at line 1")

-----------
QUERY:


SELECT lowrite(lo_open(1001, x'20000'::int), 'abcd');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'20000'::int), 'abcd')' at line 1")

-----------
QUERY:

SELECT lowrite(lo_open(1002, x'20000'::int), 'abcd');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'20000'::int), 'abcd')' at line 1")

-----------
QUERY:
	-- to be denied
SELECT lowrite(lo_open(1003, x'20000'::int), 'abcd');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'20000'::int), 'abcd')' at line 2")

-----------
QUERY:
	-- to be denied
SELECT lowrite(lo_open(1004, x'20000'::int), 'abcd');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'20000'::int), 'abcd')' at line 2")

-----------
QUERY:


GRANT SELECT ON LARGE OBJECT 1005 TO regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT 1005 TO regress_priv_user3' at line 1")

-----------
QUERY:

GRANT UPDATE ON LARGE OBJECT 1006 TO regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT 1006 TO regress_priv_user3' at line 1")

-----------
QUERY:
	-- to be denied
REVOKE ALL ON LARGE OBJECT 2001, 2002 FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT 2001, 2002 FROM PUBLIC' at line 2")

-----------
QUERY:

GRANT ALL ON LARGE OBJECT 2001 TO regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OBJECT 2001 TO regress_priv_user3' at line 1")

-----------
QUERY:


SELECT lo_unlink(1001);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_unlink does not exist')

-----------
QUERY:
		-- to be denied
SELECT lo_unlink(2002);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_unlink does not exist')

-----------
QUERY:


-- \c -
-- confirm ACL setting
SELECT oid, pg_get_userbyid(lomowner) ownername, lomacl FROM pg_largeobject_metadata WHERE oid >= 1000 AND oid < 3000 ORDER BY oid;
RESULT:
	ERROR - (1146, "Table 'test.pg_largeobject_metadata' doesn't exist")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user3' at line 1")

-----------
QUERY:

SELECT loread(lo_open(1003, x'40000'::int), 32);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'40000'::int), 32)' at line 1")

-----------
QUERY:


SELECT lo_truncate(lo_open(1005, x'20000'::int), 10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'20000'::int), 10)' at line 1")

-----------
QUERY:
	-- to be denied
SELECT lo_truncate(lo_open(2001, x'20000'::int), 10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'20000'::int), 10)' at line 2")

-----------
QUERY:


-- compatibility mode in largeobject permission
-- \c -
SET lo_compat_privileges = false;
RESULT:
	ERROR - (1193, "Unknown system variable 'lo_compat_privileges'")

-----------
QUERY:
	-- default setting
SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 2")

-----------
QUERY:


SELECT loread(lo_open(1002, x'40000'::int), 32);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'40000'::int), 32)' at line 1")

-----------
QUERY:
	-- to be denied
SELECT lowrite(lo_open(1002, x'20000'::int), 'abcd');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'20000'::int), 'abcd')' at line 2")

-----------
QUERY:
	-- to be denied
SELECT lo_truncate(lo_open(1002, x'20000'::int), 10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'20000'::int), 10)' at line 2")

-----------
QUERY:
	-- to be denied
SELECT lo_put(1002, 1, 'abcd');
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_put does not exist')

-----------
QUERY:
				-- to be denied
SELECT lo_unlink(1002);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_unlink does not exist')

-----------
QUERY:
					-- to be denied
SELECT lo_export(1001, '/dev/null');
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_export does not exist')

-----------
QUERY:
			-- to be denied
SELECT lo_import('/dev/null');
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_import does not exist')

-----------
QUERY:
				-- to be denied
SELECT lo_import('/dev/null', 2003);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_import does not exist')

-----------
QUERY:
			-- to be denied

-- \c -
SET lo_compat_privileges = true;
RESULT:
	ERROR - (1193, "Unknown system variable 'lo_compat_privileges'")

-----------
QUERY:
	-- compatibility mode
SET SESSION AUTHORIZATION regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 2")

-----------
QUERY:


SELECT loread(lo_open(1002, x'40000'::int), 32);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'40000'::int), 32)' at line 1")

-----------
QUERY:

SELECT lowrite(lo_open(1002, x'20000'::int), 'abcd');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'20000'::int), 'abcd')' at line 1")

-----------
QUERY:

SELECT lo_truncate(lo_open(1002, x'20000'::int), 10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'x'20000'::int), 10)' at line 1")

-----------
QUERY:

SELECT lo_unlink(1002);
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_unlink does not exist')

-----------
QUERY:

SELECT lo_export(1001, '/dev/null');
RESULT:
	ERROR - (1305, 'FUNCTION test.lo_export does not exist')

-----------
QUERY:
			-- to be denied

-- don/* REPLACED */ ''t allow unpriv users to access pg_largeobject contents
-- \c -
SELECT * FROM pg_largeobject LIMIT 0;
RESULT:
	ERROR - (1146, "Table 'test.pg_largeobject' doesn't exist")

-----------
QUERY:


SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 1")

-----------
QUERY:

SELECT * FROM pg_largeobject LIMIT 0;
RESULT:
	ERROR - (1146, "Table 'test.pg_largeobject' doesn't exist")

-----------
QUERY:
			-- to be denied

-- pg_signal_backend can/* REPLACED */ ''t signal superusers
RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 4")

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

CREATE OR REPLACE FUNCTION terminate_nothrow(pid int) RETURNS bool
	LANGUAGE plpgsql SECURITY DEFINER SET client_min_messages = error AS $$
BEGIN
	RETURN pg_terminate_backend($1);
EXCEPTION WHEN OTHERS THEN
	RETURN false;
END$$;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FUNCTION terminate_nothrow(pid int) RETURNS bool\n\tLANGUAGE plpgsql SECURITY DEFI' at line 1")

-----------
QUERY:

ALTER FUNCTION terminate_nothrow OWNER TO pg_signal_backend;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNER TO pg_signal_backend' at line 1")

-----------
QUERY:

SELECT backend_type FROM pg_stat_activity
WHERE CASE WHEN COALESCE(usesysid, 10) = 10 THEN terminate_nothrow(pid) END;
RESULT:
	ERROR - (1146, "Table 'test.pg_stat_activity' doesn't exist")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:


-- test pg_database_owner
RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 2")

-----------
QUERY:

GRANT pg_database_owner TO regress_priv_user1;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `pg_database_owner`@`%`')

-----------
QUERY:

GRANT regress_priv_user1 TO pg_database_owner;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `pg_database_owner`@`%`')

-----------
QUERY:

CREATE TABLE datdba_only ();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1")

-----------
QUERY:

ALTER TABLE datdba_only OWNER TO pg_database_owner;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNER TO pg_database_owner' at line 1")

-----------
QUERY:

REVOKE DELETE ON datdba_only FROM pg_database_owner;
RESULT:
	ERROR - (1147, "There is no such grant defined for user 'pg_database_owner' on host '%' on table 'datdba_only'")

-----------
QUERY:

SELECT
	pg_has_role('regress_priv_user1', 'pg_database_owner', 'USAGE') as priv,
	pg_has_role('regress_priv_user1', 'pg_database_owner', 'MEMBER') as mem,
	pg_has_role('regress_priv_user1', 'pg_database_owner',
				'MEMBER WITH ADMIN OPTION') as admin;
RESULT:
	ERROR - (1305, 'FUNCTION test.pg_has_role does not exist')

-----------
QUERY:


BEGIN;
RESULT:
	[]

-----------
QUERY:

DO $$BEGIN EXECUTE format(
	'ALTER DATABASE %I OWNER TO regress_priv_group2', current_catalog); END$$;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'format(\n\t'ALTER DATABASE %I OWNER TO regress_priv_group2', current_catalog); END' at line 1")

-----------
QUERY:

SELECT
	pg_has_role('regress_priv_user1', 'pg_database_owner', 'USAGE') as priv,
	pg_has_role('regress_priv_user1', 'pg_database_owner', 'MEMBER') as mem,
	pg_has_role('regress_priv_user1', 'pg_database_owner',
				'MEMBER WITH ADMIN OPTION') as admin;
RESULT:
	ERROR - (1305, 'FUNCTION test.pg_has_role does not exist')

-----------
QUERY:

SET SESSION AUTHORIZATION regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 1")

-----------
QUERY:

TABLE information_schema.enabled_roles ORDER BY role_name COLLATE "C";
RESULT:
	ERROR - (1273, "Unknown collation: 'C'")

-----------
QUERY:

TABLE information_schema.applicable_roles ORDER BY role_name COLLATE "C";
RESULT:
	ERROR - (1273, "Unknown collation: 'C'")

-----------
QUERY:

INSERT INTO datdba_only DEFAULT VALUES;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

SAVEPOINT q;
RESULT:
	[]

-----------
QUERY:
 DELETE FROM datdba_only;
RESULT:
	ERROR - (1146, "Table 'test.datdba_only' doesn't exist")

-----------
QUERY:
 ROLLBACK TO q;
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:

TABLE information_schema.enabled_roles;
RESULT:
	()

-----------
QUERY:

INSERT INTO datdba_only DEFAULT VALUES;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:


-- test default ACLs
-- \c -

CREATE SCHEMA testns;
RESULT:
	[]

-----------
QUERY:

GRANT ALL ON SCHEMA testns TO regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SCHEMA testns TO regress_priv_user1' at line 1")

-----------
QUERY:


CREATE TABLE testns.acltest1 (x int);
RESULT:
	[]

-----------
QUERY:

SELECT has_table_privilege('regress_priv_user1', 'testns.acltest1', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- no
SELECT has_table_privilege('regress_priv_user1', 'testns.acltest1', 'INSERT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- no

-- placeholder for test with duplicated schema and role names
ALTER DEFAULT PRIVILEGES IN SCHEMA testns,testns GRANT SELECT ON TABLES TO public,public;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES IN SCHEMA testns,testns GRANT SELECT ON TABLES TO public,publ' at line 4")

-----------
QUERY:


SELECT has_table_privilege('regress_priv_user1', 'testns.acltest1', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- no
SELECT has_table_privilege('regress_priv_user1', 'testns.acltest1', 'INSERT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- no

DROP TABLE testns.acltest1;
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testns.acltest1 (x int);
RESULT:
	[]

-----------
QUERY:


SELECT has_table_privilege('regress_priv_user1', 'testns.acltest1', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- yes
SELECT has_table_privilege('regress_priv_user1', 'testns.acltest1', 'INSERT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- no

ALTER DEFAULT PRIVILEGES IN SCHEMA testns GRANT INSERT ON TABLES TO regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES IN SCHEMA testns GRANT INSERT ON TABLES TO regress_priv_user1' at line 3")

-----------
QUERY:


DROP TABLE testns.acltest1;
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testns.acltest1 (x int);
RESULT:
	[]

-----------
QUERY:


SELECT has_table_privilege('regress_priv_user1', 'testns.acltest1', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- yes
SELECT has_table_privilege('regress_priv_user1', 'testns.acltest1', 'INSERT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- yes

ALTER DEFAULT PRIVILEGES IN SCHEMA testns REVOKE INSERT ON TABLES FROM regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES IN SCHEMA testns REVOKE INSERT ON TABLES FROM regress_priv_us' at line 3")

-----------
QUERY:


DROP TABLE testns.acltest1;
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testns.acltest1 (x int);
RESULT:
	[]

-----------
QUERY:


SELECT has_table_privilege('regress_priv_user1', 'testns.acltest1', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- yes
SELECT has_table_privilege('regress_priv_user1', 'testns.acltest1', 'INSERT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- no

ALTER DEFAULT PRIVILEGES FOR ROLE regress_priv_user1 REVOKE EXECUTE ON FUNCTIONS FROM public;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES FOR ROLE regress_priv_user1 REVOKE EXECUTE ON FUNCTIONS FROM ' at line 3")

-----------
QUERY:


ALTER DEFAULT PRIVILEGES IN SCHEMA testns GRANT USAGE ON SCHEMAS TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES IN SCHEMA testns GRANT USAGE ON SCHEMAS TO regress_priv_user2' at line 1")

-----------
QUERY:
 -- error

-- Test makeaclitem()
SELECT makeaclitem('regress_priv_user1'::regrole, 'regress_priv_user2'::regrole,
	'SELECT', TRUE);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regrole, 'regress_priv_user2'::regrole,\n\t'SELECT', TRUE)' at line 4")

-----------
QUERY:
  -- single privilege
SELECT makeaclitem('regress_priv_user1'::regrole, 'regress_priv_user2'::regrole,
	'SELECT, INSERT,  UPDATE , DELETE  ', FALSE);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regrole, 'regress_priv_user2'::regrole,\n\t'SELECT, INSERT,  UPDATE , DELETE  ',' at line 2")

-----------
QUERY:
  -- multiple privileges
SELECT makeaclitem('regress_priv_user1'::regrole, 'regress_priv_user2'::regrole,
	'SELECT, fake_privilege', FALSE);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regrole, 'regress_priv_user2'::regrole,\n\t'SELECT, fake_privilege', FALSE)' at line 2")

-----------
QUERY:
  -- error

-- Test non-throwing aclitem I/O
SELECT pg_input_is_valid('regress_priv_user1=r/regress_priv_user2', 'aclitem');
RESULT:
	ERROR - (1305, 'FUNCTION test.pg_input_is_valid does not exist')

-----------
QUERY:

SELECT pg_input_is_valid('regress_priv_user1=r/', 'aclitem');
RESULT:
	ERROR - (1305, 'FUNCTION test.pg_input_is_valid does not exist')

-----------
QUERY:

SELECT * FROM pg_input_error_info('regress_priv_user1=r/', 'aclitem');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '('regress_priv_user1=r/', 'aclitem')' at line 1")

-----------
QUERY:

SELECT pg_input_is_valid('regress_priv_user1=r/regress_no_such_user', 'aclitem');
RESULT:
	ERROR - (1305, 'FUNCTION test.pg_input_is_valid does not exist')

-----------
QUERY:

SELECT * FROM pg_input_error_info('regress_priv_user1=r/regress_no_such_user', 'aclitem');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '('regress_priv_user1=r/regress_no_such_user', 'aclitem')' at line 1")

-----------
QUERY:

SELECT pg_input_is_valid('regress_priv_user1=rY', 'aclitem');
RESULT:
	ERROR - (1305, 'FUNCTION test.pg_input_is_valid does not exist')

-----------
QUERY:

SELECT * FROM pg_input_error_info('regress_priv_user1=rY', 'aclitem');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '('regress_priv_user1=rY', 'aclitem')' at line 1")

-----------
QUERY:


--
-- Testing blanket default grants is very hazardous since it might change
-- the privileges attached to objects created by concurrent regression tests.
-- To avoid that, be sure to revoke the privileges again before committing.
--
BEGIN;
RESULT:
	[]

-----------
QUERY:


ALTER DEFAULT PRIVILEGES GRANT USAGE ON SCHEMAS TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES GRANT USAGE ON SCHEMAS TO regress_priv_user2' at line 1")

-----------
QUERY:


CREATE SCHEMA testns2;
RESULT:
	[]

-----------
QUERY:


SELECT has_schema_privilege('regress_priv_user2', 'testns2', 'USAGE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_schema_privilege does not exist')

-----------
QUERY:
 -- yes
SELECT has_schema_privilege('regress_priv_user6', 'testns2', 'USAGE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_schema_privilege does not exist')

-----------
QUERY:
 -- yes
SELECT has_schema_privilege('regress_priv_user2', 'testns2', 'CREATE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_schema_privilege does not exist')

-----------
QUERY:
 -- no

ALTER DEFAULT PRIVILEGES REVOKE USAGE ON SCHEMAS FROM regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES REVOKE USAGE ON SCHEMAS FROM regress_priv_user2' at line 3")

-----------
QUERY:


CREATE SCHEMA testns3;
RESULT:
	[]

-----------
QUERY:


SELECT has_schema_privilege('regress_priv_user2', 'testns3', 'USAGE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_schema_privilege does not exist')

-----------
QUERY:
 -- no
SELECT has_schema_privilege('regress_priv_user2', 'testns3', 'CREATE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_schema_privilege does not exist')

-----------
QUERY:
 -- no

ALTER DEFAULT PRIVILEGES GRANT ALL ON SCHEMAS TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES GRANT ALL ON SCHEMAS TO regress_priv_user2' at line 3")

-----------
QUERY:


CREATE SCHEMA testns4;
RESULT:
	[]

-----------
QUERY:


SELECT has_schema_privilege('regress_priv_user2', 'testns4', 'USAGE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_schema_privilege does not exist')

-----------
QUERY:
 -- yes
SELECT has_schema_privilege('regress_priv_user2', 'testns4', 'CREATE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_schema_privilege does not exist')

-----------
QUERY:
 -- yes

ALTER DEFAULT PRIVILEGES REVOKE ALL ON SCHEMAS FROM regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES REVOKE ALL ON SCHEMAS FROM regress_priv_user2' at line 3")

-----------
QUERY:


COMMIT;
RESULT:
	[]

-----------
QUERY:


-- Test for DROP OWNED BY with shared dependencies.  This is done in a
-- separate, rollbacked, transaction to avoid any trouble with other
-- regression sessions.
BEGIN;
RESULT:
	[]

-----------
QUERY:

ALTER DEFAULT PRIVILEGES GRANT ALL ON FUNCTIONS TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES GRANT ALL ON FUNCTIONS TO regress_priv_user2' at line 1")

-----------
QUERY:

ALTER DEFAULT PRIVILEGES GRANT ALL ON SCHEMAS TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES GRANT ALL ON SCHEMAS TO regress_priv_user2' at line 1")

-----------
QUERY:

ALTER DEFAULT PRIVILEGES GRANT ALL ON SEQUENCES TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES GRANT ALL ON SEQUENCES TO regress_priv_user2' at line 1")

-----------
QUERY:

ALTER DEFAULT PRIVILEGES GRANT ALL ON TABLES TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES GRANT ALL ON TABLES TO regress_priv_user2' at line 1")

-----------
QUERY:

ALTER DEFAULT PRIVILEGES GRANT ALL ON TYPES TO regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES GRANT ALL ON TYPES TO regress_priv_user2' at line 1")

-----------
QUERY:

SELECT count(*) FROM pg_shdepend
  WHERE deptype = 'a' AND
        refobjid = 'regress_priv_user2'::regrole AND
	classid = 'pg_default_acl'::regclass;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regrole AND\n\tclassid = 'pg_default_acl'::regclass' at line 3")

-----------
QUERY:

DROP OWNED BY regress_priv_user2, regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNED BY regress_priv_user2, regress_priv_user2' at line 1")

-----------
QUERY:

SELECT count(*) FROM pg_shdepend
  WHERE deptype = 'a' AND
        refobjid = 'regress_priv_user2'::regrole AND
	classid = 'pg_default_acl'::regclass;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regrole AND\n\tclassid = 'pg_default_acl'::regclass' at line 3")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:


CREATE SCHEMA testns5;
RESULT:
	[]

-----------
QUERY:


SELECT has_schema_privilege('regress_priv_user2', 'testns5', 'USAGE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_schema_privilege does not exist')

-----------
QUERY:
 -- no
SELECT has_schema_privilege('regress_priv_user2', 'testns5', 'CREATE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_schema_privilege does not exist')

-----------
QUERY:
 -- no

SET ROLE regress_priv_user1;
RESULT:
	ERROR - (3530, '`regress_priv_user1`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:


CREATE FUNCTION testns.foo() RETURNS int AS 'select 1' LANGUAGE sql;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 'select 1' LANGUAGE sql' at line 1")

-----------
QUERY:

CREATE AGGREGATE testns.agg1(int) (sfunc = int4pl, stype = int4);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'testns.agg1(int) (sfunc = int4pl, stype = int4)' at line 1")

-----------
QUERY:

CREATE PROCEDURE testns.bar() AS 'select 1' LANGUAGE sql;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 'select 1' LANGUAGE sql' at line 1")

-----------
QUERY:


SELECT has_function_privilege('regress_priv_user2', 'testns.foo()', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- no
SELECT has_function_privilege('regress_priv_user2', 'testns.agg1(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- no
SELECT has_function_privilege('regress_priv_user2', 'testns.bar()', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- no

ALTER DEFAULT PRIVILEGES IN SCHEMA testns GRANT EXECUTE ON ROUTINES to public;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES IN SCHEMA testns GRANT EXECUTE ON ROUTINES to public' at line 3")

-----------
QUERY:


DROP FUNCTION testns.foo();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:

CREATE FUNCTION testns.foo() RETURNS int AS 'select 1' LANGUAGE sql;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 'select 1' LANGUAGE sql' at line 1")

-----------
QUERY:

DROP AGGREGATE testns.agg1(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AGGREGATE testns.agg1(int)' at line 1")

-----------
QUERY:

CREATE AGGREGATE testns.agg1(int) (sfunc = int4pl, stype = int4);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'testns.agg1(int) (sfunc = int4pl, stype = int4)' at line 1")

-----------
QUERY:

DROP PROCEDURE testns.bar();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:

CREATE PROCEDURE testns.bar() AS 'select 1' LANGUAGE sql;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 'select 1' LANGUAGE sql' at line 1")

-----------
QUERY:


SELECT has_function_privilege('regress_priv_user2', 'testns.foo()', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- yes
SELECT has_function_privilege('regress_priv_user2', 'testns.agg1(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- yes
SELECT has_function_privilege('regress_priv_user2', 'testns.bar()', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- yes (counts as function here)

DROP FUNCTION testns.foo();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 3")

-----------
QUERY:

DROP AGGREGATE testns.agg1(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AGGREGATE testns.agg1(int)' at line 1")

-----------
QUERY:

DROP PROCEDURE testns.bar();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:


ALTER DEFAULT PRIVILEGES FOR ROLE regress_priv_user1 REVOKE USAGE ON TYPES FROM public;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES FOR ROLE regress_priv_user1 REVOKE USAGE ON TYPES FROM public' at line 1")

-----------
QUERY:


CREATE DOMAIN testns.priv_testdomain1 AS int;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN testns.priv_testdomain1 AS int' at line 1")

-----------
QUERY:


SELECT has_type_privilege('regress_priv_user2', 'testns.priv_testdomain1', 'USAGE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_type_privilege does not exist')

-----------
QUERY:
 -- no

ALTER DEFAULT PRIVILEGES IN SCHEMA testns GRANT USAGE ON TYPES to public;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT PRIVILEGES IN SCHEMA testns GRANT USAGE ON TYPES to public' at line 3")

-----------
QUERY:


DROP DOMAIN testns.priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN testns.priv_testdomain1' at line 1")

-----------
QUERY:

CREATE DOMAIN testns.priv_testdomain1 AS int;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN testns.priv_testdomain1 AS int' at line 1")

-----------
QUERY:


SELECT has_type_privilege('regress_priv_user2', 'testns.priv_testdomain1', 'USAGE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_type_privilege does not exist')

-----------
QUERY:
 -- yes

DROP DOMAIN testns.priv_testdomain1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DOMAIN testns.priv_testdomain1' at line 3")

-----------
QUERY:


RESET ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ROLE' at line 1")

-----------
QUERY:


SELECT count(*)
  FROM pg_default_acl d LEFT JOIN pg_namespace n ON defaclnamespace = n.oid
  WHERE nspname = 'testns';
RESULT:
	ERROR - (1146, "Table 'test.pg_default_acl' doesn't exist")

-----------
QUERY:


DROP SCHEMA testns CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:

DROP SCHEMA testns2 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:

DROP SCHEMA testns3 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:

DROP SCHEMA testns4 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:

DROP SCHEMA testns5 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:


SELECT d.*     -- check that entries went away
  FROM pg_default_acl d LEFT JOIN pg_namespace n ON defaclnamespace = n.oid
  WHERE nspname IS NULL AND defaclnamespace != 0;
RESULT:
	ERROR - (1146, "Table 'test.pg_default_acl' doesn't exist")

-----------
QUERY:



-- Grant on all objects of given type in a schema
-- \c -

CREATE SCHEMA testns;
RESULT:
	ERROR - (1007, "Can't create database 'testns'; database exists")

-----------
QUERY:

CREATE TABLE testns.t1 (f1 int);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testns.t2 (f1 int);
RESULT:
	[]

-----------
QUERY:


SELECT has_table_privilege('regress_priv_user1', 'testns.t1', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- false

GRANT ALL ON ALL TABLES IN SCHEMA testns TO regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ALL TABLES IN SCHEMA testns TO regress_priv_user1' at line 3")

-----------
QUERY:


SELECT has_table_privilege('regress_priv_user1', 'testns.t1', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- true
SELECT has_table_privilege('regress_priv_user1', 'testns.t2', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- true

REVOKE ALL ON ALL TABLES IN SCHEMA testns FROM regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ALL TABLES IN SCHEMA testns FROM regress_priv_user1' at line 3")

-----------
QUERY:


SELECT has_table_privilege('regress_priv_user1', 'testns.t1', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- false
SELECT has_table_privilege('regress_priv_user1', 'testns.t2', 'SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- false

CREATE FUNCTION testns.priv_testfunc(int) RETURNS int AS 'select 3 * $1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int) RETURNS int AS 'select 3 * $1' at line 3")

-----------
QUERY:
' LANGUAGE sql;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' LANGUAGE sql' at line 1")

-----------
QUERY:

CREATE AGGREGATE testns.priv_testagg(int) (sfunc = int4pl, stype = int4);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'testns.priv_testagg(int) (sfunc = int4pl, stype = int4)' at line 1")

-----------
QUERY:

CREATE PROCEDURE testns.priv_testproc(int) AS 'select 3' LANGUAGE sql;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int) AS 'select 3' LANGUAGE sql' at line 1")

-----------
QUERY:


SELECT has_function_privilege('regress_priv_user1', 'testns.priv_testfunc(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- true by default
SELECT has_function_privilege('regress_priv_user1', 'testns.priv_testagg(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- true by default
SELECT has_function_privilege('regress_priv_user1', 'testns.priv_testproc(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- true by default

REVOKE ALL ON ALL FUNCTIONS IN SCHEMA testns FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ALL FUNCTIONS IN SCHEMA testns FROM PUBLIC' at line 3")

-----------
QUERY:


SELECT has_function_privilege('regress_priv_user1', 'testns.priv_testfunc(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- false
SELECT has_function_privilege('regress_priv_user1', 'testns.priv_testagg(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- false
SELECT has_function_privilege('regress_priv_user1', 'testns.priv_testproc(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- still true, not a function

REVOKE ALL ON ALL PROCEDURES IN SCHEMA testns FROM PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ALL PROCEDURES IN SCHEMA testns FROM PUBLIC' at line 3")

-----------
QUERY:


SELECT has_function_privilege('regress_priv_user1', 'testns.priv_testproc(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- now false

GRANT ALL ON ALL ROUTINES IN SCHEMA testns TO PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ALL ROUTINES IN SCHEMA testns TO PUBLIC' at line 3")

-----------
QUERY:


SELECT has_function_privilege('regress_priv_user1', 'testns.priv_testfunc(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- true
SELECT has_function_privilege('regress_priv_user1', 'testns.priv_testagg(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- true
SELECT has_function_privilege('regress_priv_user1', 'testns.priv_testproc(int)', 'EXECUTE');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_function_privilege does not exist')

-----------
QUERY:
 -- true

DROP SCHEMA testns CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 3")

-----------
QUERY:



-- Change owner of the schema & and rename of new schema owner
-- \c -

CREATE ROLE regress_schemauser1 superuser login;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'superuser login' at line 4")

-----------
QUERY:

CREATE ROLE regress_schemauser2 superuser login;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'superuser login' at line 1")

-----------
QUERY:


SET SESSION ROLE regress_schemauser1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_schemauser1' at line 1")

-----------
QUERY:

CREATE SCHEMA testns;
RESULT:
	ERROR - (1007, "Can't create database 'testns'; database exists")

-----------
QUERY:


SELECT nspname, rolname FROM pg_namespace, pg_roles WHERE pg_namespace.nspname = 'testns' AND pg_namespace.nspowner = pg_roles.oid;
RESULT:
	ERROR - (1146, "Table 'test.pg_namespace' doesn't exist")

-----------
QUERY:


ALTER SCHEMA testns OWNER TO regress_schemauser2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNER TO regress_schemauser2' at line 1")

-----------
QUERY:

ALTER ROLE regress_schemauser2 RENAME TO regress_schemauser_renamed;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ROLE regress_schemauser2 RENAME TO regress_schemauser_renamed' at line 1")

-----------
QUERY:

SELECT nspname, rolname FROM pg_namespace, pg_roles WHERE pg_namespace.nspname = 'testns' AND pg_namespace.nspowner = pg_roles.oid;
RESULT:
	ERROR - (1146, "Table 'test.pg_namespace' doesn't exist")

-----------
QUERY:


set session role regress_schemauser_renamed;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_schemauser_renamed' at line 1")

-----------
QUERY:

DROP SCHEMA testns CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:


-- clean up
-- \c -

DROP ROLE regress_schemauser1;
RESULT:
	ERROR - (1396, "Operation DROP ROLE failed for 'regress_schemauser1'@'%'")

-----------
QUERY:

DROP ROLE regress_schemauser_renamed;
RESULT:
	ERROR - (1396, "Operation DROP ROLE failed for 'regress_schemauser_renamed'@'%'")

-----------
QUERY:



-- test that dependent privileges are revoked (or not) properly
-- \c -

set session role regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 4")

-----------
QUERY:

create table dep_priv_test (a int);
RESULT:
	[]

-----------
QUERY:

grant select on dep_priv_test to regress_priv_user2 with grant option;
RESULT:
	[]

-----------
QUERY:

grant select on dep_priv_test to regress_priv_user3 with grant option;
RESULT:
	[]

-----------
QUERY:

set session role regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 1")

-----------
QUERY:

grant select on dep_priv_test to regress_priv_user4 with grant option;
RESULT:
	[]

-----------
QUERY:

set session role regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user3' at line 1")

-----------
QUERY:

grant select on dep_priv_test to regress_priv_user4 with grant option;
RESULT:
	[]

-----------
QUERY:

set session role regress_priv_user4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user4' at line 1")

-----------
QUERY:

grant select on dep_priv_test to regress_priv_user5;
RESULT:
	[]

-----------
QUERY:

-- \dp dep_priv_test
set session role regress_priv_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user2' at line 2")

-----------
QUERY:

revoke select on dep_priv_test from regress_priv_user4 cascade;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'cascade' at line 1")

-----------
QUERY:

-- \dp dep_priv_test
set session role regress_priv_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user3' at line 2")

-----------
QUERY:

revoke select on dep_priv_test from regress_priv_user4 cascade;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'cascade' at line 1")

-----------
QUERY:

-- \dp dep_priv_test
set session role regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_priv_user1' at line 2")

-----------
QUERY:

drop table dep_priv_test;
RESULT:
	[]

-----------
QUERY:



-- clean up

-- \c

drop sequence x_seq;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'sequence x_seq' at line 5")

-----------
QUERY:


DROP AGGREGATE priv_testagg1(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AGGREGATE priv_testagg1(int)' at line 1")

-----------
QUERY:

DROP FUNCTION priv_testfunc2(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int)' at line 1")

-----------
QUERY:

DROP FUNCTION priv_testfunc4(boolean);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(boolean)' at line 1")

-----------
QUERY:

DROP PROCEDURE priv_testproc1(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int)' at line 1")

-----------
QUERY:


DROP VIEW atestv0;
RESULT:
	[]

-----------
QUERY:

DROP VIEW atestv1;
RESULT:
	[]

-----------
QUERY:

DROP VIEW atestv2;
RESULT:
	[]

-----------
QUERY:

-- this should cascade to drop atestv4
DROP VIEW atestv3 CASCADE;
RESULT:
	[]

-----------
QUERY:

-- this should complain /* REPLACED */ ''does not exist/* REPLACED */ ''
DROP VIEW atestv4;
RESULT:
	[]

-----------
QUERY:


DROP TABLE atest1;
RESULT:
	[]

-----------
QUERY:

DROP TABLE atest2;
RESULT:
	[]

-----------
QUERY:

DROP TABLE atest3;
RESULT:
	[]

-----------
QUERY:

DROP TABLE atest4;
RESULT:
	[]

-----------
QUERY:

DROP TABLE atest5;
RESULT:
	[]

-----------
QUERY:

DROP TABLE atest6;
RESULT:
	[]

-----------
QUERY:

DROP TABLE atestc;
RESULT:
	ERROR - (1051, "Unknown table 'test.atestc'")

-----------
QUERY:

DROP TABLE atestp1;
RESULT:
	[]

-----------
QUERY:

DROP TABLE atestp2;
RESULT:
	[]

-----------
QUERY:


SELECT lo_unlink(oid) FROM pg_largeobject_metadata WHERE oid >= 1000 AND oid < 3000 ORDER BY oid;
RESULT:
	ERROR - (1146, "Table 'test.pg_largeobject_metadata' doesn't exist")

-----------
QUERY:


DROP GROUP regress_priv_group1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP regress_priv_group1' at line 1")

-----------
QUERY:

DROP GROUP regress_priv_group2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP regress_priv_group2' at line 1")

-----------
QUERY:


-- these are needed to clean up permissions
REVOKE USAGE ON LANGUAGE sql FROM regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'sql FROM regress_priv_user1' at line 2")

-----------
QUERY:

DROP OWNED BY regress_priv_user1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNED BY regress_priv_user1' at line 1")

-----------
QUERY:


DROP USER regress_priv_user1;
RESULT:
	[]

-----------
QUERY:

DROP USER regress_priv_user2;
RESULT:
	[]

-----------
QUERY:

DROP USER regress_priv_user3;
RESULT:
	[]

-----------
QUERY:

DROP USER regress_priv_user4;
RESULT:
	[]

-----------
QUERY:

DROP USER regress_priv_user5;
RESULT:
	[]

-----------
QUERY:

DROP USER regress_priv_user6;
RESULT:
	[]

-----------
QUERY:

DROP USER regress_priv_user7;
RESULT:
	[]

-----------
QUERY:

DROP USER regress_priv_user8;
RESULT:
	ERROR - (1396, "Operation DROP USER failed for 'regress_priv_user8'@'%'")

-----------
QUERY:
 -- does not exist


-- permissions with LOCK TABLE
CREATE USER regress_locktable_user;
RESULT:
	[]

-----------
QUERY:

CREATE TABLE lock_table (a int);
RESULT:
	[]

-----------
QUERY:


-- LOCK TABLE and SELECT permission
GRANT SELECT ON lock_table TO regress_locktable_user;
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_locktable_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_locktable_user' at line 1")

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS SHARE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS SHARE MODE' at line 1")

-----------
QUERY:
 -- should pass
COMMIT;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ROW EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ROW EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should fail
ROLLBACK;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should fail
ROLLBACK;
RESULT:
	[]

-----------
QUERY:

-- \c
REVOKE SELECT ON lock_table FROM regress_locktable_user;
RESULT:
	[]

-----------
QUERY:


-- LOCK TABLE and INSERT permission
GRANT INSERT ON lock_table TO regress_locktable_user;
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_locktable_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_locktable_user' at line 1")

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS SHARE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS SHARE MODE' at line 1")

-----------
QUERY:
 -- should pass
ROLLBACK;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ROW EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ROW EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should pass
COMMIT;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should fail
ROLLBACK;
RESULT:
	[]

-----------
QUERY:

-- \c
REVOKE INSERT ON lock_table FROM regress_locktable_user;
RESULT:
	[]

-----------
QUERY:


-- LOCK TABLE and UPDATE permission
GRANT UPDATE ON lock_table TO regress_locktable_user;
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_locktable_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_locktable_user' at line 1")

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS SHARE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS SHARE MODE' at line 1")

-----------
QUERY:
 -- should pass
ROLLBACK;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ROW EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ROW EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should pass
COMMIT;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should pass
COMMIT;
RESULT:
	[]

-----------
QUERY:

-- \c
REVOKE UPDATE ON lock_table FROM regress_locktable_user;
RESULT:
	[]

-----------
QUERY:


-- LOCK TABLE and DELETE permission
GRANT DELETE ON lock_table TO regress_locktable_user;
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_locktable_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_locktable_user' at line 1")

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS SHARE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS SHARE MODE' at line 1")

-----------
QUERY:
 -- should pass
ROLLBACK;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ROW EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ROW EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should pass
COMMIT;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should pass
COMMIT;
RESULT:
	[]

-----------
QUERY:

-- \c
REVOKE DELETE ON lock_table FROM regress_locktable_user;
RESULT:
	[]

-----------
QUERY:


-- LOCK TABLE and TRUNCATE permission
GRANT TRUNCATE ON lock_table TO regress_locktable_user;
RESULT:
	ERROR - (3619, 'Illegal privilege level specified for lock_table')

-----------
QUERY:

SET SESSION AUTHORIZATION regress_locktable_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_locktable_user' at line 1")

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS SHARE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS SHARE MODE' at line 1")

-----------
QUERY:
 -- should pass
ROLLBACK;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ROW EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ROW EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should pass
COMMIT;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should pass
COMMIT;
RESULT:
	[]

-----------
QUERY:

-- \c
REVOKE TRUNCATE ON lock_table FROM regress_locktable_user;
RESULT:
	ERROR - (3619, 'Illegal privilege level specified for lock_table')

-----------
QUERY:


-- LOCK TABLE and MAINTAIN permission
GRANT MAINTAIN ON lock_table TO regress_locktable_user;
RESULT:
	ERROR - (3619, 'Illegal privilege level specified for lock_table')

-----------
QUERY:

SET SESSION AUTHORIZATION regress_locktable_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_locktable_user' at line 1")

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS SHARE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS SHARE MODE' at line 1")

-----------
QUERY:
 -- should pass
ROLLBACK;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ROW EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ROW EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should pass
COMMIT;
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

LOCK TABLE lock_table IN ACCESS EXCLUSIVE MODE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ACCESS EXCLUSIVE MODE' at line 1")

-----------
QUERY:
 -- should pass
COMMIT;
RESULT:
	[]

-----------
QUERY:

-- \c
REVOKE MAINTAIN ON lock_table FROM regress_locktable_user;
RESULT:
	ERROR - (3619, 'Illegal privilege level specified for lock_table')

-----------
QUERY:


-- clean up
DROP TABLE lock_table;
RESULT:
	[]

-----------
QUERY:

DROP USER regress_locktable_user;
RESULT:
	[]

-----------
QUERY:


-- test to check privileges of system views pg_shmem_allocations and
-- pg_backend_memory_contexts.

-- switch to superuser
-- \c -

CREATE ROLE regress_readallstats;
RESULT:
	[]

-----------
QUERY:


SELECT has_table_privilege('regress_readallstats','pg_backend_memory_contexts','SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- no
SELECT has_table_privilege('regress_readallstats','pg_shmem_allocations','SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- no

GRANT pg_read_all_stats TO regress_readallstats;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `pg_read_all_stats`@`%`')

-----------
QUERY:


SELECT has_table_privilege('regress_readallstats','pg_backend_memory_contexts','SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- yes
SELECT has_table_privilege('regress_readallstats','pg_shmem_allocations','SELECT');
RESULT:
	ERROR - (1305, 'FUNCTION test.has_table_privilege does not exist')

-----------
QUERY:
 -- yes

-- run query to ensure that functions within views can be executed
SET ROLE regress_readallstats;
RESULT:
	ERROR - (3530, '`regress_readallstats`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

SELECT COUNT(*) >= 0 AS ok FROM pg_backend_memory_contexts;
RESULT:
	ERROR - (1146, "Table 'test.pg_backend_memory_contexts' doesn't exist")

-----------
QUERY:

SELECT COUNT(*) >= 0 AS ok FROM pg_shmem_allocations;
RESULT:
	ERROR - (1146, "Table 'test.pg_shmem_allocations' doesn't exist")

-----------
QUERY:

RESET ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ROLE' at line 1")

-----------
QUERY:


-- clean up
DROP ROLE regress_readallstats;
RESULT:
	[]

-----------
QUERY:


-- test role grantor machinery
CREATE ROLE regress_group;
RESULT:
	[]

-----------
QUERY:

CREATE ROLE regress_group_direct_manager;
RESULT:
	[]

-----------
QUERY:

CREATE ROLE regress_group_indirect_manager;
RESULT:
	[]

-----------
QUERY:

CREATE ROLE regress_group_member;
RESULT:
	[]

-----------
QUERY:


GRANT regress_group TO regress_group_direct_manager WITH INHERIT FALSE, ADMIN TRUE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INHERIT FALSE, ADMIN TRUE' at line 1")

-----------
QUERY:

GRANT regress_group_direct_manager TO regress_group_indirect_manager;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_group_direct_manager;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_group_direct_manager' at line 1")

-----------
QUERY:

GRANT regress_group TO regress_group_member;
RESULT:
	[]

-----------
QUERY:

SELECT member::regrole::text, CASE WHEN grantor = 10 THEN 'BOOTSTRAP SUPERUSER' ELSE grantor::regrole::text END FROM pg_auth_members WHERE roleid = 'regress_group'::regrole ORDER BY 1, 2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regrole::text, CASE WHEN grantor = 10 THEN 'BOOTSTRAP SUPERUSER' ELSE grantor:' at line 1")

-----------
QUERY:

REVOKE regress_group FROM regress_group_member;
RESULT:
	[]

-----------
QUERY:


SET SESSION AUTHORIZATION regress_group_indirect_manager;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_group_indirect_manager' at line 1")

-----------
QUERY:

GRANT regress_group TO regress_group_member;
RESULT:
	[]

-----------
QUERY:

SELECT member::regrole::text, CASE WHEN grantor = 10 THEN 'BOOTSTRAP SUPERUSER' ELSE grantor::regrole::text END FROM pg_auth_members WHERE roleid = 'regress_group'::regrole ORDER BY 1, 2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regrole::text, CASE WHEN grantor = 10 THEN 'BOOTSTRAP SUPERUSER' ELSE grantor:' at line 1")

-----------
QUERY:

REVOKE regress_group FROM regress_group_member;
RESULT:
	[]

-----------
QUERY:


RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 1")

-----------
QUERY:

DROP ROLE regress_group;
RESULT:
	[]

-----------
QUERY:

DROP ROLE regress_group_direct_manager;
RESULT:
	[]

-----------
QUERY:

DROP ROLE regress_group_indirect_manager;
RESULT:
	[]

-----------
QUERY:

DROP ROLE regress_group_member;
RESULT:
	[]

-----------
QUERY:


-- test SET and INHERIT options with object ownership changes
CREATE ROLE regress_roleoption_protagonist;
RESULT:
	[]

-----------
QUERY:

CREATE ROLE regress_roleoption_donor;
RESULT:
	[]

-----------
QUERY:

CREATE ROLE regress_roleoption_recipient;
RESULT:
	[]

-----------
QUERY:

CREATE SCHEMA regress_roleoption;
RESULT:
	[]

-----------
QUERY:

GRANT CREATE, USAGE ON SCHEMA regress_roleoption TO PUBLIC;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SCHEMA regress_roleoption TO PUBLIC' at line 1")

-----------
QUERY:

GRANT regress_roleoption_donor TO regress_roleoption_protagonist WITH INHERIT TRUE, SET FALSE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INHERIT TRUE, SET FALSE' at line 1")

-----------
QUERY:

GRANT regress_roleoption_recipient TO regress_roleoption_protagonist WITH INHERIT FALSE, SET TRUE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INHERIT FALSE, SET TRUE' at line 1")

-----------
QUERY:

SET SESSION AUTHORIZATION regress_roleoption_protagonist;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_roleoption_protagonist' at line 1")

-----------
QUERY:

CREATE TABLE regress_roleoption.t1 (a int);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE regress_roleoption.t2 (a int);
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_roleoption_donor;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_roleoption_donor' at line 1")

-----------
QUERY:

CREATE TABLE regress_roleoption.t3 (a int);
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_roleoption_recipient;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_roleoption_recipient' at line 1")

-----------
QUERY:

CREATE TABLE regress_roleoption.t4 (a int);
RESULT:
	[]

-----------
QUERY:

SET SESSION AUTHORIZATION regress_roleoption_protagonist;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'regress_roleoption_protagonist' at line 1")

-----------
QUERY:

ALTER TABLE regress_roleoption.t1 OWNER TO regress_roleoption_donor;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNER TO regress_roleoption_donor' at line 1")

-----------
QUERY:
 -- fails, can/* REPLACED */ ''t be come donor
ALTER TABLE regress_roleoption.t2 OWNER TO regress_roleoption_recipient;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNER TO regress_roleoption_recipient' at line 2")

-----------
QUERY:
 -- works
ALTER TABLE regress_roleoption.t3 OWNER TO regress_roleoption_protagonist;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNER TO regress_roleoption_protagonist' at line 2")

-----------
QUERY:
 -- works
ALTER TABLE regress_roleoption.t4 OWNER TO regress_roleoption_protagonist;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OWNER TO regress_roleoption_protagonist' at line 2")

-----------
QUERY:
 -- fails, we don/* REPLACED */ ''t inherit from recipient
RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 2")

-----------
QUERY:

DROP TABLE regress_roleoption.t1;
RESULT:
	[]

-----------
QUERY:

DROP TABLE regress_roleoption.t2;
RESULT:
	[]

-----------
QUERY:

DROP TABLE regress_roleoption.t3;
RESULT:
	[]

-----------
QUERY:

DROP TABLE regress_roleoption.t4;
RESULT:
	[]

-----------
QUERY:

DROP SCHEMA regress_roleoption;
RESULT:
	[]

-----------
QUERY:

DROP ROLE regress_roleoption_protagonist;
RESULT:
	[]

-----------
QUERY:

DROP ROLE regress_roleoption_donor;
RESULT:
	[]

-----------
QUERY:

DROP ROLE regress_roleoption_recipient;
RESULT:
	[]

-----------
QUERY:


-- MAINTAIN
CREATE ROLE regress_no_maintain;
RESULT:
	[]

-----------
QUERY:

CREATE ROLE regress_maintain;
RESULT:
	[]

-----------
QUERY:

CREATE ROLE regress_maintain_all IN ROLE pg_maintain;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IN ROLE pg_maintain' at line 1")

-----------
QUERY:

CREATE TABLE maintain_test (a INT);
RESULT:
	[]

-----------
QUERY:

CREATE INDEX ON maintain_test (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON maintain_test (a)' at line 1")

-----------
QUERY:

GRANT MAINTAIN ON maintain_test TO regress_maintain;
RESULT:
	ERROR - (3619, 'Illegal privilege level specified for maintain_test')

-----------
QUERY:

CREATE MATERIALIZED VIEW refresh_test AS SELECT 1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MATERIALIZED VIEW refresh_test AS SELECT 1' at line 1")

-----------
QUERY:

GRANT MAINTAIN ON refresh_test TO regress_maintain;
RESULT:
	ERROR - (3619, 'Illegal privilege level specified for refresh_test')

-----------
QUERY:

CREATE SCHEMA reindex_test;
RESULT:
	[]

-----------
QUERY:


-- negative tests /* REPLACED */ , should fail
SET ROLE regress_no_maintain;
RESULT:
	ERROR - (3530, '`regress_no_maintain`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

VACUUM maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VACUUM maintain_test' at line 1")

-----------
QUERY:

ANALYZE maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'maintain_test' at line 1")

-----------
QUERY:

VACUUM (ANALYZE) maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VACUUM (ANALYZE) maintain_test' at line 1")

-----------
QUERY:

CLUSTER maintain_test USING maintain_test_a_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CLUSTER maintain_test USING maintain_test_a_idx' at line 1")

-----------
QUERY:

REFRESH MATERIALIZED VIEW refresh_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REFRESH MATERIALIZED VIEW refresh_test' at line 1")

-----------
QUERY:

REINDEX TABLE maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX TABLE maintain_test' at line 1")

-----------
QUERY:

REINDEX INDEX maintain_test_a_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX INDEX maintain_test_a_idx' at line 1")

-----------
QUERY:

REINDEX SCHEMA reindex_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX SCHEMA reindex_test' at line 1")

-----------
QUERY:

RESET ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ROLE' at line 1")

-----------
QUERY:


SET ROLE regress_maintain;
RESULT:
	ERROR - (3530, '`regress_maintain`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

VACUUM maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VACUUM maintain_test' at line 1")

-----------
QUERY:

ANALYZE maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'maintain_test' at line 1")

-----------
QUERY:

VACUUM (ANALYZE) maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VACUUM (ANALYZE) maintain_test' at line 1")

-----------
QUERY:

CLUSTER maintain_test USING maintain_test_a_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CLUSTER maintain_test USING maintain_test_a_idx' at line 1")

-----------
QUERY:

REFRESH MATERIALIZED VIEW refresh_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REFRESH MATERIALIZED VIEW refresh_test' at line 1")

-----------
QUERY:

REINDEX TABLE maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX TABLE maintain_test' at line 1")

-----------
QUERY:

REINDEX INDEX maintain_test_a_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX INDEX maintain_test_a_idx' at line 1")

-----------
QUERY:

REINDEX SCHEMA reindex_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX SCHEMA reindex_test' at line 1")

-----------
QUERY:

RESET ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ROLE' at line 1")

-----------
QUERY:


SET ROLE regress_maintain_all;
RESULT:
	ERROR - (3530, '`regress_maintain_all`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

VACUUM maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VACUUM maintain_test' at line 1")

-----------
QUERY:

ANALYZE maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'maintain_test' at line 1")

-----------
QUERY:

VACUUM (ANALYZE) maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VACUUM (ANALYZE) maintain_test' at line 1")

-----------
QUERY:

CLUSTER maintain_test USING maintain_test_a_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CLUSTER maintain_test USING maintain_test_a_idx' at line 1")

-----------
QUERY:

REFRESH MATERIALIZED VIEW refresh_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REFRESH MATERIALIZED VIEW refresh_test' at line 1")

-----------
QUERY:

REINDEX TABLE maintain_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX TABLE maintain_test' at line 1")

-----------
QUERY:

REINDEX INDEX maintain_test_a_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX INDEX maintain_test_a_idx' at line 1")

-----------
QUERY:

REINDEX SCHEMA reindex_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX SCHEMA reindex_test' at line 1")

-----------
QUERY:

RESET ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ROLE' at line 1")

-----------
QUERY:


DROP TABLE maintain_test;
RESULT:
	[]

-----------
QUERY:

DROP MATERIALIZED VIEW refresh_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'MATERIALIZED VIEW refresh_test' at line 1")

-----------
QUERY:

DROP SCHEMA reindex_test;
RESULT:
	[]

-----------
QUERY:

DROP ROLE regress_no_maintain;
RESULT:
	[]

-----------
QUERY:

DROP ROLE regress_maintain;
RESULT:
	[]

-----------
QUERY:

DROP ROLE regress_maintain_all;
RESULT:
	ERROR - (1396, "Operation DROP ROLE failed for 'regress_maintain_all'@'%'")
