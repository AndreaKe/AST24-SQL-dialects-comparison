
-----------
QUERY:
--
-- PUBLICATION
--
CREATE ROLE regress_publication_user LOGIN SUPERUSER;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'LOGIN SUPERUSER' at line 4")

-----------
QUERY:

CREATE ROLE regress_publication_user2;
RESULT:
	ERROR - (1396, "Operation CREATE ROLE failed for 'regress_publication_user2'@'%'")

-----------
QUERY:

CREATE ROLE regress_publication_user_dummy LOGIN NOSUPERUSER;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'LOGIN NOSUPERUSER' at line 1")

-----------
QUERY:

SET SESSION AUTHORIZATION 'regress_publication_user';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''regress_publication_user'' at line 1")

-----------
QUERY:


-- suppress warning that depends on wal_level
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_default;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:


COMMENT ON PUBLICATION testpub_default IS 'test publication';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COMMENT ON PUBLICATION testpub_default IS 'test publication'' at line 1")

-----------
QUERY:

SELECT obj_description(p.oid, 'pg_publication') FROM pg_publication p;
RESULT:
	ERROR - (1146, "Table 'test.pg_publication' doesn't exist")

-----------
QUERY:


SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpib_ins_trunct WITH (publish = insert);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpib_ins_trunct WITH (publish = insert)' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:


ALTER PUBLICATION testpub_default SET (publish = update);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default SET (publish = update)' at line 1")

-----------
QUERY:


-- error cases
CREATE PUBLICATION testpub_xxx WITH (foo);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_xxx WITH (foo)' at line 2")

-----------
QUERY:

CREATE PUBLICATION testpub_xxx WITH (publish = 'cluster, vacuum');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_xxx WITH (publish = 'cluster, vacuum')' at line 1")

-----------
QUERY:

CREATE PUBLICATION testpub_xxx WITH (publish_via_partition_root = 'true', publish_via_partition_root = '0');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_xxx WITH (publish_via_partition_root = 'true', publish_via_p' at line 1")

-----------
QUERY:


-- \dRp

ALTER PUBLICATION testpub_default SET (publish = 'insert, update, delete');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default SET (publish = 'insert, update, delete')' at line 3")

-----------
QUERY:


-- \dRp

--- adding tables
CREATE SCHEMA pub_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--- adding tables\nCREATE SCHEMA pub_test' at line 3")

-----------
QUERY:

CREATE TABLE testpub_tbl1 (id serial primary key, data text);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE pub_test.testpub_nopk (foo int, bar int);
RESULT:
	ERROR - (1049, "Unknown database 'pub_test'")

-----------
QUERY:

CREATE VIEW testpub_view AS SELECT 1;
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testpub_parted (a int) PARTITION BY LIST (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:


SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_foralltables FOR ALL TABLES WITH (publish = 'insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foralltables FOR ALL TABLES WITH (publish = 'insert')' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub_foralltables SET (publish = 'insert, update');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foralltables SET (publish = 'insert, update')' at line 1")

-----------
QUERY:


CREATE TABLE testpub_tbl2 (id serial primary key, data text);
RESULT:
	[]

-----------
QUERY:

-- fail - can/* REPLACED */ ''t add to for all tables publication
ALTER PUBLICATION testpub_foralltables ADD TABLE testpub_tbl2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foralltables ADD TABLE testpub_tbl2' at line 2")

-----------
QUERY:

-- fail - can/* REPLACED */ ''t drop from all tables publication
ALTER PUBLICATION testpub_foralltables DROP TABLE testpub_tbl2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foralltables DROP TABLE testpub_tbl2' at line 2")

-----------
QUERY:

-- fail - can/* REPLACED */ ''t add to for all tables publication
ALTER PUBLICATION testpub_foralltables SET TABLE pub_test.testpub_nopk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foralltables SET TABLE pub_test.testpub_nopk' at line 2")

-----------
QUERY:


-- fail - can/* REPLACED */ ''t add schema to /* REPLACED */ ''FOR ALL TABLES/* REPLACED */ '' publication
ALTER PUBLICATION testpub_foralltables ADD TABLES IN SCHEMA pub_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foralltables ADD TABLES IN SCHEMA pub_test' at line 2")

-----------
QUERY:

-- fail - can/* REPLACED */ ''t drop schema from /* REPLACED */ ''FOR ALL TABLES/* REPLACED */ '' publication
ALTER PUBLICATION testpub_foralltables DROP TABLES IN SCHEMA pub_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foralltables DROP TABLES IN SCHEMA pub_test' at line 2")

-----------
QUERY:

-- fail - can/* REPLACED */ ''t set schema to /* REPLACED */ ''FOR ALL TABLES/* REPLACED */ '' publication
ALTER PUBLICATION testpub_foralltables SET TABLES IN SCHEMA pub_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foralltables SET TABLES IN SCHEMA pub_test' at line 2")

-----------
QUERY:


SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_fortable FOR TABLE testpub_tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable FOR TABLE testpub_tbl1' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- should be able to add schema to /* REPLACED */ ''FOR TABLE/* REPLACED */ '' publication
ALTER PUBLICATION testpub_fortable ADD TABLES IN SCHEMA pub_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable ADD TABLES IN SCHEMA pub_test' at line 2")

-----------
QUERY:

-- \dRp+ testpub_fortable
-- should be able to drop schema from /* REPLACED */ ''FOR TABLE/* REPLACED */ '' publication
ALTER PUBLICATION testpub_fortable DROP TABLES IN SCHEMA pub_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable DROP TABLES IN SCHEMA pub_test' at line 3")

-----------
QUERY:

-- \dRp+ testpub_fortable
-- should be able to set schema to /* REPLACED */ ''FOR TABLE/* REPLACED */ '' publication
ALTER PUBLICATION testpub_fortable SET TABLES IN SCHEMA pub_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable SET TABLES IN SCHEMA pub_test' at line 3")

-----------
QUERY:

-- \dRp+ testpub_fortable

SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_forschema FOR TABLES IN SCHEMA pub_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema FOR TABLES IN SCHEMA pub_test' at line 1")

-----------
QUERY:

-- should be able to create publication with schema and table of the same
-- schema
CREATE PUBLICATION testpub_for_tbl_schema FOR TABLES IN SCHEMA pub_test, TABLE pub_test.testpub_nopk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_for_tbl_schema FOR TABLES IN SCHEMA pub_test, TABLE pub_test' at line 3")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- \dRp+ testpub_for_tbl_schema

-- weird parser corner case
CREATE PUBLICATION testpub_parsertst FOR TABLE pub_test.testpub_nopk, CURRENT_SCHEMA;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_parsertst FOR TABLE pub_test.testpub_nopk, CURRENT_SCHEMA' at line 4")

-----------
QUERY:

CREATE PUBLICATION testpub_parsertst FOR TABLES IN SCHEMA foo, test.foo;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_parsertst FOR TABLES IN SCHEMA foo, test.foo' at line 1")

-----------
QUERY:


-- should be able to add a table of the same schema to the schema publication
ALTER PUBLICATION testpub_forschema ADD TABLE pub_test.testpub_nopk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema ADD TABLE pub_test.testpub_nopk' at line 2")

-----------
QUERY:

-- \dRp+ testpub_forschema

-- should be able to drop the table
ALTER PUBLICATION testpub_forschema DROP TABLE pub_test.testpub_nopk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema DROP TABLE pub_test.testpub_nopk' at line 4")

-----------
QUERY:

-- \dRp+ testpub_forschema

-- fail - can/* REPLACED */ ''t drop a table from the schema publication which isn/* REPLACED */ ''t in the
-- publication
ALTER PUBLICATION testpub_forschema DROP TABLE pub_test.testpub_nopk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema DROP TABLE pub_test.testpub_nopk' at line 5")

-----------
QUERY:

-- should be able to set table to schema publication
ALTER PUBLICATION testpub_forschema SET TABLE pub_test.testpub_nopk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema SET TABLE pub_test.testpub_nopk' at line 2")

-----------
QUERY:

-- \dRp+ testpub_forschema

SELECT pubname, puballtables FROM pg_publication WHERE pubname = 'testpub_foralltables';
RESULT:
	ERROR - (1146, "Table 'test.pg_publication' doesn't exist")

-----------
QUERY:

-- \d+ testpub_tbl2
-- \dRp+ testpub_foralltables

DROP TABLE testpub_tbl2;
RESULT:
	[]

-----------
QUERY:

DROP PUBLICATION testpub_foralltables, testpub_fortable, testpub_forschema, testpub_for_tbl_schema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foralltables, testpub_fortable, testpub_forschema, testpub_f' at line 1")

-----------
QUERY:


CREATE TABLE testpub_tbl3 (a int);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testpub_tbl3a (b text) INHERITS (testpub_tbl3);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INHERITS (testpub_tbl3)' at line 1")

-----------
QUERY:

SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub3 FOR TABLE testpub_tbl3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub3 FOR TABLE testpub_tbl3' at line 1")

-----------
QUERY:

CREATE PUBLICATION testpub4 FOR TABLE ONLY testpub_tbl3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub4 FOR TABLE ONLY testpub_tbl3' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- \dRp+ testpub3
-- \dRp+ testpub4

DROP TABLE testpub_tbl3, testpub_tbl3a;
RESULT:
	ERROR - (1051, "Unknown table 'test.testpub_tbl3a'")

-----------
QUERY:

DROP PUBLICATION testpub3, testpub4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub3, testpub4' at line 1")

-----------
QUERY:


-- Tests for partitioned tables
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_forparted;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forparted' at line 1")

-----------
QUERY:

CREATE PUBLICATION testpub_forparted1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forparted1' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

CREATE TABLE testpub_parted1 (LIKE testpub_parted);
RESULT:
	ERROR - (1146, "Table 'test.testpub_parted' doesn't exist")

-----------
QUERY:

CREATE TABLE testpub_parted2 (LIKE testpub_parted);
RESULT:
	ERROR - (1146, "Table 'test.testpub_parted' doesn't exist")

-----------
QUERY:

ALTER PUBLICATION testpub_forparted1 SET (publish='insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forparted1 SET (publish='insert')' at line 1")

-----------
QUERY:

ALTER TABLE testpub_parted ATTACH PARTITION testpub_parted1 FOR VALUES IN (1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ATTACH PARTITION testpub_parted1 FOR VALUES IN (1)' at line 1")

-----------
QUERY:

ALTER TABLE testpub_parted ATTACH PARTITION testpub_parted2 FOR VALUES IN (2);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ATTACH PARTITION testpub_parted2 FOR VALUES IN (2)' at line 1")

-----------
QUERY:

-- works despite missing REPLICA IDENTITY, because updates are not replicated
UPDATE testpub_parted1 SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.testpub_parted1' doesn't exist")

-----------
QUERY:

-- only parent is listed as being in publication, not the partition
ALTER PUBLICATION testpub_forparted ADD TABLE testpub_parted;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forparted ADD TABLE testpub_parted' at line 2")

-----------
QUERY:

-- \dRp+ testpub_forparted
-- works despite missing REPLICA IDENTITY, because no actual update happened
UPDATE testpub_parted SET a = 1 WHERE false;
RESULT:
	ERROR - (1146, "Table 'test.testpub_parted' doesn't exist")

-----------
QUERY:

-- should now fail, because parent/* REPLACED */ ''s publication replicates updates
UPDATE testpub_parted1 SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.testpub_parted1' doesn't exist")

-----------
QUERY:

ALTER TABLE testpub_parted DETACH PARTITION testpub_parted1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DETACH PARTITION testpub_parted1' at line 1")

-----------
QUERY:

-- works again, because parent/* REPLACED */ ''s publication is no longer considered
UPDATE testpub_parted1 SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.testpub_parted1' doesn't exist")

-----------
QUERY:

ALTER PUBLICATION testpub_forparted SET (publish_via_partition_root = true);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forparted SET (publish_via_partition_root = true)' at line 1")

-----------
QUERY:

-- \dRp+ testpub_forparted
-- still fail, because parent/* REPLACED */ ''s publication replicates updates
UPDATE testpub_parted2 SET a = 2;
RESULT:
	ERROR - (1146, "Table 'test.testpub_parted2' doesn't exist")

-----------
QUERY:

ALTER PUBLICATION testpub_forparted DROP TABLE testpub_parted;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forparted DROP TABLE testpub_parted' at line 1")

-----------
QUERY:

-- works again, because update is no longer replicated
UPDATE testpub_parted2 SET a = 2;
RESULT:
	ERROR - (1146, "Table 'test.testpub_parted2' doesn't exist")

-----------
QUERY:

DROP TABLE testpub_parted1, testpub_parted2;
RESULT:
	ERROR - (1051, "Unknown table 'test.testpub_parted1,test.testpub_parted2'")

-----------
QUERY:

DROP PUBLICATION testpub_forparted, testpub_forparted1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forparted, testpub_forparted1' at line 1")

-----------
QUERY:


-- Tests for row filters
CREATE TABLE testpub_rf_tbl1 (a integer, b text);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testpub_rf_tbl2 (c text, d integer);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testpub_rf_tbl3 (e integer);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testpub_rf_tbl4 (g text);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testpub_rf_tbl5 (a xml);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'xml)' at line 1")

-----------
QUERY:

CREATE SCHEMA testpub_rf_schema1;
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testpub_rf_schema1.testpub_rf_tbl5 (h integer);
RESULT:
	[]

-----------
QUERY:

CREATE SCHEMA testpub_rf_schema2;
RESULT:
	[]

-----------
QUERY:

CREATE TABLE testpub_rf_schema2.testpub_rf_tbl6 (i integer);
RESULT:
	[]

-----------
QUERY:

SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

-- Firstly, test using the option publish=/* REPLACED */ ''insert/* REPLACED */ '' because the row filter
-- validation of referenced columns is less strict than for delete/update.
CREATE PUBLICATION testpub5 FOR TABLE testpub_rf_tbl1, testpub_rf_tbl2 WHERE (c <> 'test' AND d < 5) WITH (publish = 'insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 FOR TABLE testpub_rf_tbl1, testpub_rf_tbl2 WHERE (c <> 'tes' at line 3")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- \dRp+ testpub5
-- \d testpub_rf_tbl3
ALTER PUBLICATION testpub5 ADD TABLE testpub_rf_tbl3 WHERE (e > 1000 AND e < 2000);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 ADD TABLE testpub_rf_tbl3 WHERE (e > 1000 AND e < 2000)' at line 3")

-----------
QUERY:

-- \dRp+ testpub5
-- \d testpub_rf_tbl3
ALTER PUBLICATION testpub5 DROP TABLE testpub_rf_tbl2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 DROP TABLE testpub_rf_tbl2' at line 3")

-----------
QUERY:

-- \dRp+ testpub5
-- remove testpub_rf_tbl1 and add testpub_rf_tbl3 again (another WHERE expression)
ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl3 WHERE (e > 300 AND e < 500);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl3 WHERE (e > 300 AND e < 500)' at line 3")

-----------
QUERY:

-- \dRp+ testpub5
-- \d testpub_rf_tbl3
-- test \d <tablename> (now it displays filter information)
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_rf_yes FOR TABLE testpub_rf_tbl1 WHERE (a > 1) WITH (publish = 'insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_rf_yes FOR TABLE testpub_rf_tbl1 WHERE (a > 1) WITH (publish' at line 1")

-----------
QUERY:

CREATE PUBLICATION testpub_rf_no FOR TABLE testpub_rf_tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_rf_no FOR TABLE testpub_rf_tbl1' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- \d testpub_rf_tbl1
DROP PUBLICATION testpub_rf_yes, testpub_rf_no;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_rf_yes, testpub_rf_no' at line 2")

-----------
QUERY:

-- some more syntax tests to exercise other parser pathways
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_syntax1 FOR TABLE testpub_rf_tbl1, ONLY testpub_rf_tbl3 WHERE (e < 999) WITH (publish = 'insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_syntax1 FOR TABLE testpub_rf_tbl1, ONLY testpub_rf_tbl3 WHER' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- \dRp+ testpub_syntax1
DROP PUBLICATION testpub_syntax1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_syntax1' at line 2")

-----------
QUERY:

SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_syntax2 FOR TABLE testpub_rf_tbl1, testpub_rf_schema1.testpub_rf_tbl5 WHERE (h < 999) WITH (publish = 'insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_syntax2 FOR TABLE testpub_rf_tbl1, testpub_rf_schema1.testpu' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- \dRp+ testpub_syntax2
DROP PUBLICATION testpub_syntax2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_syntax2' at line 2")

-----------
QUERY:

-- fail - schemas don/* REPLACED */ ''t allow WHERE clause
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_syntax3 FOR TABLES IN SCHEMA testpub_rf_schema1 WHERE (a = 123);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_syntax3 FOR TABLES IN SCHEMA testpub_rf_schema1 WHERE (a = 1' at line 1")

-----------
QUERY:

CREATE PUBLICATION testpub_syntax3 FOR TABLES IN SCHEMA testpub_rf_schema1, testpub_rf_schema1 WHERE (a = 123);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_syntax3 FOR TABLES IN SCHEMA testpub_rf_schema1, testpub_rf_' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- fail - duplicate tables are not allowed if that table has any WHERE clause
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_dups FOR TABLE testpub_rf_tbl1 WHERE (a = 1), testpub_rf_tbl1 WITH (publish = 'insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_dups FOR TABLE testpub_rf_tbl1 WHERE (a = 1), testpub_rf_tbl' at line 1")

-----------
QUERY:

CREATE PUBLICATION testpub_dups FOR TABLE testpub_rf_tbl1, testpub_rf_tbl1 WHERE (a = 2) WITH (publish = 'insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_dups FOR TABLE testpub_rf_tbl1, testpub_rf_tbl1 WHERE (a = 2' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- fail - publication WHERE clause must be boolean
ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl3 WHERE (1234);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl3 WHERE (1234)' at line 2")

-----------
QUERY:

-- fail - aggregate functions not allowed in WHERE clause
ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl3 WHERE (e < AVG(e));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl3 WHERE (e < AVG(e))' at line 2")

-----------
QUERY:

-- fail - user-defined operators are not allowed
CREATE FUNCTION testpub_rf_func1(integer, integer) RETURNS boolean AS $$ SELECT hashint4($1) > $2 $$ LANGUAGE SQL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'integer, integer) RETURNS boolean AS $$ SELECT hashint4($1) > $2 $$ LANGUAGE SQL' at line 2")

-----------
QUERY:

CREATE OPERATOR =#> (PROCEDURE = testpub_rf_func1, LEFTARG = integer, RIGHTARG = integer);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPERATOR =#> (PROCEDURE = testpub_rf_func1, LEFTARG = integer, RIGHTARG = intege' at line 1")

-----------
QUERY:

CREATE PUBLICATION testpub6 FOR TABLE testpub_rf_tbl3 WHERE (e =#> 27);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 FOR TABLE testpub_rf_tbl3 WHERE (e =#> 27)' at line 1")

-----------
QUERY:

-- fail - user-defined functions are not allowed
CREATE FUNCTION testpub_rf_func2() RETURNS integer AS $$ BEGIN RETURN 123; END; $$ LANGUAGE plpgsql;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS $$ BEGIN RETURN 123; END; $$ LANGUAGE plpgsql' at line 2")

-----------
QUERY:

ALTER PUBLICATION testpub5 ADD TABLE testpub_rf_tbl1 WHERE (a >= testpub_rf_func2());
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 ADD TABLE testpub_rf_tbl1 WHERE (a >= testpub_rf_func2())' at line 1")

-----------
QUERY:

-- fail - non-immutable functions are not allowed. random() is volatile.
ALTER PUBLICATION testpub5 ADD TABLE testpub_rf_tbl1 WHERE (a < random());
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 ADD TABLE testpub_rf_tbl1 WHERE (a < random())' at line 2")

-----------
QUERY:

-- fail - user-defined collations are not allowed
CREATE COLLATION user_collation FROM "C";
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'COLLATION user_collation FROM "C"\' at line 2')

-----------
QUERY:

ALTER PUBLICATION testpub5 ADD TABLE testpub_rf_tbl1 WHERE (b < '2' COLLATE user_collation);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 ADD TABLE testpub_rf_tbl1 WHERE (b < '2' COLLATE user_colla' at line 1")

-----------
QUERY:

-- ok - NULLIF is allowed
ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (NULLIF(1,2) = a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (NULLIF(1,2) = a)' at line 2")

-----------
QUERY:

-- ok - built-in operators are allowed
ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (a IS NULL);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (a IS NULL)' at line 2")

-----------
QUERY:

ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE ((a > 5) IS FALSE);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE ((a > 5) IS FALSE)' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (a IS DISTINCT FROM 5);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (a IS DISTINCT FROM 5)' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE ((a, a + 1) < (2, 3));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE ((a, a + 1) < (2, 3))' at line 1")

-----------
QUERY:

-- ok - built-in type coercions between two binary compatible datatypes are allowed
ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (b::varchar < '2');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (b::varchar < '2')' at line 2")

-----------
QUERY:

-- ok - immutable built-in functions are allowed
ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl4 WHERE (length(g) < 6);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl4 WHERE (length(g) < 6)' at line 2")

-----------
QUERY:

-- fail - user-defined types are not allowed
CREATE TYPE rf_bug_status AS ENUM ('new', 'open', 'closed');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE rf_bug_status AS ENUM ('new', 'open', 'closed')' at line 2")

-----------
QUERY:

CREATE TABLE rf_bug (id serial, description text, status rf_bug_status);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'rf_bug_status)' at line 1")

-----------
QUERY:

CREATE PUBLICATION testpub6 FOR TABLE rf_bug WHERE (status = 'open') WITH (publish = 'insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 FOR TABLE rf_bug WHERE (status = 'open') WITH (publish = 'i' at line 1")

-----------
QUERY:

DROP TABLE rf_bug;
RESULT:
	ERROR - (1051, "Unknown table 'test.rf_bug'")

-----------
QUERY:

DROP TYPE rf_bug_status;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TYPE rf_bug_status' at line 1")

-----------
QUERY:

-- fail - row filter expression is not simple
CREATE PUBLICATION testpub6 FOR TABLE testpub_rf_tbl1 WHERE (a IN (SELECT generate_series(1,5)));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 FOR TABLE testpub_rf_tbl1 WHERE (a IN (SELECT generate_seri' at line 2")

-----------
QUERY:

-- fail - system columns are not allowed
CREATE PUBLICATION testpub6 FOR TABLE testpub_rf_tbl1 WHERE ('(0,1)'::tid = ctid);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 FOR TABLE testpub_rf_tbl1 WHERE ('(0,1)'::tid = ctid)' at line 2")

-----------
QUERY:

-- ok - conditional expressions are allowed
ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl5 WHERE (a IS DOCUMENT);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl5 WHERE (a IS DOCUMENT)' at line 2")

-----------
QUERY:

ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl5 WHERE (xmlexists('//foo[text() = ''bar'']' PASSING BY VALUE a));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl5 WHERE (xmlexists('//foo[text() = ' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (NULLIF(1, 2) = a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (NULLIF(1, 2) = a)' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (CASE a WHEN 5 THEN true ELSE false END);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (CASE a WHEN 5 THEN true EL' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (COALESCE(b, 'foo') = 'foo');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (COALESCE(b, 'foo') = 'foo'' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (GREATEST(a, 10) > 10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (GREATEST(a, 10) > 10)' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (a IN (2, 4, 6));
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (a IN (2, 4, 6))' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (ARRAY[a] <@ ARRAY[2, 4, 6]);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (ARRAY[a] <@ ARRAY[2, 4, 6]' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (ROW(a, 2) IS NULL);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 SET TABLE testpub_rf_tbl1 WHERE (ROW(a, 2) IS NULL)' at line 1")

-----------
QUERY:

-- fail - WHERE not allowed in DROP
ALTER PUBLICATION testpub5 DROP TABLE testpub_rf_tbl1 WHERE (e < 27);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5 DROP TABLE testpub_rf_tbl1 WHERE (e < 27)' at line 2")

-----------
QUERY:

-- fail - cannot ALTER SET table which is a member of a pre-existing schema
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub6 FOR TABLES IN SCHEMA testpub_rf_schema2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 FOR TABLES IN SCHEMA testpub_rf_schema2' at line 1")

-----------
QUERY:

-- should be able to set publication with schema and table of the same schema
ALTER PUBLICATION testpub6 SET TABLES IN SCHEMA testpub_rf_schema2, TABLE testpub_rf_schema2.testpub_rf_tbl6 WHERE (i < 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLES IN SCHEMA testpub_rf_schema2, TABLE testpub_rf_s' at line 2")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- \dRp+ testpub6

DROP TABLE testpub_rf_tbl1;
RESULT:
	[]

-----------
QUERY:

DROP TABLE testpub_rf_tbl2;
RESULT:
	[]

-----------
QUERY:

DROP TABLE testpub_rf_tbl3;
RESULT:
	[]

-----------
QUERY:

DROP TABLE testpub_rf_tbl4;
RESULT:
	[]

-----------
QUERY:

DROP TABLE testpub_rf_tbl5;
RESULT:
	ERROR - (1051, "Unknown table 'test.testpub_rf_tbl5'")

-----------
QUERY:

DROP TABLE testpub_rf_schema1.testpub_rf_tbl5;
RESULT:
	[]

-----------
QUERY:

DROP TABLE testpub_rf_schema2.testpub_rf_tbl6;
RESULT:
	[]

-----------
QUERY:

DROP SCHEMA testpub_rf_schema1;
RESULT:
	[]

-----------
QUERY:

DROP SCHEMA testpub_rf_schema2;
RESULT:
	[]

-----------
QUERY:

DROP PUBLICATION testpub5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub5' at line 1")

-----------
QUERY:

DROP PUBLICATION testpub6;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6' at line 1")

-----------
QUERY:

DROP OPERATOR =#>(integer, integer);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OPERATOR =#>(integer, integer)' at line 1")

-----------
QUERY:

DROP FUNCTION testpub_rf_func1(integer, integer);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(integer, integer)' at line 1")

-----------
QUERY:

DROP FUNCTION testpub_rf_func2();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:

DROP COLLATION user_collation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COLLATION user_collation' at line 1")

-----------
QUERY:


-- ======================================================
-- More row filter tests for validating column references
CREATE TABLE rf_tbl_abcd_nopk(a int, b int, c int, d int);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE rf_tbl_abcd_pk(a int, b int, c int, d int, PRIMARY KEY(a,b));
RESULT:
	[]

-----------
QUERY:

CREATE TABLE rf_tbl_abcd_part_pk (a int PRIMARY KEY, b int) PARTITION by RANGE (a);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE rf_tbl_abcd_part_pk_1 (b int, a int PRIMARY KEY);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_part_pk ATTACH PARTITION rf_tbl_abcd_part_pk_1 FOR VALUES FROM (1) TO (10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ATTACH PARTITION rf_tbl_abcd_part_pk_1 FOR VALUES FROM (1) TO (10)' at line 1")

-----------
QUERY:


-- Case 1. REPLICA IDENTITY DEFAULT (means use primary key or nothing)
-- 1a. REPLICA IDENTITY is DEFAULT and table has a PK.
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub6 FOR TABLE rf_tbl_abcd_pk WHERE (a > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 FOR TABLE rf_tbl_abcd_pk WHERE (a > 99)' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- ok - /* REPLACED */ ''a/* REPLACED */ '' is a PK col
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (b > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (b > 99)' at line 1")

-----------
QUERY:

-- ok - /* REPLACED */ ''b/* REPLACED */ '' is a PK col
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (c > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (c > 99)' at line 1")

-----------
QUERY:

-- fail - /* REPLACED */ ''c/* REPLACED */ '' is not part of the PK
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (d > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (d > 99)' at line 1")

-----------
QUERY:

-- fail - /* REPLACED */ ''d/* REPLACED */ '' is not part of the PK
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

-- 1b. REPLICA IDENTITY is DEFAULT and table has no PK
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk WHERE (a > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk WHERE (a > 99)' at line 2")

-----------
QUERY:

-- fail - /* REPLACED */ ''a/* REPLACED */ '' is not part of REPLICA IDENTITY
UPDATE rf_tbl_abcd_nopk SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- Case 2. REPLICA IDENTITY FULL
ALTER TABLE rf_tbl_abcd_pk REPLICA IDENTITY FULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY FULL' at line 2")

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_nopk REPLICA IDENTITY FULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY FULL' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (c > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (c > 99)' at line 1")

-----------
QUERY:

-- ok - /* REPLACED */ ''c/* REPLACED */ '' is in REPLICA IDENTITY now even though not in PK
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk WHERE (a > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk WHERE (a > 99)' at line 1")

-----------
QUERY:

-- ok - /* REPLACED */ ''a/* REPLACED */ '' is in REPLICA IDENTITY now
UPDATE rf_tbl_abcd_nopk SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- Case 3. REPLICA IDENTITY NOTHING
ALTER TABLE rf_tbl_abcd_pk REPLICA IDENTITY NOTHING;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY NOTHING' at line 2")

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_nopk REPLICA IDENTITY NOTHING;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY NOTHING' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (a > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (a > 99)' at line 1")

-----------
QUERY:

-- fail - /* REPLACED */ ''a/* REPLACED */ '' is in PK but it is not part of REPLICA IDENTITY NOTHING
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (c > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (c > 99)' at line 1")

-----------
QUERY:

-- fail - /* REPLACED */ ''c/* REPLACED */ '' is not in PK and not in REPLICA IDENTITY NOTHING
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk WHERE (a > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk WHERE (a > 99)' at line 1")

-----------
QUERY:

-- fail - /* REPLACED */ ''a/* REPLACED */ '' is not in REPLICA IDENTITY NOTHING
UPDATE rf_tbl_abcd_nopk SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- Case 4. REPLICA IDENTITY INDEX
ALTER TABLE rf_tbl_abcd_pk ALTER COLUMN c SET NOT NULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NOT NULL' at line 2")

-----------
QUERY:

CREATE UNIQUE INDEX idx_abcd_pk_c ON rf_tbl_abcd_pk(c);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_pk REPLICA IDENTITY USING INDEX idx_abcd_pk_c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX idx_abcd_pk_c' at line 1")

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_nopk ALTER COLUMN c SET NOT NULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NOT NULL' at line 1")

-----------
QUERY:

CREATE UNIQUE INDEX idx_abcd_nopk_c ON rf_tbl_abcd_nopk(c);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_nopk REPLICA IDENTITY USING INDEX idx_abcd_nopk_c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX idx_abcd_nopk_c' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (a > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (a > 99)' at line 1")

-----------
QUERY:

-- fail - /* REPLACED */ ''a/* REPLACED */ '' is in PK but it is not part of REPLICA IDENTITY INDEX
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (c > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk WHERE (c > 99)' at line 1")

-----------
QUERY:

-- ok - /* REPLACED */ ''c/* REPLACED */ '' is not in PK but it is part of REPLICA IDENTITY INDEX
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk WHERE (a > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk WHERE (a > 99)' at line 1")

-----------
QUERY:

-- fail - /* REPLACED */ ''a/* REPLACED */ '' is not in REPLICA IDENTITY INDEX
UPDATE rf_tbl_abcd_nopk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk WHERE (c > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk WHERE (c > 99)' at line 1")

-----------
QUERY:

-- ok - /* REPLACED */ ''c/* REPLACED */ '' is part of REPLICA IDENTITY INDEX
UPDATE rf_tbl_abcd_nopk SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- Tests for partitioned table

-- set PUBLISH_VIA_PARTITION_ROOT to false and test row filter for partitioned
-- table
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0)' at line 5")

-----------
QUERY:

-- fail - cannot use row filter for partitioned table
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk WHERE (a > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk WHERE (a > 99)' at line 2")

-----------
QUERY:

-- ok - can use row filter for partition
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk_1 WHERE (a > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk_1 WHERE (a > 99)' at line 2")

-----------
QUERY:

-- ok - /* REPLACED */ ''a/* REPLACED */ '' is a PK col
UPDATE rf_tbl_abcd_part_pk SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.rf_tbl_abcd_part_pk' doesn't exist")

-----------
QUERY:

-- set PUBLISH_VIA_PARTITION_ROOT to true and test row filter for partitioned
-- table
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=1)' at line 3")

-----------
QUERY:

-- ok - can use row filter for partitioned table
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk WHERE (a > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk WHERE (a > 99)' at line 2")

-----------
QUERY:

-- ok - /* REPLACED */ ''a/* REPLACED */ '' is a PK col
UPDATE rf_tbl_abcd_part_pk SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.rf_tbl_abcd_part_pk' doesn't exist")

-----------
QUERY:

-- fail - cannot set PUBLISH_VIA_PARTITION_ROOT to false if any row filter is
-- used for partitioned table
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0)' at line 3")

-----------
QUERY:

-- remove partitioned table/* REPLACED */ ''s row filter
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk' at line 2")

-----------
QUERY:

-- ok - we don/* REPLACED */ ''t have row filter for partitioned table.
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0)' at line 2")

-----------
QUERY:

-- Now change the root filter to use a column /* REPLACED */ ''b/* REPLACED */ ''
-- (which is not in the replica identity)
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk_1 WHERE (b > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk_1 WHERE (b > 99)' at line 3")

-----------
QUERY:

-- ok - we don/* REPLACED */ ''t have row filter for partitioned table.
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0)' at line 2")

-----------
QUERY:

-- fail - /* REPLACED */ ''b/* REPLACED */ '' is not in REPLICA IDENTITY INDEX
UPDATE rf_tbl_abcd_part_pk SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.rf_tbl_abcd_part_pk' doesn't exist")

-----------
QUERY:

-- set PUBLISH_VIA_PARTITION_ROOT to true
-- can use row filter for partitioned table
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=1)' at line 3")

-----------
QUERY:

-- ok - can use row filter for partitioned table
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk WHERE (b > 99);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk WHERE (b > 99)' at line 2")

-----------
QUERY:

-- fail - /* REPLACED */ ''b/* REPLACED */ '' is not in REPLICA IDENTITY INDEX
UPDATE rf_tbl_abcd_part_pk SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.rf_tbl_abcd_part_pk' doesn't exist")

-----------
QUERY:


DROP PUBLICATION testpub6;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6' at line 1")

-----------
QUERY:

DROP TABLE rf_tbl_abcd_pk;
RESULT:
	[]

-----------
QUERY:

DROP TABLE rf_tbl_abcd_nopk;
RESULT:
	[]

-----------
QUERY:

DROP TABLE rf_tbl_abcd_part_pk;
RESULT:
	ERROR - (1051, "Unknown table 'test.rf_tbl_abcd_part_pk'")

-----------
QUERY:

-- ======================================================

-- fail - duplicate tables are not allowed if that table has any column lists
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_dups FOR TABLE testpub_tbl1 (a), testpub_tbl1 WITH (publish = 'insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_dups FOR TABLE testpub_tbl1 (a), testpub_tbl1 WITH (publish ' at line 1")

-----------
QUERY:

CREATE PUBLICATION testpub_dups FOR TABLE testpub_tbl1, testpub_tbl1 (a) WITH (publish = 'insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_dups FOR TABLE testpub_tbl1, testpub_tbl1 (a) WITH (publish ' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:


-- test for column lists
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_fortable FOR TABLE testpub_tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable FOR TABLE testpub_tbl1' at line 1")

-----------
QUERY:

CREATE PUBLICATION testpub_fortable_insert WITH (publish = 'insert');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable_insert WITH (publish = 'insert')' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

CREATE TABLE testpub_tbl5 (a int PRIMARY KEY, b text, c text,
	d int generated always as (a + length(b)) stored);
RESULT:
	[]

-----------
QUERY:

-- error: column /* REPLACED */ ''x/* REPLACED */ '' does not exist
ALTER PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (a, x);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (a, x)' at line 2")

-----------
QUERY:

-- error: replica identity /* REPLACED */ ''a/* REPLACED */ '' not included in the column list
ALTER PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (b, c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (b, c)' at line 2")

-----------
QUERY:

UPDATE testpub_tbl5 SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub_fortable DROP TABLE testpub_tbl5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable DROP TABLE testpub_tbl5' at line 1")

-----------
QUERY:

-- error: generated column /* REPLACED */ ''d/* REPLACED */ '' can/* REPLACED */ ''t be in list
ALTER PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (a, d);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (a, d)' at line 2")

-----------
QUERY:

-- error: system attributes /* REPLACED */ ''ctid/* REPLACED */ '' not allowed in column list
ALTER PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (a, ctid);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (a, ctid)' at line 2")

-----------
QUERY:

-- ok
ALTER PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (a, c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (a, c)' at line 2")

-----------
QUERY:

ALTER TABLE testpub_tbl5 DROP COLUMN c;
RESULT:
	[]

-----------
QUERY:
		-- no dice
-- ok: for insert-only publication, any column list is acceptable
ALTER PUBLICATION testpub_fortable_insert ADD TABLE testpub_tbl5 (b, c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable_insert ADD TABLE testpub_tbl5 (b, c)' at line 3")

-----------
QUERY:


/* not all replica identities are good enough */
CREATE UNIQUE INDEX testpub_tbl5_b_key ON testpub_tbl5 (b, c);
RESULT:
	ERROR - (1170, "BLOB/TEXT column 'b' used in key specification without a key length")

-----------
QUERY:

ALTER TABLE testpub_tbl5 ALTER b SET NOT NULL, ALTER c SET NOT NULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NOT NULL, ALTER c SET NOT NULL' at line 1")

-----------
QUERY:

ALTER TABLE testpub_tbl5 REPLICA IDENTITY USING INDEX testpub_tbl5_b_key;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX testpub_tbl5_b_key' at line 1")

-----------
QUERY:

-- error: replica identity (b,c) is not covered by column list (a, c)
UPDATE testpub_tbl5 SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub_fortable DROP TABLE testpub_tbl5;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable DROP TABLE testpub_tbl5' at line 1")

-----------
QUERY:


-- error: change the replica identity to /* REPLACED */ ''b/* REPLACED */ '', and column list to (a, c)
-- then update fails, because (a, c) does not cover replica identity
ALTER TABLE testpub_tbl5 REPLICA IDENTITY USING INDEX testpub_tbl5_b_key;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX testpub_tbl5_b_key' at line 3")

-----------
QUERY:

ALTER PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (a, c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable ADD TABLE testpub_tbl5 (a, c)' at line 1")

-----------
QUERY:

UPDATE testpub_tbl5 SET a = 1;
RESULT:
	[]

-----------
QUERY:


/* But if upd/del are not published, it works OK */
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_table_ins WITH (publish = 'insert, truncate');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_table_ins WITH (publish = 'insert, truncate')' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub_table_ins ADD TABLE testpub_tbl5 (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_table_ins ADD TABLE testpub_tbl5 (a)' at line 1")

-----------
QUERY:
		-- ok
-- \dRp+ testpub_table_ins

-- error: cannot work with deferrable primary keys
CREATE TABLE testpub_tbl5d (a int PRIMARY KEY DEFERRABLE);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFERRABLE)' at line 5")

-----------
QUERY:

ALTER PUBLICATION testpub_fortable ADD TABLE testpub_tbl5d;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable ADD TABLE testpub_tbl5d' at line 1")

-----------
QUERY:

UPDATE testpub_tbl5d SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.testpub_tbl5d' doesn't exist")

-----------
QUERY:

/* but works fine with FULL replica identity */
ALTER TABLE testpub_tbl5d REPLICA IDENTITY FULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY FULL' at line 2")

-----------
QUERY:

UPDATE testpub_tbl5d SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.testpub_tbl5d' doesn't exist")

-----------
QUERY:

DROP TABLE testpub_tbl5d;
RESULT:
	ERROR - (1051, "Unknown table 'test.testpub_tbl5d'")

-----------
QUERY:


-- tests with REPLICA IDENTITY FULL
CREATE TABLE testpub_tbl6 (a int, b text, c text);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE testpub_tbl6 REPLICA IDENTITY FULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY FULL' at line 1")

-----------
QUERY:


ALTER PUBLICATION testpub_fortable ADD TABLE testpub_tbl6 (a, b, c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable ADD TABLE testpub_tbl6 (a, b, c)' at line 1")

-----------
QUERY:

UPDATE testpub_tbl6 SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub_fortable DROP TABLE testpub_tbl6;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable DROP TABLE testpub_tbl6' at line 1")

-----------
QUERY:


ALTER PUBLICATION testpub_fortable ADD TABLE testpub_tbl6;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable ADD TABLE testpub_tbl6' at line 1")

-----------
QUERY:
 -- ok
UPDATE testpub_tbl6 SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- make sure changing the column list is propagated to the catalog
CREATE TABLE testpub_tbl7 (a int primary key, b text, c text);
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub_fortable ADD TABLE testpub_tbl7 (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable ADD TABLE testpub_tbl7 (a, b)' at line 1")

-----------
QUERY:

-- \d+ testpub_tbl7
-- ok: the column list is the same, we should skip this table (or at least not fail)
ALTER PUBLICATION testpub_fortable SET TABLE testpub_tbl7 (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable SET TABLE testpub_tbl7 (a, b)' at line 3")

-----------
QUERY:

-- \d+ testpub_tbl7
-- ok: the column list changes, make sure the catalog gets updated
ALTER PUBLICATION testpub_fortable SET TABLE testpub_tbl7 (a, c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable SET TABLE testpub_tbl7 (a, c)' at line 3")

-----------
QUERY:

-- \d+ testpub_tbl7

-- column list for partitioned tables has to cover replica identities for
-- all child relations
CREATE TABLE testpub_tbl8 (a int, b text, c text) PARTITION BY HASH (a);
RESULT:
	[]

-----------
QUERY:

-- first partition has replica identity /* REPLACED */ ''a/* REPLACED */ ''
CREATE TABLE testpub_tbl8_0 PARTITION OF testpub_tbl8 FOR VALUES WITH (modulus 2, remainder 0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF testpub_tbl8 FOR VALUES WITH (modulus 2, remainder 0)' at line 2")

-----------
QUERY:

ALTER TABLE testpub_tbl8_0 ADD PRIMARY KEY (a);
RESULT:
	ERROR - (1146, "Table 'test.testpub_tbl8_0' doesn't exist")

-----------
QUERY:

ALTER TABLE testpub_tbl8_0 REPLICA IDENTITY USING INDEX testpub_tbl8_0_pkey;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX testpub_tbl8_0_pkey' at line 1")

-----------
QUERY:

-- second partition has replica identity /* REPLACED */ ''b/* REPLACED */ ''
CREATE TABLE testpub_tbl8_1 PARTITION OF testpub_tbl8 FOR VALUES WITH (modulus 2, remainder 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF testpub_tbl8 FOR VALUES WITH (modulus 2, remainder 1)' at line 2")

-----------
QUERY:

ALTER TABLE testpub_tbl8_1 ADD PRIMARY KEY (b);
RESULT:
	ERROR - (1146, "Table 'test.testpub_tbl8_1' doesn't exist")

-----------
QUERY:

ALTER TABLE testpub_tbl8_1 REPLICA IDENTITY USING INDEX testpub_tbl8_1_pkey;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX testpub_tbl8_1_pkey' at line 1")

-----------
QUERY:


-- ok: column list covers both /* REPLACED */ ''a/* REPLACED */ '' and /* REPLACED */ ''b/* REPLACED */ ''
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_col_list FOR TABLE testpub_tbl8 (a, b) WITH (publish_via_partition_root = 'true');
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_col_list FOR TABLE testpub_tbl8 (a, b) WITH (publish_via_par' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:


-- ok: the same thing, but try plain ADD TABLE
ALTER PUBLICATION testpub_col_list DROP TABLE testpub_tbl8;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_col_list DROP TABLE testpub_tbl8' at line 2")

-----------
QUERY:

ALTER PUBLICATION testpub_col_list ADD TABLE testpub_tbl8 (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_col_list ADD TABLE testpub_tbl8 (a, b)' at line 1")

-----------
QUERY:

UPDATE testpub_tbl8 SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- failure: column list does not cover replica identity for the second partition
ALTER PUBLICATION testpub_col_list DROP TABLE testpub_tbl8;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_col_list DROP TABLE testpub_tbl8' at line 2")

-----------
QUERY:

ALTER PUBLICATION testpub_col_list ADD TABLE testpub_tbl8 (a, c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_col_list ADD TABLE testpub_tbl8 (a, c)' at line 1")

-----------
QUERY:

UPDATE testpub_tbl8 SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub_col_list DROP TABLE testpub_tbl8;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_col_list DROP TABLE testpub_tbl8' at line 1")

-----------
QUERY:


-- failure: one of the partitions has REPLICA IDENTITY FULL
ALTER TABLE testpub_tbl8_1 REPLICA IDENTITY FULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY FULL' at line 2")

-----------
QUERY:

ALTER PUBLICATION testpub_col_list ADD TABLE testpub_tbl8 (a, c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_col_list ADD TABLE testpub_tbl8 (a, c)' at line 1")

-----------
QUERY:

UPDATE testpub_tbl8 SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub_col_list DROP TABLE testpub_tbl8;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_col_list DROP TABLE testpub_tbl8' at line 1")

-----------
QUERY:


-- add table and then try changing replica identity
ALTER TABLE testpub_tbl8_1 REPLICA IDENTITY USING INDEX testpub_tbl8_1_pkey;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX testpub_tbl8_1_pkey' at line 2")

-----------
QUERY:

ALTER PUBLICATION testpub_col_list ADD TABLE testpub_tbl8 (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_col_list ADD TABLE testpub_tbl8 (a, b)' at line 1")

-----------
QUERY:


-- failure: replica identity full can/* REPLACED */ ''t be used with a column list
ALTER TABLE testpub_tbl8_1 REPLICA IDENTITY FULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY FULL' at line 2")

-----------
QUERY:

UPDATE testpub_tbl8 SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- failure: replica identity has to be covered by the column list
ALTER TABLE testpub_tbl8_1 DROP CONSTRAINT testpub_tbl8_1_pkey;
RESULT:
	ERROR - (1146, "Table 'test.testpub_tbl8_1' doesn't exist")

-----------
QUERY:

ALTER TABLE testpub_tbl8_1 ADD PRIMARY KEY (c);
RESULT:
	ERROR - (1146, "Table 'test.testpub_tbl8_1' doesn't exist")

-----------
QUERY:

ALTER TABLE testpub_tbl8_1 REPLICA IDENTITY USING INDEX testpub_tbl8_1_pkey;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX testpub_tbl8_1_pkey' at line 1")

-----------
QUERY:

UPDATE testpub_tbl8 SET a = 1;
RESULT:
	[]

-----------
QUERY:


DROP TABLE testpub_tbl8;
RESULT:
	[]

-----------
QUERY:


-- column list for partitioned tables has to cover replica identities for
-- all child relations
CREATE TABLE testpub_tbl8 (a int, b text, c text) PARTITION BY HASH (a);
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub_col_list ADD TABLE testpub_tbl8 (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_col_list ADD TABLE testpub_tbl8 (a, b)' at line 1")

-----------
QUERY:

-- first partition has replica identity /* REPLACED */ ''a/* REPLACED */ ''
CREATE TABLE testpub_tbl8_0 (a int, b text, c text);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE testpub_tbl8_0 ADD PRIMARY KEY (a);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE testpub_tbl8_0 REPLICA IDENTITY USING INDEX testpub_tbl8_0_pkey;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX testpub_tbl8_0_pkey' at line 1")

-----------
QUERY:

-- second partition has replica identity /* REPLACED */ ''b/* REPLACED */ ''
CREATE TABLE testpub_tbl8_1 (a int, b text, c text);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE testpub_tbl8_1 ADD PRIMARY KEY (c);
RESULT:
	ERROR - (1170, "BLOB/TEXT column 'c' used in key specification without a key length")

-----------
QUERY:

ALTER TABLE testpub_tbl8_1 REPLICA IDENTITY USING INDEX testpub_tbl8_1_pkey;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX testpub_tbl8_1_pkey' at line 1")

-----------
QUERY:


-- ok: attaching first partition works, because (a) is in column list
ALTER TABLE testpub_tbl8 ATTACH PARTITION testpub_tbl8_0 FOR VALUES WITH (modulus 2, remainder 0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ATTACH PARTITION testpub_tbl8_0 FOR VALUES WITH (modulus 2, remainder 0)' at line 2")

-----------
QUERY:

-- failure: second partition has replica identity (c), which si not in column list
ALTER TABLE testpub_tbl8 ATTACH PARTITION testpub_tbl8_1 FOR VALUES WITH (modulus 2, remainder 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ATTACH PARTITION testpub_tbl8_1 FOR VALUES WITH (modulus 2, remainder 1)' at line 2")

-----------
QUERY:

UPDATE testpub_tbl8 SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- failure: changing replica identity to FULL for partition fails, because
-- of the column list on the parent
ALTER TABLE testpub_tbl8_0 REPLICA IDENTITY FULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY FULL' at line 3")

-----------
QUERY:

UPDATE testpub_tbl8 SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- test that using column list for table is disallowed if any schemas are
-- part of the publication
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

-- failure - cannot use column list and schema together
CREATE PUBLICATION testpub_tbl9 FOR TABLES IN SCHEMA public, TABLE public.testpub_tbl7(a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_tbl9 FOR TABLES IN SCHEMA public, TABLE public.testpub_tbl7(' at line 2")

-----------
QUERY:

-- ok - only publish schema
CREATE PUBLICATION testpub_tbl9 FOR TABLES IN SCHEMA public;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_tbl9 FOR TABLES IN SCHEMA public' at line 2")

-----------
QUERY:

-- failure - add a table with column list when there is already a schema in the
-- publication
ALTER PUBLICATION testpub_tbl9 ADD TABLE public.testpub_tbl7(a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_tbl9 ADD TABLE public.testpub_tbl7(a)' at line 3")

-----------
QUERY:

-- ok - only publish table with column list
ALTER PUBLICATION testpub_tbl9 SET TABLE public.testpub_tbl7(a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_tbl9 SET TABLE public.testpub_tbl7(a)' at line 2")

-----------
QUERY:

-- failure - specify a schema when there is already a column list in the
-- publication
ALTER PUBLICATION testpub_tbl9 ADD TABLES IN SCHEMA public;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_tbl9 ADD TABLES IN SCHEMA public' at line 3")

-----------
QUERY:

-- failure - cannot SET column list and schema together
ALTER PUBLICATION testpub_tbl9 SET TABLES IN SCHEMA public, TABLE public.testpub_tbl7(a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_tbl9 SET TABLES IN SCHEMA public, TABLE public.testpub_tbl7(' at line 2")

-----------
QUERY:

-- ok - drop table
ALTER PUBLICATION testpub_tbl9 DROP TABLE public.testpub_tbl7;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_tbl9 DROP TABLE public.testpub_tbl7' at line 2")

-----------
QUERY:

-- failure - cannot ADD column list and schema together
ALTER PUBLICATION testpub_tbl9 ADD TABLES IN SCHEMA public, TABLE public.testpub_tbl7(a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_tbl9 ADD TABLES IN SCHEMA public, TABLE public.testpub_tbl7(' at line 2")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:


DROP TABLE testpub_tbl5, testpub_tbl6, testpub_tbl7, testpub_tbl8, testpub_tbl8_1;
RESULT:
	[]

-----------
QUERY:

DROP PUBLICATION testpub_table_ins, testpub_fortable, testpub_fortable_insert, testpub_col_list, testpub_tbl9;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_table_ins, testpub_fortable, testpub_fortable_insert, testpu' at line 1")

-----------
QUERY:

-- ======================================================

-- Test combination of column list and row filter
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_both_filters;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_both_filters' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

CREATE TABLE testpub_tbl_both_filters (a int, b int, c int, PRIMARY KEY (a,c));
RESULT:
	[]

-----------
QUERY:

ALTER TABLE testpub_tbl_both_filters REPLICA IDENTITY USING INDEX testpub_tbl_both_filters_pkey;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX testpub_tbl_both_filters_pkey' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub_both_filters ADD TABLE testpub_tbl_both_filters (a,c) WHERE (c != 1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_both_filters ADD TABLE testpub_tbl_both_filters (a,c) WHERE ' at line 1")

-----------
QUERY:

-- \dRp+ testpub_both_filters
-- \d+ testpub_tbl_both_filters

DROP TABLE testpub_tbl_both_filters;
RESULT:
	[]

-----------
QUERY:

DROP PUBLICATION testpub_both_filters;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_both_filters' at line 1")

-----------
QUERY:

-- ======================================================

-- More column list tests for validating column references
CREATE TABLE rf_tbl_abcd_nopk(a int, b int, c int, d int);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE rf_tbl_abcd_pk(a int, b int, c int, d int, PRIMARY KEY(a,b));
RESULT:
	[]

-----------
QUERY:

CREATE TABLE rf_tbl_abcd_part_pk (a int PRIMARY KEY, b int) PARTITION by RANGE (a);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE rf_tbl_abcd_part_pk_1 (b int, a int PRIMARY KEY);
RESULT:
	ERROR - (1050, "Table 'rf_tbl_abcd_part_pk_1' already exists")

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_part_pk ATTACH PARTITION rf_tbl_abcd_part_pk_1 FOR VALUES FROM (1) TO (10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ATTACH PARTITION rf_tbl_abcd_part_pk_1 FOR VALUES FROM (1) TO (10)' at line 1")

-----------
QUERY:


-- Case 1. REPLICA IDENTITY DEFAULT (means use primary key or nothing)

-- 1a. REPLICA IDENTITY is DEFAULT and table has a PK.
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub6 FOR TABLE rf_tbl_abcd_pk (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 FOR TABLE rf_tbl_abcd_pk (a, b)' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- ok - (a,b) coverts all PK cols
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (a, b, c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (a, b, c)' at line 1")

-----------
QUERY:

-- ok - (a,b,c) coverts all PK cols
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (a)' at line 1")

-----------
QUERY:

-- fail - /* REPLACED */ ''b/* REPLACED */ '' is missing from the column list
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (b)' at line 1")

-----------
QUERY:

-- fail - /* REPLACED */ ''a/* REPLACED */ '' is missing from the column list
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- 1b. REPLICA IDENTITY is DEFAULT and table has no PK
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk (a)' at line 2")

-----------
QUERY:

-- ok - there/* REPLACED */ ''s no replica identity, so any column list works
-- note: it fails anyway, just a bit later because UPDATE requires RI
UPDATE rf_tbl_abcd_nopk SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- Case 2. REPLICA IDENTITY FULL
ALTER TABLE rf_tbl_abcd_pk REPLICA IDENTITY FULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY FULL' at line 2")

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_nopk REPLICA IDENTITY FULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY FULL' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (c)' at line 1")

-----------
QUERY:

-- fail - with REPLICA IDENTITY FULL no column list is allowed
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk (a, b, c, d);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk (a, b, c, d)' at line 1")

-----------
QUERY:

-- fail - with REPLICA IDENTITY FULL no column list is allowed
UPDATE rf_tbl_abcd_nopk SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- Case 3. REPLICA IDENTITY NOTHING
ALTER TABLE rf_tbl_abcd_pk REPLICA IDENTITY NOTHING;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY NOTHING' at line 2")

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_nopk REPLICA IDENTITY NOTHING;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY NOTHING' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (a)' at line 1")

-----------
QUERY:

-- ok - REPLICA IDENTITY NOTHING means all column lists are valid
-- it still fails later because without RI we can/* REPLACED */ ''t replicate updates
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (a, b, c, d);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (a, b, c, d)' at line 1")

-----------
QUERY:

-- ok - REPLICA IDENTITY NOTHING means all column lists are valid
-- it still fails later because without RI we can/* REPLACED */ ''t replicate updates
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk (d);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk (d)' at line 1")

-----------
QUERY:

-- ok - REPLICA IDENTITY NOTHING means all column lists are valid
-- it still fails later because without RI we can/* REPLACED */ ''t replicate updates
UPDATE rf_tbl_abcd_nopk SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- Case 4. REPLICA IDENTITY INDEX
ALTER TABLE rf_tbl_abcd_pk ALTER COLUMN c SET NOT NULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NOT NULL' at line 2")

-----------
QUERY:

CREATE UNIQUE INDEX idx_abcd_pk_c ON rf_tbl_abcd_pk(c);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_pk REPLICA IDENTITY USING INDEX idx_abcd_pk_c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX idx_abcd_pk_c' at line 1")

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_nopk ALTER COLUMN c SET NOT NULL;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NOT NULL' at line 1")

-----------
QUERY:

CREATE UNIQUE INDEX idx_abcd_nopk_c ON rf_tbl_abcd_nopk(c);
RESULT:
	[]

-----------
QUERY:

ALTER TABLE rf_tbl_abcd_nopk REPLICA IDENTITY USING INDEX idx_abcd_nopk_c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REPLICA IDENTITY USING INDEX idx_abcd_nopk_c' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (a)' at line 1")

-----------
QUERY:

-- fail - column list /* REPLACED */ ''a/* REPLACED */ '' does not cover the REPLICA IDENTITY INDEX on /* REPLACED */ ''c/* REPLACED */ ''
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_pk (c)' at line 1")

-----------
QUERY:

-- ok - column list /* REPLACED */ ''c/* REPLACED */ '' does cover the REPLICA IDENTITY INDEX on /* REPLACED */ ''c/* REPLACED */ ''
UPDATE rf_tbl_abcd_pk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk (a)' at line 1")

-----------
QUERY:

-- fail - column list /* REPLACED */ ''a/* REPLACED */ '' does not cover the REPLICA IDENTITY INDEX on /* REPLACED */ ''c/* REPLACED */ ''
UPDATE rf_tbl_abcd_nopk SET a = 1;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk (c);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_nopk (c)' at line 1")

-----------
QUERY:

-- ok - column list /* REPLACED */ ''c/* REPLACED */ '' does cover the REPLICA IDENTITY INDEX on /* REPLACED */ ''c/* REPLACED */ ''
UPDATE rf_tbl_abcd_nopk SET a = 1;
RESULT:
	[]

-----------
QUERY:


-- Tests for partitioned table

-- set PUBLISH_VIA_PARTITION_ROOT to false and test column list for partitioned
-- table
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0)' at line 5")

-----------
QUERY:

-- fail - cannot use column list for partitioned table
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk (a)' at line 2")

-----------
QUERY:

-- ok - can use column list for partition
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk_1 (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk_1 (a)' at line 2")

-----------
QUERY:

-- ok - /* REPLACED */ ''a/* REPLACED */ '' is a PK col
UPDATE rf_tbl_abcd_part_pk SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.rf_tbl_abcd_part_pk' doesn't exist")

-----------
QUERY:

-- set PUBLISH_VIA_PARTITION_ROOT to true and test column list for partitioned
-- table
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=1)' at line 3")

-----------
QUERY:

-- ok - can use column list for partitioned table
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk (a);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk (a)' at line 2")

-----------
QUERY:

-- ok - /* REPLACED */ ''a/* REPLACED */ '' is a PK col
UPDATE rf_tbl_abcd_part_pk SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.rf_tbl_abcd_part_pk' doesn't exist")

-----------
QUERY:

-- fail - cannot set PUBLISH_VIA_PARTITION_ROOT to false if any column list is
-- used for partitioned table
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0)' at line 3")

-----------
QUERY:

-- remove partitioned table/* REPLACED */ ''s column list
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk' at line 2")

-----------
QUERY:

-- ok - we don/* REPLACED */ ''t have column list for partitioned table.
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0)' at line 2")

-----------
QUERY:

-- Now change the root column list to use a column /* REPLACED */ ''b/* REPLACED */ ''
-- (which is not in the replica identity)
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk_1 (b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk_1 (b)' at line 3")

-----------
QUERY:

-- ok - we don/* REPLACED */ ''t have column list for partitioned table.
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=0)' at line 2")

-----------
QUERY:

-- fail - /* REPLACED */ ''b/* REPLACED */ '' is not in REPLICA IDENTITY INDEX
UPDATE rf_tbl_abcd_part_pk SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.rf_tbl_abcd_part_pk' doesn't exist")

-----------
QUERY:

-- set PUBLISH_VIA_PARTITION_ROOT to true
-- can use column list for partitioned table
ALTER PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET (PUBLISH_VIA_PARTITION_ROOT=1)' at line 3")

-----------
QUERY:

-- ok - can use column list for partitioned table
ALTER PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk (b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6 SET TABLE rf_tbl_abcd_part_pk (b)' at line 2")

-----------
QUERY:

-- fail - /* REPLACED */ ''b/* REPLACED */ '' is not in REPLICA IDENTITY INDEX
UPDATE rf_tbl_abcd_part_pk SET a = 1;
RESULT:
	ERROR - (1146, "Table 'test.rf_tbl_abcd_part_pk' doesn't exist")

-----------
QUERY:


DROP PUBLICATION testpub6;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub6' at line 1")

-----------
QUERY:

DROP TABLE rf_tbl_abcd_pk;
RESULT:
	[]

-----------
QUERY:

DROP TABLE rf_tbl_abcd_nopk;
RESULT:
	[]

-----------
QUERY:

DROP TABLE rf_tbl_abcd_part_pk;
RESULT:
	ERROR - (1051, "Unknown table 'test.rf_tbl_abcd_part_pk'")

-----------
QUERY:

-- ======================================================

-- Test cache invalidation FOR ALL TABLES publication
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE TABLE testpub_tbl4(a int);
RESULT:
	[]

-----------
QUERY:

INSERT INTO testpub_tbl4 values(1);
RESULT:
	[]

-----------
QUERY:

UPDATE testpub_tbl4 set a = 2;
RESULT:
	[]

-----------
QUERY:

CREATE PUBLICATION testpub_foralltables FOR ALL TABLES;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foralltables FOR ALL TABLES' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- fail missing REPLICA IDENTITY
UPDATE testpub_tbl4 set a = 3;
RESULT:
	[]

-----------
QUERY:

DROP PUBLICATION testpub_foralltables;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foralltables' at line 1")

-----------
QUERY:

-- should pass after dropping the publication
UPDATE testpub_tbl4 set a = 3;
RESULT:
	[]

-----------
QUERY:

DROP TABLE testpub_tbl4;
RESULT:
	[]

-----------
QUERY:


-- fail - view
CREATE PUBLICATION testpub_fortbl FOR TABLE testpub_view;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortbl FOR TABLE testpub_view' at line 2")

-----------
QUERY:


CREATE TEMPORARY TABLE testpub_temptbl(a int);
RESULT:
	[]

-----------
QUERY:

-- fail - temporary table
CREATE PUBLICATION testpub_fortemptbl FOR TABLE testpub_temptbl;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortemptbl FOR TABLE testpub_temptbl' at line 2")

-----------
QUERY:

DROP TABLE testpub_temptbl;
RESULT:
	[]

-----------
QUERY:


CREATE UNLOGGED TABLE testpub_unloggedtbl(a int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'UNLOGGED TABLE testpub_unloggedtbl(a int)' at line 1")

-----------
QUERY:

-- fail - unlogged table
CREATE PUBLICATION testpub_forunloggedtbl FOR TABLE testpub_unloggedtbl;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forunloggedtbl FOR TABLE testpub_unloggedtbl' at line 2")

-----------
QUERY:

DROP TABLE testpub_unloggedtbl;
RESULT:
	ERROR - (1051, "Unknown table 'test.testpub_unloggedtbl'")

-----------
QUERY:


-- fail - system table
CREATE PUBLICATION testpub_forsystemtbl FOR TABLE pg_publication;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forsystemtbl FOR TABLE pg_publication' at line 2")

-----------
QUERY:


SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_fortbl FOR TABLE testpub_tbl1, pub_test.testpub_nopk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortbl FOR TABLE testpub_tbl1, pub_test.testpub_nopk' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- fail - already added
ALTER PUBLICATION testpub_fortbl ADD TABLE testpub_tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortbl ADD TABLE testpub_tbl1' at line 2")

-----------
QUERY:

-- fail - already added
CREATE PUBLICATION testpub_fortbl FOR TABLE testpub_tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortbl FOR TABLE testpub_tbl1' at line 2")

-----------
QUERY:


-- \dRp+ testpub_fortbl

-- fail - view
ALTER PUBLICATION testpub_default ADD TABLE testpub_view;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default ADD TABLE testpub_view' at line 4")

-----------
QUERY:


ALTER PUBLICATION testpub_default ADD TABLE testpub_tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default ADD TABLE testpub_tbl1' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub_default SET TABLE testpub_tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default SET TABLE testpub_tbl1' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub_default ADD TABLE pub_test.testpub_nopk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default ADD TABLE pub_test.testpub_nopk' at line 1")

-----------
QUERY:


ALTER PUBLICATION testpib_ins_trunct ADD TABLE pub_test.testpub_nopk, testpub_tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpib_ins_trunct ADD TABLE pub_test.testpub_nopk, testpub_tbl1' at line 1")

-----------
QUERY:


-- \d+ pub_test.testpub_nopk
-- \d+ testpub_tbl1
-- \dRp+ testpub_default

ALTER PUBLICATION testpub_default DROP TABLE testpub_tbl1, pub_test.testpub_nopk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default DROP TABLE testpub_tbl1, pub_test.testpub_nopk' at line 5")

-----------
QUERY:

-- fail - nonexistent
ALTER PUBLICATION testpub_default DROP TABLE pub_test.testpub_nopk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default DROP TABLE pub_test.testpub_nopk' at line 2")

-----------
QUERY:


-- \d+ testpub_tbl1

-- verify relation cache invalidation when a primary key is added using
-- an existing index
CREATE TABLE pub_test.testpub_addpk (id int not null, data int);
RESULT:
	ERROR - (1049, "Unknown database 'pub_test'")

-----------
QUERY:

ALTER PUBLICATION testpub_default ADD TABLE pub_test.testpub_addpk;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default ADD TABLE pub_test.testpub_addpk' at line 1")

-----------
QUERY:

INSERT INTO pub_test.testpub_addpk VALUES(1, 11);
RESULT:
	ERROR - (1049, "Unknown database 'pub_test'")

-----------
QUERY:

CREATE UNIQUE INDEX testpub_addpk_id_idx ON pub_test.testpub_addpk(id);
RESULT:
	ERROR - (1049, "Unknown database 'pub_test'")

-----------
QUERY:

-- fail:
UPDATE pub_test.testpub_addpk SET id = 2;
RESULT:
	ERROR - (1049, "Unknown database 'pub_test'")

-----------
QUERY:

ALTER TABLE pub_test.testpub_addpk ADD PRIMARY KEY USING INDEX testpub_addpk_id_idx;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INDEX testpub_addpk_id_idx' at line 1")

-----------
QUERY:

-- now it should work:
UPDATE pub_test.testpub_addpk SET id = 2;
RESULT:
	ERROR - (1049, "Unknown database 'pub_test'")

-----------
QUERY:

DROP TABLE pub_test.testpub_addpk;
RESULT:
	ERROR - (1051, "Unknown table 'pub_test.testpub_addpk'")

-----------
QUERY:


-- permissions
SET ROLE regress_publication_user2;
RESULT:
	ERROR - (3530, '`regress_publication_user2`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

CREATE PUBLICATION testpub2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub2' at line 1")

-----------
QUERY:
  -- fail

SET ROLE regress_publication_user;
RESULT:
	ERROR - (3530, '`regress_publication_user`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

GRANT CREATE ON DATABASE regression TO regress_publication_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DATABASE regression TO regress_publication_user2' at line 1")

-----------
QUERY:

SET ROLE regress_publication_user2;
RESULT:
	ERROR - (3530, '`regress_publication_user2`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub2' at line 1")

-----------
QUERY:
  -- ok
CREATE PUBLICATION testpub3 FOR TABLES IN SCHEMA pub_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub3 FOR TABLES IN SCHEMA pub_test' at line 2")

-----------
QUERY:
  -- fail
CREATE PUBLICATION testpub3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub3' at line 2")

-----------
QUERY:
  -- ok
RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 2")

-----------
QUERY:


ALTER PUBLICATION testpub2 ADD TABLE testpub_tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub2 ADD TABLE testpub_tbl1' at line 1")

-----------
QUERY:
  -- fail
ALTER PUBLICATION testpub3 ADD TABLES IN SCHEMA pub_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub3 ADD TABLES IN SCHEMA pub_test' at line 2")

-----------
QUERY:
  -- fail

SET ROLE regress_publication_user;
RESULT:
	ERROR - (3530, '`regress_publication_user`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

GRANT regress_publication_user TO regress_publication_user2;
RESULT:
	ERROR - (3523, 'Unknown authorization ID `regress_publication_user`@`%`')

-----------
QUERY:

SET ROLE regress_publication_user2;
RESULT:
	ERROR - (3530, '`regress_publication_user2`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

ALTER PUBLICATION testpub2 ADD TABLE testpub_tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub2 ADD TABLE testpub_tbl1' at line 1")

-----------
QUERY:
  -- ok

DROP PUBLICATION testpub2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub2' at line 3")

-----------
QUERY:

DROP PUBLICATION testpub3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub3' at line 1")

-----------
QUERY:


SET ROLE regress_publication_user;
RESULT:
	ERROR - (3530, '`regress_publication_user`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

CREATE ROLE regress_publication_user3;
RESULT:
	[]

-----------
QUERY:

GRANT regress_publication_user2 TO regress_publication_user3;
RESULT:
	[]

-----------
QUERY:

SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub4 FOR TABLES IN SCHEMA pub_test;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub4 FOR TABLES IN SCHEMA pub_test' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

ALTER PUBLICATION testpub4 OWNER TO regress_publication_user3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub4 OWNER TO regress_publication_user3' at line 1")

-----------
QUERY:

SET ROLE regress_publication_user3;
RESULT:
	ERROR - (3530, '`regress_publication_user3`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

-- fail - new owner must be superuser
ALTER PUBLICATION testpub4 owner to regress_publication_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub4 owner to regress_publication_user2' at line 2")

-----------
QUERY:
 -- fail
ALTER PUBLICATION testpub4 owner to regress_publication_user;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub4 owner to regress_publication_user' at line 2")

-----------
QUERY:
 -- ok

SET ROLE regress_publication_user;
RESULT:
	ERROR - (3530, '`regress_publication_user`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

DROP PUBLICATION testpub4;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub4' at line 1")

-----------
QUERY:

DROP ROLE regress_publication_user3;
RESULT:
	[]

-----------
QUERY:


REVOKE CREATE ON DATABASE regression FROM regress_publication_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DATABASE regression FROM regress_publication_user2' at line 1")

-----------
QUERY:


DROP TABLE testpub_parted;
RESULT:
	ERROR - (1051, "Unknown table 'test.testpub_parted'")

-----------
QUERY:

DROP TABLE testpub_tbl1;
RESULT:
	[]

-----------
QUERY:


-- \dRp+ testpub_default

-- fail - must be owner of publication
SET ROLE regress_publication_user_dummy;
RESULT:
	ERROR - (3530, '`regress_publication_user_dummy`@`%` is not granted to `root`@`localhost`')

-----------
QUERY:

ALTER PUBLICATION testpub_default RENAME TO testpub_dummy;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default RENAME TO testpub_dummy' at line 1")

-----------
QUERY:

RESET ROLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ROLE' at line 1")

-----------
QUERY:


ALTER PUBLICATION testpub_default RENAME TO testpub_foo;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default RENAME TO testpub_foo' at line 1")

-----------
QUERY:


-- \dRp testpub_foo

-- rename back to keep the rest simple
ALTER PUBLICATION testpub_foo RENAME TO testpub_default;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_foo RENAME TO testpub_default' at line 4")

-----------
QUERY:


ALTER PUBLICATION testpub_default OWNER TO regress_publication_user2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default OWNER TO regress_publication_user2' at line 1")

-----------
QUERY:


-- \dRp testpub_default

-- adding schemas and tables
CREATE SCHEMA pub_test1;
RESULT:
	[]

-----------
QUERY:

CREATE SCHEMA pub_test2;
RESULT:
	[]

-----------
QUERY:

CREATE SCHEMA pub_test3;
RESULT:
	[]

-----------
QUERY:

CREATE SCHEMA "CURRENT_SCHEMA";
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'"CURRENT_SCHEMA"\' at line 1')

-----------
QUERY:

CREATE TABLE pub_test1.tbl (id int, data text);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE pub_test1.tbl1 (id serial primary key, data text);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE pub_test2.tbl1 (id serial primary key, data text);
RESULT:
	[]

-----------
QUERY:

CREATE TABLE "CURRENT_SCHEMA"."CURRENT_SCHEMA"(id int);
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'"CURRENT_SCHEMA"."CURRENT_SCHEMA"(id int)\' at line 1')

-----------
QUERY:


-- suppress warning that depends on wal_level
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub1_forschema FOR TABLES IN SCHEMA pub_test1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema FOR TABLES IN SCHEMA pub_test1' at line 1")

-----------
QUERY:

-- \dRp+ testpub1_forschema

CREATE PUBLICATION testpub2_forschema FOR TABLES IN SCHEMA pub_test1, pub_test2, pub_test3;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub2_forschema FOR TABLES IN SCHEMA pub_test1, pub_test2, pub_te' at line 3")

-----------
QUERY:

-- \dRp+ testpub2_forschema

-- check create publication on CURRENT_SCHEMA
CREATE PUBLICATION testpub3_forschema FOR TABLES IN SCHEMA CURRENT_SCHEMA;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub3_forschema FOR TABLES IN SCHEMA CURRENT_SCHEMA' at line 4")

-----------
QUERY:

CREATE PUBLICATION testpub4_forschema FOR TABLES IN SCHEMA "CURRENT_SCHEMA";
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'PUBLICATION testpub4_forschema FOR TABLES IN SCHEMA "CURRENT_SCHEMA"\' at line 1')

-----------
QUERY:

CREATE PUBLICATION testpub5_forschema FOR TABLES IN SCHEMA CURRENT_SCHEMA, "CURRENT_SCHEMA";
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'PUBLICATION testpub5_forschema FOR TABLES IN SCHEMA CURRENT_SCHEMA, "CURRENT_SCH\' at line 1')

-----------
QUERY:

CREATE PUBLICATION testpub6_forschema FOR TABLES IN SCHEMA "CURRENT_SCHEMA", CURRENT_SCHEMA;
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'PUBLICATION testpub6_forschema FOR TABLES IN SCHEMA "CURRENT_SCHEMA", CURRENT_SC\' at line 1')

-----------
QUERY:

CREATE PUBLICATION testpub_fortable FOR TABLE "CURRENT_SCHEMA"."CURRENT_SCHEMA";
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'PUBLICATION testpub_fortable FOR TABLE "CURRENT_SCHEMA"."CURRENT_SCHEMA"\' at line 1')

-----------
QUERY:


RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:


-- \dRp+ testpub3_forschema
-- \dRp+ testpub4_forschema
-- \dRp+ testpub5_forschema
-- \dRp+ testpub6_forschema
-- \dRp+ testpub_fortable

-- check create publication on CURRENT_SCHEMA where search_path is not set
SET SEARCH_PATH='';
RESULT:
	ERROR - (1193, "Unknown system variable 'SEARCH_PATH'")

-----------
QUERY:

CREATE PUBLICATION testpub_forschema FOR TABLES IN SCHEMA CURRENT_SCHEMA;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema FOR TABLES IN SCHEMA CURRENT_SCHEMA' at line 1")

-----------
QUERY:

RESET SEARCH_PATH;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SEARCH_PATH' at line 1")

-----------
QUERY:


-- check create publication on CURRENT_SCHEMA where TABLE/TABLES in SCHEMA
-- is not specified
CREATE PUBLICATION testpub_forschema1 FOR CURRENT_SCHEMA;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema1 FOR CURRENT_SCHEMA' at line 3")

-----------
QUERY:


-- check create publication on CURRENT_SCHEMA along with FOR TABLE
CREATE PUBLICATION testpub_forschema1 FOR TABLE CURRENT_SCHEMA;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema1 FOR TABLE CURRENT_SCHEMA' at line 2")

-----------
QUERY:


-- check create publication on a schema that does not exist
CREATE PUBLICATION testpub_forschema FOR TABLES IN SCHEMA non_existent_schema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema FOR TABLES IN SCHEMA non_existent_schema' at line 2")

-----------
QUERY:


-- check create publication on a system schema
CREATE PUBLICATION testpub_forschema FOR TABLES IN SCHEMA pg_catalog;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema FOR TABLES IN SCHEMA pg_catalog' at line 2")

-----------
QUERY:


-- check create publication on an object which is not schema
CREATE PUBLICATION testpub1_forschema1 FOR TABLES IN SCHEMA testpub_view;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema1 FOR TABLES IN SCHEMA testpub_view' at line 2")

-----------
QUERY:


-- dropping the schema should reflect the change in publication
DROP SCHEMA pub_test3;
RESULT:
	[]

-----------
QUERY:

-- \dRp+ testpub2_forschema

-- renaming the schema should reflect the change in publication
ALTER SCHEMA pub_test1 RENAME to pub_test1_renamed;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'RENAME to pub_test1_renamed' at line 4")

-----------
QUERY:

-- \dRp+ testpub2_forschema

ALTER SCHEMA pub_test1_renamed RENAME to pub_test1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'RENAME to pub_test1' at line 3")

-----------
QUERY:

-- \dRp+ testpub2_forschema

-- alter publication add schema
ALTER PUBLICATION testpub1_forschema ADD TABLES IN SCHEMA pub_test2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema ADD TABLES IN SCHEMA pub_test2' at line 4")

-----------
QUERY:

-- \dRp+ testpub1_forschema

-- add non existent schema
ALTER PUBLICATION testpub1_forschema ADD TABLES IN SCHEMA non_existent_schema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema ADD TABLES IN SCHEMA non_existent_schema' at line 4")

-----------
QUERY:

-- \dRp+ testpub1_forschema

-- add a schema which is already added to the publication
ALTER PUBLICATION testpub1_forschema ADD TABLES IN SCHEMA pub_test1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema ADD TABLES IN SCHEMA pub_test1' at line 4")

-----------
QUERY:

-- \dRp+ testpub1_forschema

-- alter publication drop schema
ALTER PUBLICATION testpub1_forschema DROP TABLES IN SCHEMA pub_test2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema DROP TABLES IN SCHEMA pub_test2' at line 4")

-----------
QUERY:

-- \dRp+ testpub1_forschema

-- drop schema that is not present in the publication
ALTER PUBLICATION testpub1_forschema DROP TABLES IN SCHEMA pub_test2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema DROP TABLES IN SCHEMA pub_test2' at line 4")

-----------
QUERY:

-- \dRp+ testpub1_forschema

-- drop a schema that does not exist in the system
ALTER PUBLICATION testpub1_forschema DROP TABLES IN SCHEMA non_existent_schema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema DROP TABLES IN SCHEMA non_existent_schema' at line 4")

-----------
QUERY:

-- \dRp+ testpub1_forschema

-- drop all schemas
ALTER PUBLICATION testpub1_forschema DROP TABLES IN SCHEMA pub_test1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema DROP TABLES IN SCHEMA pub_test1' at line 4")

-----------
QUERY:

-- \dRp+ testpub1_forschema

-- alter publication set multiple schema
ALTER PUBLICATION testpub1_forschema SET TABLES IN SCHEMA pub_test1, pub_test2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema SET TABLES IN SCHEMA pub_test1, pub_test2' at line 4")

-----------
QUERY:

-- \dRp+ testpub1_forschema

-- alter publication set non-existent schema
ALTER PUBLICATION testpub1_forschema SET TABLES IN SCHEMA non_existent_schema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema SET TABLES IN SCHEMA non_existent_schema' at line 4")

-----------
QUERY:

-- \dRp+ testpub1_forschema

-- alter publication set it duplicate schemas should set the schemas after
-- removing the duplicate schemas
ALTER PUBLICATION testpub1_forschema SET TABLES IN SCHEMA pub_test1, pub_test1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema SET TABLES IN SCHEMA pub_test1, pub_test1' at line 5")

-----------
QUERY:

-- \dRp+ testpub1_forschema

-- Verify that it fails to add a schema with a column specification
ALTER PUBLICATION testpub1_forschema ADD TABLES IN SCHEMA foo (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema ADD TABLES IN SCHEMA foo (a, b)' at line 4")

-----------
QUERY:

ALTER PUBLICATION testpub1_forschema ADD TABLES IN SCHEMA foo, bar (a, b);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema ADD TABLES IN SCHEMA foo, bar (a, b)' at line 1")

-----------
QUERY:


-- cleanup pub_test1 schema for invalidation tests
ALTER PUBLICATION testpub2_forschema DROP TABLES IN SCHEMA pub_test1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub2_forschema DROP TABLES IN SCHEMA pub_test1' at line 2")

-----------
QUERY:

DROP PUBLICATION testpub3_forschema, testpub4_forschema, testpub5_forschema, testpub6_forschema, testpub_fortable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub3_forschema, testpub4_forschema, testpub5_forschema, testpub6' at line 1")

-----------
QUERY:

DROP SCHEMA "CURRENT_SCHEMA" CASCADE;
RESULT:
	ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'"CURRENT_SCHEMA" CASCADE\' at line 1')

-----------
QUERY:


-- verify relation cache invalidations through update statement for the
-- default REPLICA IDENTITY on the relation, if schema is part of the
-- publication then update will fail because relation/* REPLACED */ ''s relreplident
-- option will be set, if schema is not part of the publication then update
-- will be successful.
INSERT INTO pub_test1.tbl VALUES(1, 'test');
RESULT:
	[]

-----------
QUERY:


-- fail
UPDATE pub_test1.tbl SET id = 2;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub1_forschema DROP TABLES IN SCHEMA pub_test1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema DROP TABLES IN SCHEMA pub_test1' at line 1")

-----------
QUERY:


-- success
UPDATE pub_test1.tbl SET id = 2;
RESULT:
	[]

-----------
QUERY:

ALTER PUBLICATION testpub1_forschema SET TABLES IN SCHEMA pub_test1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema SET TABLES IN SCHEMA pub_test1' at line 1")

-----------
QUERY:


-- fail
UPDATE pub_test1.tbl SET id = 2;
RESULT:
	[]

-----------
QUERY:


-- verify invalidation of partition table having parent and child tables in
-- different schema
CREATE SCHEMA pub_testpart1;
RESULT:
	[]

-----------
QUERY:

CREATE SCHEMA pub_testpart2;
RESULT:
	[]

-----------
QUERY:


CREATE TABLE pub_testpart1.parent1 (a int) partition by list (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE pub_testpart2.child_parent1 partition of pub_testpart1.parent1 for values in (1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of pub_testpart1.parent1 for values in (1)' at line 1")

-----------
QUERY:

INSERT INTO pub_testpart2.child_parent1 values(1);
RESULT:
	ERROR - (1146, "Table 'pub_testpart2.child_parent1' doesn't exist")

-----------
QUERY:

UPDATE pub_testpart2.child_parent1 set a = 1;
RESULT:
	ERROR - (1146, "Table 'pub_testpart2.child_parent1' doesn't exist")

-----------
QUERY:

SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpubpart_forschema FOR TABLES IN SCHEMA pub_testpart1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpubpart_forschema FOR TABLES IN SCHEMA pub_testpart1' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:


-- fail
UPDATE pub_testpart1.parent1 set a = 1;
RESULT:
	ERROR - (1146, "Table 'pub_testpart1.parent1' doesn't exist")

-----------
QUERY:

UPDATE pub_testpart2.child_parent1 set a = 1;
RESULT:
	ERROR - (1146, "Table 'pub_testpart2.child_parent1' doesn't exist")

-----------
QUERY:


DROP PUBLICATION testpubpart_forschema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpubpart_forschema' at line 1")

-----------
QUERY:


-- verify invalidation of partition tables for schema publication that has
-- parent and child tables of different partition hierarchies
CREATE TABLE pub_testpart2.parent2 (a int) partition by list (a);
RESULT:
	ERROR - (1492, 'For LIST partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE pub_testpart1.child_parent2 partition of pub_testpart2.parent2 for values in (1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'of pub_testpart2.parent2 for values in (1)' at line 1")

-----------
QUERY:

INSERT INTO pub_testpart1.child_parent2 values(1);
RESULT:
	ERROR - (1146, "Table 'pub_testpart1.child_parent2' doesn't exist")

-----------
QUERY:

UPDATE pub_testpart1.child_parent2 set a = 1;
RESULT:
	ERROR - (1146, "Table 'pub_testpart1.child_parent2' doesn't exist")

-----------
QUERY:

SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpubpart_forschema FOR TABLES IN SCHEMA pub_testpart2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpubpart_forschema FOR TABLES IN SCHEMA pub_testpart2' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:


-- fail
UPDATE pub_testpart2.child_parent1 set a = 1;
RESULT:
	ERROR - (1146, "Table 'pub_testpart2.child_parent1' doesn't exist")

-----------
QUERY:

UPDATE pub_testpart2.parent2 set a = 1;
RESULT:
	ERROR - (1146, "Table 'pub_testpart2.parent2' doesn't exist")

-----------
QUERY:

UPDATE pub_testpart1.child_parent2 set a = 1;
RESULT:
	ERROR - (1146, "Table 'pub_testpart1.child_parent2' doesn't exist")

-----------
QUERY:


-- alter publication set /* REPLACED */ ''TABLES IN SCHEMA/* REPLACED */ '' on an empty publication.
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub3_forschema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub3_forschema' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

-- \dRp+ testpub3_forschema
ALTER PUBLICATION testpub3_forschema SET TABLES IN SCHEMA pub_test1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub3_forschema SET TABLES IN SCHEMA pub_test1' at line 2")

-----------
QUERY:

-- \dRp+ testpub3_forschema

-- create publication including both /* REPLACED */ ''FOR TABLE/* REPLACED */ '' and /* REPLACED */ ''FOR TABLES IN SCHEMA/* REPLACED */ ''
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE PUBLICATION testpub_forschema_fortable FOR TABLES IN SCHEMA pub_test1, TABLE pub_test2.tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema_fortable FOR TABLES IN SCHEMA pub_test1, TABLE pub' at line 1")

-----------
QUERY:

CREATE PUBLICATION testpub_fortable_forschema FOR TABLE pub_test2.tbl1, TABLES IN SCHEMA pub_test1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable_forschema FOR TABLE pub_test2.tbl1, TABLES IN SCHEM' at line 1")

-----------
QUERY:

RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:


-- \dRp+ testpub_forschema_fortable
-- \dRp+ testpub_fortable_forschema

-- fail specifying table without any of /* REPLACED */ ''FOR TABLES IN SCHEMA/* REPLACED */ '' or
--/* REPLACED */ ''FOR TABLE/* REPLACED */ '' or /* REPLACED */ ''FOR ALL TABLES/* REPLACED */ ''
CREATE PUBLICATION testpub_error FOR pub_test2.tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--/* REPLACED */ ''FOR TABLE/* REPLACED */ '' or /* REPLACED */ ''FOR ALL TABLES' at line 5")

-----------
QUERY:


DROP VIEW testpub_view;
RESULT:
	[]

-----------
QUERY:


DROP PUBLICATION testpub_default;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_default' at line 1")

-----------
QUERY:

DROP PUBLICATION testpib_ins_trunct;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpib_ins_trunct' at line 1")

-----------
QUERY:

DROP PUBLICATION testpub_fortbl;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortbl' at line 1")

-----------
QUERY:

DROP PUBLICATION testpub1_forschema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub1_forschema' at line 1")

-----------
QUERY:

DROP PUBLICATION testpub2_forschema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub2_forschema' at line 1")

-----------
QUERY:

DROP PUBLICATION testpub3_forschema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub3_forschema' at line 1")

-----------
QUERY:

DROP PUBLICATION testpub_forschema_fortable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_forschema_fortable' at line 1")

-----------
QUERY:

DROP PUBLICATION testpub_fortable_forschema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpub_fortable_forschema' at line 1")

-----------
QUERY:

DROP PUBLICATION testpubpart_forschema;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION testpubpart_forschema' at line 1")

-----------
QUERY:


DROP SCHEMA pub_test CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:

DROP SCHEMA pub_test1 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:

DROP SCHEMA pub_test2 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:

DROP SCHEMA pub_testpart1 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:

DROP SCHEMA pub_testpart2 CASCADE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASCADE' at line 1")

-----------
QUERY:


-- Test the list of partitions published with or without
-- /* REPLACED */ ''PUBLISH_VIA_PARTITION_ROOT/* REPLACED */ '' parameter
SET client_min_messages = 'ERROR';
RESULT:
	ERROR - (1193, "Unknown system variable 'client_min_messages'")

-----------
QUERY:

CREATE SCHEMA sch1;
RESULT:
	[]

-----------
QUERY:

CREATE SCHEMA sch2;
RESULT:
	[]

-----------
QUERY:

CREATE TABLE sch1.tbl1 (a int) PARTITION BY RANGE(a);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE sch2.tbl1_part1 PARTITION OF sch1.tbl1 FOR VALUES FROM (1) to (10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF sch1.tbl1 FOR VALUES FROM (1) to (10)' at line 1")

-----------
QUERY:

-- Schema publication that does not include the schema that has the parent table
CREATE PUBLICATION pub FOR TABLES IN SCHEMA sch2 WITH (PUBLISH_VIA_PARTITION_ROOT=1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub FOR TABLES IN SCHEMA sch2 WITH (PUBLISH_VIA_PARTITION_ROOT=1)' at line 2")

-----------
QUERY:

SELECT * FROM pg_publication_tables;
RESULT:
	ERROR - (1146, "Table 'test.pg_publication_tables' doesn't exist")

-----------
QUERY:


DROP PUBLICATION pub;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub' at line 1")

-----------
QUERY:

-- Table publication that does not include the parent table
CREATE PUBLICATION pub FOR TABLE sch2.tbl1_part1 WITH (PUBLISH_VIA_PARTITION_ROOT=1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub FOR TABLE sch2.tbl1_part1 WITH (PUBLISH_VIA_PARTITION_ROOT=1)' at line 2")

-----------
QUERY:

SELECT * FROM pg_publication_tables;
RESULT:
	ERROR - (1146, "Table 'test.pg_publication_tables' doesn't exist")

-----------
QUERY:


-- Table publication that includes both the parent table and the child table
ALTER PUBLICATION pub ADD TABLE sch1.tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub ADD TABLE sch1.tbl1' at line 2")

-----------
QUERY:

SELECT * FROM pg_publication_tables;
RESULT:
	ERROR - (1146, "Table 'test.pg_publication_tables' doesn't exist")

-----------
QUERY:


DROP PUBLICATION pub;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub' at line 1")

-----------
QUERY:

-- Schema publication that does not include the schema that has the parent table
CREATE PUBLICATION pub FOR TABLES IN SCHEMA sch2 WITH (PUBLISH_VIA_PARTITION_ROOT=0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub FOR TABLES IN SCHEMA sch2 WITH (PUBLISH_VIA_PARTITION_ROOT=0)' at line 2")

-----------
QUERY:

SELECT * FROM pg_publication_tables;
RESULT:
	ERROR - (1146, "Table 'test.pg_publication_tables' doesn't exist")

-----------
QUERY:


DROP PUBLICATION pub;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub' at line 1")

-----------
QUERY:

-- Table publication that does not include the parent table
CREATE PUBLICATION pub FOR TABLE sch2.tbl1_part1 WITH (PUBLISH_VIA_PARTITION_ROOT=0);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub FOR TABLE sch2.tbl1_part1 WITH (PUBLISH_VIA_PARTITION_ROOT=0)' at line 2")

-----------
QUERY:

SELECT * FROM pg_publication_tables;
RESULT:
	ERROR - (1146, "Table 'test.pg_publication_tables' doesn't exist")

-----------
QUERY:


-- Table publication that includes both the parent table and the child table
ALTER PUBLICATION pub ADD TABLE sch1.tbl1;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub ADD TABLE sch1.tbl1' at line 2")

-----------
QUERY:

SELECT * FROM pg_publication_tables;
RESULT:
	ERROR - (1146, "Table 'test.pg_publication_tables' doesn't exist")

-----------
QUERY:


DROP PUBLICATION pub;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub' at line 1")

-----------
QUERY:

DROP TABLE sch2.tbl1_part1;
RESULT:
	ERROR - (1051, "Unknown table 'sch2.tbl1_part1'")

-----------
QUERY:

DROP TABLE sch1.tbl1;
RESULT:
	ERROR - (1051, "Unknown table 'sch1.tbl1'")

-----------
QUERY:


CREATE TABLE sch1.tbl1 (a int) PARTITION BY RANGE(a);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:

CREATE TABLE sch1.tbl1_part1 PARTITION OF sch1.tbl1 FOR VALUES FROM (1) to (10);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF sch1.tbl1 FOR VALUES FROM (1) to (10)' at line 1")

-----------
QUERY:

CREATE TABLE sch1.tbl1_part2 PARTITION OF sch1.tbl1 FOR VALUES FROM (10) to (20);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OF sch1.tbl1 FOR VALUES FROM (10) to (20)' at line 1")

-----------
QUERY:

CREATE TABLE sch1.tbl1_part3 (a int) PARTITION BY RANGE(a);
RESULT:
	ERROR - (1492, 'For RANGE partitions each partition must be defined')

-----------
QUERY:

ALTER TABLE sch1.tbl1 ATTACH PARTITION sch1.tbl1_part3 FOR VALUES FROM (20) to (30);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ATTACH PARTITION sch1.tbl1_part3 FOR VALUES FROM (20) to (30)' at line 1")

-----------
QUERY:

CREATE PUBLICATION pub FOR TABLES IN SCHEMA sch1 WITH (PUBLISH_VIA_PARTITION_ROOT=1);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub FOR TABLES IN SCHEMA sch1 WITH (PUBLISH_VIA_PARTITION_ROOT=1)' at line 1")

-----------
QUERY:

SELECT * FROM pg_publication_tables;
RESULT:
	ERROR - (1146, "Table 'test.pg_publication_tables' doesn't exist")

-----------
QUERY:


RESET client_min_messages;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'client_min_messages' at line 1")

-----------
QUERY:

DROP PUBLICATION pub;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PUBLICATION pub' at line 1")

-----------
QUERY:

DROP TABLE sch1.tbl1;
RESULT:
	ERROR - (1051, "Unknown table 'sch1.tbl1'")

-----------
QUERY:

DROP SCHEMA sch1 cascade;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'cascade' at line 1")

-----------
QUERY:

DROP SCHEMA sch2 cascade;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'cascade' at line 1")

-----------
QUERY:


RESET SESSION AUTHORIZATION;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SESSION AUTHORIZATION' at line 1")

-----------
QUERY:

DROP ROLE regress_publication_user, regress_publication_user2;
RESULT:
	ERROR - (1396, "Operation DROP ROLE failed for 'regress_publication_user'@'%'")

-----------
QUERY:

DROP ROLE regress_publication_user_dummy;
RESULT:
	ERROR - (1396, "Operation DROP ROLE failed for 'regress_publication_user_dummy'@'%'")
