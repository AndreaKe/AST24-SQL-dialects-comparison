--
-- Test for facilities of security label
--

-- initial setups
SET client_min_messages TO 'warning'
ERROR: --
-- Test for facilities of security label
--

-- initial setups
SET client_min_messages TO 'warning'

Catalog Error: unrecognized configuration parameter "client_min_messages"

Did you mean: "schema"


DROP ROLE IF EXISTS regress_seclabel_user1
ERROR: 

DROP ROLE IF EXISTS regress_seclabel_user1

Parser Error: syntax error at or near "ROLE"

DROP ROLE IF EXISTS regress_seclabel_user2
ERROR: 
DROP ROLE IF EXISTS regress_seclabel_user2

Parser Error: syntax error at or near "ROLE"


RESET client_min_messages
ERROR: 

RESET client_min_messages

Catalog Error: unrecognized configuration parameter "client_min_messages"

Did you mean: "schema"


CREATE USER regress_seclabel_user1 WITH CREATEROLE
ERROR: 

CREATE USER regress_seclabel_user1 WITH CREATEROLE

Parser Error: syntax error at or near "USER"

CREATE USER regress_seclabel_user2
ERROR: 
CREATE USER regress_seclabel_user2

Parser Error: syntax error at or near "USER"


CREATE TABLE seclabel_tbl1 (a int, b text)

CREATE TABLE seclabel_tbl2 (x int, y text)

CREATE VIEW seclabel_view1 AS SELECT * FROM seclabel_tbl2

CREATE FUNCTION seclabel_four() RETURNS integer AS $$SELECT 4$$ language sql
ERROR: 
CREATE FUNCTION seclabel_four() RETURNS integer AS $$SELECT 4$$ language sql

Parser Error: syntax error at or near "RETURNS"

CREATE DOMAIN seclabel_domain AS text
ERROR: 
CREATE DOMAIN seclabel_domain AS text

Parser Error: syntax error at or near "DOMAIN"


ALTER TABLE seclabel_tbl1 OWNER TO regress_seclabel_user1
ERROR: 

ALTER TABLE seclabel_tbl1 OWNER TO regress_seclabel_user1

Parser Error: syntax error at or near "OWNER"

ALTER TABLE seclabel_tbl2 OWNER TO regress_seclabel_user2
ERROR: 
ALTER TABLE seclabel_tbl2 OWNER TO regress_seclabel_user2

Parser Error: syntax error at or near "OWNER"


--
-- Test of SECURITY LABEL statement without a plugin
--
SECURITY LABEL ON TABLE seclabel_tbl1 IS 'classified'
ERROR: 

--
-- Test of SECURITY LABEL statement without a plugin
--
SECURITY LABEL ON TABLE seclabel_tbl1 IS 'classified'

Parser Error: syntax error at or near "SECURITY"
			-- fail
SECURITY LABEL FOR 'dummy' ON TABLE seclabel_tbl1 IS 'classified'
ERROR: 			-- fail
SECURITY LABEL FOR 'dummy' ON TABLE seclabel_tbl1 IS 'classified'

Parser Error: syntax error at or near "SECURITY"
		-- fail
SECURITY LABEL ON TABLE seclabel_tbl1 IS '...invalid label...'
ERROR: 		-- fail
SECURITY LABEL ON TABLE seclabel_tbl1 IS '...invalid label...'

Parser Error: syntax error at or near "SECURITY"
		-- fail
SECURITY LABEL ON TABLE seclabel_tbl3 IS 'unclassified'
ERROR: 		-- fail
SECURITY LABEL ON TABLE seclabel_tbl3 IS 'unclassified'

Parser Error: syntax error at or near "SECURITY"
			-- fail

SECURITY LABEL ON ROLE regress_seclabel_user1 IS 'classified'
ERROR: 			-- fail

SECURITY LABEL ON ROLE regress_seclabel_user1 IS 'classified'

Parser Error: syntax error at or near "SECURITY"
			-- fail
SECURITY LABEL FOR 'dummy' ON ROLE regress_seclabel_user1 IS 'classified'
ERROR: 			-- fail
SECURITY LABEL FOR 'dummy' ON ROLE regress_seclabel_user1 IS 'classified'

Parser Error: syntax error at or near "SECURITY"
		-- fail
SECURITY LABEL ON ROLE regress_seclabel_user1 IS '...invalid label...'
ERROR: 		-- fail
SECURITY LABEL ON ROLE regress_seclabel_user1 IS '...invalid label...'

Parser Error: syntax error at or near "SECURITY"
		-- fail
SECURITY LABEL ON ROLE regress_seclabel_user3 IS 'unclassified'
ERROR: 		-- fail
SECURITY LABEL ON ROLE regress_seclabel_user3 IS 'unclassified'

Parser Error: syntax error at or near "SECURITY"
			-- fail

-- clean up objects
DROP FUNCTION seclabel_four()
ERROR: 			-- fail

-- clean up objects
DROP FUNCTION seclabel_four()

Parser Error: syntax error at or near "("

DROP DOMAIN seclabel_domain
ERROR: 
DROP DOMAIN seclabel_domain

Parser Error: syntax error at or near "DOMAIN"

DROP VIEW seclabel_view1

DROP TABLE seclabel_tbl1

DROP TABLE seclabel_tbl2

DROP USER regress_seclabel_user1
ERROR: 
DROP USER regress_seclabel_user1

Parser Error: syntax error at or near "USER"

DROP USER regress_seclabel_user2
ERROR: 
DROP USER regress_seclabel_user2

Parser Error: syntax error at or near "USER"


