
-----------
QUERY:
--
-- Test cumulative stats system
--
-- Must be run after tenk2 has been created (by create_table),
-- populated (by create_misc) and indexed (by create_index).
--

-- conditio sine qua non
SHOW track_counts;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'track_counts' at line 9")

-----------
QUERY:
  -- must be on

-- ensure that both seqscan and indexscan plans are allowed
SET enable_seqscan TO on;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO on' at line 4")

-----------
QUERY:

SET enable_indexscan TO on;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO on' at line 1")

-----------
QUERY:

-- for the moment, we don/* REPLACED */''t want index-only scans here
SET enable_indexonlyscan TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 2")

-----------
QUERY:

-- not enabled by default, but we want to test it...
SET track_functions TO 'all';
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO 'all'' at line 2")

-----------
QUERY:


-- record dboid for later use
SELECT oid AS dboid from pg_database where datname = current_database() \gset

-- save counters
BEGIN;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\n\n-- save counters\nBEGIN' at line 2")

-----------
QUERY:

SET LOCAL stats_fetch_consistency = snapshot;
RESULT:
	mySQL: ERROR - (1193, "Unknown system variable 'stats_fetch_consistency'")

-----------
QUERY:

CREATE TABLE prevstats AS
SELECT t.seq_scan, t.seq_tup_read, t.idx_scan, t.idx_tup_fetch,
       (b.heap_blks_read + b.heap_blks_hit) AS heap_blks,
       (b.idx_blks_read + b.idx_blks_hit) AS idx_blks,
       pg_stat_get_snapshot_timestamp() as snap_ts
  FROM pg_catalog.pg_stat_user_tables AS t,
       pg_catalog.pg_statio_user_tables AS b
 WHERE t.relname='tenk2' AND b.relname='tenk2';
RESULT:
	mySQL: ERROR - (1049, "Unknown database 'pg_catalog'")

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:


-- test effects of TRUNCATE on n_live_tup/n_dead_tup counters
CREATE TABLE trunc_stats_test(id serial);
RESULT:
	mySQL: []

-----------
QUERY:

CREATE TABLE trunc_stats_test1(id serial, stuff text);
RESULT:
	mySQL: []

-----------
QUERY:

CREATE TABLE trunc_stats_test2(id serial);
RESULT:
	mySQL: []

-----------
QUERY:

CREATE TABLE trunc_stats_test3(id serial, stuff text);
RESULT:
	mySQL: []

-----------
QUERY:

CREATE TABLE trunc_stats_test4(id serial);
RESULT:
	mySQL: []

-----------
QUERY:


-- check that n_live_tup is reset to 0 after truncate
INSERT INTO trunc_stats_test DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 2")

-----------
QUERY:

INSERT INTO trunc_stats_test DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

INSERT INTO trunc_stats_test DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

TRUNCATE trunc_stats_test;
RESULT:
	mySQL: []

-----------
QUERY:


-- test involving a truncate in a transaction /* REPLACED */, 4 ins but only 1 live
INSERT INTO trunc_stats_test1 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 2")

-----------
QUERY:

INSERT INTO trunc_stats_test1 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

INSERT INTO trunc_stats_test1 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

UPDATE trunc_stats_test1 SET id = id + 10 WHERE id IN (1, 2);
RESULT:
	mySQL: []

-----------
QUERY:

DELETE FROM trunc_stats_test1 WHERE id = 3;
RESULT:
	mySQL: []

-----------
QUERY:


BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

UPDATE trunc_stats_test1 SET id = id + 100;
RESULT:
	mySQL: []

-----------
QUERY:

TRUNCATE trunc_stats_test1;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO trunc_stats_test1 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:


-- use a savepoint: 1 insert, 1 live
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO trunc_stats_test2 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

INSERT INTO trunc_stats_test2 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

SAVEPOINT p1;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO trunc_stats_test2 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

TRUNCATE trunc_stats_test2;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO trunc_stats_test2 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

RELEASE SAVEPOINT p1;
RESULT:
	mySQL: ERROR - (1305, 'SAVEPOINT p1 does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:


-- rollback a savepoint: this should count 4 inserts and have 2
-- live tuples after commit (and 2 dead ones due to aborted subxact)
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO trunc_stats_test3 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

INSERT INTO trunc_stats_test3 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

SAVEPOINT p1;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO trunc_stats_test3 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

INSERT INTO trunc_stats_test3 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

TRUNCATE trunc_stats_test3;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO trunc_stats_test3 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

ROLLBACK TO SAVEPOINT p1;
RESULT:
	mySQL: ERROR - (1305, 'SAVEPOINT p1 does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:


-- rollback a truncate: this should count 2 inserts and produce 2 dead tuples
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO trunc_stats_test4 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

INSERT INTO trunc_stats_test4 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

TRUNCATE trunc_stats_test4;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO trunc_stats_test4 DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	mySQL: []

-----------
QUERY:


-- do a seqscan
SELECT count(*) FROM tenk2;
RESULT:
	mySQL: ERROR - (1146, "Table 'test.tenk2' doesn't exist")

-----------
QUERY:

-- do an indexscan
-- make sure it is not a bitmap scan, which might skip fetching heap tuples
SET enable_bitmapscan TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 3")

-----------
QUERY:

SELECT count(*) FROM tenk2 WHERE unique1 = 1;
RESULT:
	mySQL: ERROR - (1146, "Table 'test.tenk2' doesn't exist")

-----------
QUERY:

RESET enable_bitmapscan;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'enable_bitmapscan' at line 1")

-----------
QUERY:


-- ensure pending stats are flushed
SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:


-- check effects
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SET LOCAL stats_fetch_consistency = snapshot;
RESULT:
	mySQL: ERROR - (1193, "Unknown system variable 'stats_fetch_consistency'")

-----------
QUERY:


SELECT relname, n_tup_ins, n_tup_upd, n_tup_del, n_live_tup, n_dead_tup
  FROM pg_stat_user_tables
 WHERE relname like 'trunc_stats_test%' order by relname;
RESULT:
	mySQL: ERROR - (1146, "Table 'test.pg_stat_user_tables' doesn't exist")

-----------
QUERY:


SELECT st.seq_scan >= pr.seq_scan + 1,
       st.seq_tup_read >= pr.seq_tup_read + cl.reltuples,
       st.idx_scan >= pr.idx_scan + 1,
       st.idx_tup_fetch >= pr.idx_tup_fetch + 1
  FROM pg_stat_user_tables AS st, pg_class AS cl, prevstats AS pr
 WHERE st.relname='tenk2' AND cl.relname='tenk2';
RESULT:
	mySQL: ERROR - (1146, "Table 'test.pg_stat_user_tables' doesn't exist")

-----------
QUERY:


SELECT st.heap_blks_read + st.heap_blks_hit >= pr.heap_blks + cl.relpages,
       st.idx_blks_read + st.idx_blks_hit >= pr.idx_blks + 1
  FROM pg_statio_user_tables AS st, pg_class AS cl, prevstats AS pr
 WHERE st.relname='tenk2' AND cl.relname='tenk2';
RESULT:
	mySQL: ERROR - (1146, "Table 'test.pg_statio_user_tables' doesn't exist")

-----------
QUERY:


SELECT pr.snap_ts < pg_stat_get_snapshot_timestamp() as snapshot_newer
FROM prevstats AS pr;
RESULT:
	mySQL: ERROR - (1146, "Table 'test.prevstats' doesn't exist")

-----------
QUERY:


COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:


----
-- Basic tests for track_functions
---
CREATE FUNCTION stats_test_func1() RETURNS VOID LANGUAGE plpgsql AS $$BEGIN END;$$;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '----\n-- Basic tests for track_functions\n---\nCREATE FUNCTION stats_test_func1() R' at line 1")

-----------
QUERY:

SELECT 'stats_test_func1()'::regprocedure::oid AS stats_test_func1_oid \gset
CREATE FUNCTION stats_test_func2() RETURNS VOID LANGUAGE plpgsql AS $$BEGIN END;$$;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regprocedure::oid AS stats_test_func1_oid \\gset\nCREATE FUNCTION stats_test_fun' at line 1")

-----------
QUERY:

SELECT 'stats_test_func2()'::regprocedure::oid AS stats_test_func2_oid \gset

-- test that stats are accumulated
BEGIN;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regprocedure::oid AS stats_test_func2_oid \\gset\n\n-- test that stats are accumu' at line 1")

-----------
QUERY:

SET LOCAL stats_fetch_consistency = none;
RESULT:
	mySQL: ERROR - (1193, "Unknown system variable 'stats_fetch_consistency'")

-----------
QUERY:

SELECT pg_stat_get_function_calls(:stats_test_func1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid)' at line 1")

-----------
QUERY:

SELECT pg_stat_get_xact_function_calls(:stats_test_func1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid)' at line 1")

-----------
QUERY:

SELECT stats_test_func1();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.stats_test_func1 does not exist')

-----------
QUERY:

SELECT pg_stat_get_xact_function_calls(:stats_test_func1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid)' at line 1")

-----------
QUERY:

SELECT stats_test_func1();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.stats_test_func1 does not exist')

-----------
QUERY:

SELECT pg_stat_get_xact_function_calls(:stats_test_func1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid)' at line 1")

-----------
QUERY:

SELECT pg_stat_get_function_calls(:stats_test_func1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid)' at line 1")

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:


-- Verify that function stats are not transactional

-- rolled back savepoint in committing transaction
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT stats_test_func2();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.stats_test_func2 does not exist')

-----------
QUERY:

SAVEPOINT foo;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT stats_test_func2();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.stats_test_func2 does not exist')

-----------
QUERY:

ROLLBACK TO SAVEPOINT foo;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_get_xact_function_calls(:stats_test_func2_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func2_oid)' at line 1")

-----------
QUERY:

SELECT stats_test_func2();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.stats_test_func2 does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:


-- rolled back transaction
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT stats_test_func2();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.stats_test_func2 does not exist')

-----------
QUERY:

ROLLBACK;
RESULT:
	mySQL: []

-----------
QUERY:


SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:


-- check collected stats
SELECT funcname, calls FROM pg_stat_user_functions WHERE funcid = :stats_test_func1_oid;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid' at line 2")

-----------
QUERY:

SELECT funcname, calls FROM pg_stat_user_functions WHERE funcid = :stats_test_func2_oid;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func2_oid' at line 1")

-----------
QUERY:



-- check that a rolled back drop function stats leaves stats alive
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT funcname, calls FROM pg_stat_user_functions WHERE funcid = :stats_test_func1_oid;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid' at line 1")

-----------
QUERY:

DROP FUNCTION stats_test_func1();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:

-- shouldn/* REPLACED */''t be visible via view
SELECT funcname, calls FROM pg_stat_user_functions WHERE funcid = :stats_test_func1_oid;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid' at line 2")

-----------
QUERY:

-- but still via oid access
SELECT pg_stat_get_function_calls(:stats_test_func1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid)' at line 2")

-----------
QUERY:

ROLLBACK;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT funcname, calls FROM pg_stat_user_functions WHERE funcid = :stats_test_func1_oid;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid' at line 1")

-----------
QUERY:

SELECT pg_stat_get_function_calls(:stats_test_func1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid)' at line 1")

-----------
QUERY:



-- check that function dropped in main transaction leaves no stats behind
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

DROP FUNCTION stats_test_func1();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT funcname, calls FROM pg_stat_user_functions WHERE funcid = :stats_test_func1_oid;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid' at line 1")

-----------
QUERY:

SELECT pg_stat_get_function_calls(:stats_test_func1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func1_oid)' at line 1")

-----------
QUERY:


-- check that function dropped in a subtransaction leaves no stats behind
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT stats_test_func2();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.stats_test_func2 does not exist')

-----------
QUERY:

SAVEPOINT a;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT stats_test_func2();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.stats_test_func2 does not exist')

-----------
QUERY:

SAVEPOINT b;
RESULT:
	mySQL: []

-----------
QUERY:

DROP FUNCTION stats_test_func2();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT funcname, calls FROM pg_stat_user_functions WHERE funcid = :stats_test_func2_oid;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func2_oid' at line 1")

-----------
QUERY:

SELECT pg_stat_get_function_calls(:stats_test_func2_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':stats_test_func2_oid)' at line 1")

-----------
QUERY:



-- Check that stats for relations are dropped. For that we need to access stats
-- by oid after the DROP TABLE. Save oids.
CREATE TABLE drop_stats_test();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 3")

-----------
QUERY:

INSERT INTO drop_stats_test DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

SELECT 'drop_stats_test'::regclass::oid AS drop_stats_test_oid \gset

CREATE TABLE drop_stats_test_xact();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass::oid AS drop_stats_test_oid \\gset\n\nCREATE TABLE drop_stats_test_xact(' at line 1")

-----------
QUERY:

INSERT INTO drop_stats_test_xact DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

SELECT 'drop_stats_test_xact'::regclass::oid AS drop_stats_test_xact_oid \gset

CREATE TABLE drop_stats_test_subxact();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass::oid AS drop_stats_test_xact_oid \\gset\n\nCREATE TABLE drop_stats_test_' at line 1")

-----------
QUERY:

INSERT INTO drop_stats_test_subxact DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

SELECT 'drop_stats_test_subxact'::regclass::oid AS drop_stats_test_subxact_oid \gset

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass::oid AS drop_stats_test_subxact_oid \\gset\n\nSELECT pg_stat_force_next_' at line 1")

-----------
QUERY:


SELECT pg_stat_get_live_tuples(:drop_stats_test_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_oid)' at line 1")

-----------
QUERY:

DROP TABLE drop_stats_test;
RESULT:
	mySQL: ERROR - (1051, "Unknown table 'test.drop_stats_test'")

-----------
QUERY:

SELECT pg_stat_get_live_tuples(:drop_stats_test_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_oid)' at line 1")

-----------
QUERY:

SELECT pg_stat_get_xact_tuples_inserted(:drop_stats_test_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_oid)' at line 1")

-----------
QUERY:


-- check that rollback protects against having stats dropped and that local
-- modifications don/* REPLACED */''t pose a problem
SELECT pg_stat_get_live_tuples(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 3")

-----------
QUERY:

SELECT pg_stat_get_tuples_inserted(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 1")

-----------
QUERY:

SELECT pg_stat_get_xact_tuples_inserted(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 1")

-----------
QUERY:

BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO drop_stats_test_xact DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

SELECT pg_stat_get_xact_tuples_inserted(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 1")

-----------
QUERY:

DROP TABLE drop_stats_test_xact;
RESULT:
	mySQL: ERROR - (1051, "Unknown table 'test.drop_stats_test_xact'")

-----------
QUERY:

SELECT pg_stat_get_xact_tuples_inserted(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

SELECT pg_stat_get_live_tuples(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 1")

-----------
QUERY:

SELECT pg_stat_get_tuples_inserted(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 1")

-----------
QUERY:


-- transactional drop
SELECT pg_stat_get_live_tuples(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 2")

-----------
QUERY:

SELECT pg_stat_get_tuples_inserted(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 1")

-----------
QUERY:

BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO drop_stats_test_xact DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

SELECT pg_stat_get_xact_tuples_inserted(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 1")

-----------
QUERY:

DROP TABLE drop_stats_test_xact;
RESULT:
	mySQL: ERROR - (1051, "Unknown table 'test.drop_stats_test_xact'")

-----------
QUERY:

SELECT pg_stat_get_xact_tuples_inserted(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 1")

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

SELECT pg_stat_get_live_tuples(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 1")

-----------
QUERY:

SELECT pg_stat_get_tuples_inserted(:drop_stats_test_xact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_xact_oid)' at line 1")

-----------
QUERY:


-- savepoint rollback (2 levels)
SELECT pg_stat_get_live_tuples(:drop_stats_test_subxact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_subxact_oid)' at line 2")

-----------
QUERY:

BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO drop_stats_test_subxact DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

SAVEPOINT sp1;
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO drop_stats_test_subxact DEFAULT VALUES;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT VALUES' at line 1")

-----------
QUERY:

SELECT pg_stat_get_xact_tuples_inserted(:drop_stats_test_subxact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_subxact_oid)' at line 1")

-----------
QUERY:

SAVEPOINT sp2;
RESULT:
	mySQL: []

-----------
QUERY:

DROP TABLE drop_stats_test_subxact;
RESULT:
	mySQL: ERROR - (1051, "Unknown table 'test.drop_stats_test_subxact'")

-----------
QUERY:

ROLLBACK TO SAVEPOINT sp2;
RESULT:
	mySQL: ERROR - (1305, 'SAVEPOINT sp2 does not exist')

-----------
QUERY:

SELECT pg_stat_get_xact_tuples_inserted(:drop_stats_test_subxact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_subxact_oid)' at line 1")

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

SELECT pg_stat_get_live_tuples(:drop_stats_test_subxact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_subxact_oid)' at line 1")

-----------
QUERY:


-- savepoint rolback (1 level)
SELECT pg_stat_get_live_tuples(:drop_stats_test_subxact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_subxact_oid)' at line 2")

-----------
QUERY:

BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SAVEPOINT sp1;
RESULT:
	mySQL: []

-----------
QUERY:

DROP TABLE drop_stats_test_subxact;
RESULT:
	mySQL: ERROR - (1051, "Unknown table 'test.drop_stats_test_subxact'")

-----------
QUERY:

SAVEPOINT sp2;
RESULT:
	mySQL: []

-----------
QUERY:

ROLLBACK TO SAVEPOINT sp1;
RESULT:
	mySQL: ERROR - (1305, 'SAVEPOINT sp1 does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_get_live_tuples(:drop_stats_test_subxact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_subxact_oid)' at line 1")

-----------
QUERY:


-- and now actually drop
SELECT pg_stat_get_live_tuples(:drop_stats_test_subxact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_subxact_oid)' at line 2")

-----------
QUERY:

BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SAVEPOINT sp1;
RESULT:
	mySQL: []

-----------
QUERY:

DROP TABLE drop_stats_test_subxact;
RESULT:
	mySQL: ERROR - (1051, "Unknown table 'test.drop_stats_test_subxact'")

-----------
QUERY:

SAVEPOINT sp2;
RESULT:
	mySQL: []

-----------
QUERY:

RELEASE SAVEPOINT sp1;
RESULT:
	mySQL: ERROR - (1305, 'SAVEPOINT sp1 does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_get_live_tuples(:drop_stats_test_subxact_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':drop_stats_test_subxact_oid)' at line 1")

-----------
QUERY:


DROP TABLE trunc_stats_test, trunc_stats_test1, trunc_stats_test2, trunc_stats_test3, trunc_stats_test4;
RESULT:
	mySQL: []

-----------
QUERY:

DROP TABLE prevstats;
RESULT:
	mySQL: ERROR - (1051, "Unknown table 'test.prevstats'")

-----------
QUERY:



-----
-- Test that last_seq_scan, last_idx_scan are correctly maintained
--
-- Perform test using a temporary table. That way autovacuum etc won/* REPLACED */''t
-- interfere. To be able to check that timestamps increase, we sleep for 100ms
-- between tests, assuming that there aren/* REPLACED */''t systems with a coarser timestamp
-- granularity.
-----

BEGIN;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '-----\n-- Test that last_seq_scan, last_idx_scan are correctly maintained\n--\n-- P' at line 1")

-----------
QUERY:

CREATE TEMPORARY TABLE test_last_scan(idx_col int primary key, noidx_col int);
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO test_last_scan(idx_col, noidx_col) VALUES(1, 1);
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

SELECT last_seq_scan, last_idx_scan FROM pg_stat_all_tables WHERE relid = 'test_last_scan'::regclass;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass' at line 1")

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:


SELECT pg_stat_reset_single_table_counters('test_last_scan'::regclass);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass)' at line 1")

-----------
QUERY:

SELECT seq_scan, idx_scan FROM pg_stat_all_tables WHERE relid = 'test_last_scan'::regclass;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass' at line 1")

-----------
QUERY:


-- ensure we start out with exactly one index and sequential scan
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SET LOCAL enable_seqscan TO on;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO on' at line 1")

-----------
QUERY:

SET LOCAL enable_indexscan TO on;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO on' at line 1")

-----------
QUERY:

SET LOCAL enable_bitmapscan TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 1")

-----------
QUERY:

EXPLAIN (COSTS off) SELECT count(*) FROM test_last_scan WHERE noidx_col = 1;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS off) SELECT count(*) FROM test_last_scan WHERE noidx_col = 1' at line 1")

-----------
QUERY:

SELECT count(*) FROM test_last_scan WHERE noidx_col = 1;
RESULT:
	mySQL: ((1,),)

-----------
QUERY:

SET LOCAL enable_seqscan TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 1")

-----------
QUERY:

EXPLAIN (COSTS off) SELECT count(*) FROM test_last_scan WHERE idx_col = 1;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS off) SELECT count(*) FROM test_last_scan WHERE idx_col = 1' at line 1")

-----------
QUERY:

SELECT count(*) FROM test_last_scan WHERE idx_col = 1;
RESULT:
	mySQL: ((1,),)

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:


-- fetch timestamps from before the next test
SELECT last_seq_scan AS test_last_seq, last_idx_scan AS test_last_idx
FROM pg_stat_all_tables WHERE relid = 'test_last_scan'::regclass \gset
SELECT pg_sleep(0.1);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass \\gset\nSELECT pg_sleep(0.1)' at line 3")

-----------
QUERY:
 -- assume a minimum timestamp granularity of 100ms

-- cause one sequential scan
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SET LOCAL enable_seqscan TO on;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO on' at line 1")

-----------
QUERY:

SET LOCAL enable_indexscan TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 1")

-----------
QUERY:

SET LOCAL enable_bitmapscan TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 1")

-----------
QUERY:

EXPLAIN (COSTS off) SELECT count(*) FROM test_last_scan WHERE noidx_col = 1;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS off) SELECT count(*) FROM test_last_scan WHERE noidx_col = 1' at line 1")

-----------
QUERY:

SELECT count(*) FROM test_last_scan WHERE noidx_col = 1;
RESULT:
	mySQL: ((1,),)

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:

-- check that just sequential scan stats were incremented
SELECT seq_scan, :'test_last_seq' < last_seq_scan AS seq_ok, idx_scan, :'test_last_idx' = last_idx_scan AS idx_ok
FROM pg_stat_all_tables WHERE relid = 'test_last_scan'::regclass;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'test_last_seq' < last_seq_scan AS seq_ok, idx_scan, :'test_last_idx' = last_id' at line 2")

-----------
QUERY:


-- fetch timestamps from before the next test
SELECT last_seq_scan AS test_last_seq, last_idx_scan AS test_last_idx
FROM pg_stat_all_tables WHERE relid = 'test_last_scan'::regclass \gset
SELECT pg_sleep(0.1);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass \\gset\nSELECT pg_sleep(0.1)' at line 3")

-----------
QUERY:


-- cause one index scan
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SET LOCAL enable_seqscan TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 1")

-----------
QUERY:

SET LOCAL enable_indexscan TO on;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO on' at line 1")

-----------
QUERY:

SET LOCAL enable_bitmapscan TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 1")

-----------
QUERY:

EXPLAIN (COSTS off) SELECT count(*) FROM test_last_scan WHERE idx_col = 1;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS off) SELECT count(*) FROM test_last_scan WHERE idx_col = 1' at line 1")

-----------
QUERY:

SELECT count(*) FROM test_last_scan WHERE idx_col = 1;
RESULT:
	mySQL: ((1,),)

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:

-- check that just index scan stats were incremented
SELECT seq_scan, :'test_last_seq' = last_seq_scan AS seq_ok, idx_scan, :'test_last_idx' < last_idx_scan AS idx_ok
FROM pg_stat_all_tables WHERE relid = 'test_last_scan'::regclass;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'test_last_seq' = last_seq_scan AS seq_ok, idx_scan, :'test_last_idx' < last_id' at line 2")

-----------
QUERY:


-- fetch timestamps from before the next test
SELECT last_seq_scan AS test_last_seq, last_idx_scan AS test_last_idx
FROM pg_stat_all_tables WHERE relid = 'test_last_scan'::regclass \gset
SELECT pg_sleep(0.1);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass \\gset\nSELECT pg_sleep(0.1)' at line 3")

-----------
QUERY:


-- cause one bitmap index scan
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SET LOCAL enable_seqscan TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 1")

-----------
QUERY:

SET LOCAL enable_indexscan TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 1")

-----------
QUERY:

SET LOCAL enable_bitmapscan TO on;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO on' at line 1")

-----------
QUERY:

EXPLAIN (COSTS off) SELECT count(*) FROM test_last_scan WHERE idx_col = 1;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS off) SELECT count(*) FROM test_last_scan WHERE idx_col = 1' at line 1")

-----------
QUERY:

SELECT count(*) FROM test_last_scan WHERE idx_col = 1;
RESULT:
	mySQL: ((1,),)

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:

-- check that just index scan stats were incremented
SELECT seq_scan, :'test_last_seq' = last_seq_scan AS seq_ok, idx_scan, :'test_last_idx' < last_idx_scan AS idx_ok
FROM pg_stat_all_tables WHERE relid = 'test_last_scan'::regclass;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'test_last_seq' = last_seq_scan AS seq_ok, idx_scan, :'test_last_idx' < last_id' at line 2")

-----------
QUERY:


-----
-- Test reset of some stats for shared table
-----

-- This updates the comment of the database currently in use in
-- pg_shdescription with a fake value, then sets it back to its
-- original value.
SELECT shobj_description(d.oid, 'pg_database') as description_before
  FROM pg_database d WHERE datname = current_database() \gset

-- force some stats in pg_shdescription.
BEGIN;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '-----\n-- Test reset of some stats for shared table\n-----\n\n-- This updates the co' at line 1")

-----------
QUERY:

SELECT current_database() as datname \gset
COMMENT ON DATABASE :"datname" IS 'This is a test comment';
RESULT:
	mySQL: ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'\\gset\nCOMMENT ON DATABASE :"datname" IS \'This is a test comment\'\' at line 1')

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:


-- check that the stats are reset.
SELECT (n_tup_ins + n_tup_upd) > 0 AS has_data FROM pg_stat_all_tables
  WHERE relid = 'pg_shdescription'::regclass;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass' at line 3")

-----------
QUERY:

SELECT pg_stat_reset_single_table_counters('pg_shdescription'::regclass);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass)' at line 1")

-----------
QUERY:

SELECT (n_tup_ins + n_tup_upd) > 0 AS has_data FROM pg_stat_all_tables
  WHERE relid = 'pg_shdescription'::regclass;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass' at line 2")

-----------
QUERY:


-- set back comment
\if :{?description_before}
  COMMENT ON DATABASE :"datname" IS :'description_before';
RESULT:
	mySQL: ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'\\if :{?description_before}\n  COMMENT ON DATABASE :"datname" IS :\'description_bef\' at line 2')

-----------
QUERY:

\else
  COMMENT ON DATABASE :"datname" IS NULL;
RESULT:
	mySQL: ERROR - (1064, 'You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'\\else\n  COMMENT ON DATABASE :"datname" IS NULL\' at line 1')

-----------
QUERY:

\endif

-----
-- Test that various stats views are being properly populated
-----

-- Test that sessions is incremented when a new session is started in pg_stat_database
SELECT sessions AS db_stat_sessions FROM pg_stat_database WHERE datname = (SELECT current_database()) \gset
\c
SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\endif\n\n-----\n-- Test that various stats views are being properly populated\n----' at line 1")

-----------
QUERY:

SELECT sessions > :db_stat_sessions FROM pg_stat_database WHERE datname = (SELECT current_database());
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':db_stat_sessions FROM pg_stat_database WHERE datname = (SELECT current_database' at line 1")

-----------
QUERY:


-- Test pg_stat_checkpointer checkpointer-related stats, together with pg_stat_wal
SELECT num_requested AS rqst_ckpts_before FROM pg_stat_checkpointer \gset

-- Test pg_stat_wal (and make a temp table so our temp schema exists)
SELECT wal_bytes AS wal_bytes_before FROM pg_stat_wal \gset

CREATE TEMP TABLE test_stats_temp AS SELECT 17;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\n\n-- Test pg_stat_wal (and make a temp table so our temp schema exists)\nSEL' at line 2")

-----------
QUERY:

DROP TABLE test_stats_temp;
RESULT:
	mySQL: ERROR - (1051, "Unknown table 'test.test_stats_temp'")

-----------
QUERY:


-- Checkpoint twice: The checkpointer reports stats after reporting completion
-- of the checkpoint. But after a second checkpoint we/* REPLACED */''ll see at least the
-- results of the first.
CHECKPOINT;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CHECKPOINT' at line 4")

-----------
QUERY:

CHECKPOINT;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CHECKPOINT' at line 1")

-----------
QUERY:


SELECT num_requested > :rqst_ckpts_before FROM pg_stat_checkpointer;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':rqst_ckpts_before FROM pg_stat_checkpointer' at line 1")

-----------
QUERY:

SELECT wal_bytes > :wal_bytes_before FROM pg_stat_wal;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':wal_bytes_before FROM pg_stat_wal' at line 1")

-----------
QUERY:


-- Test pg_stat_get_backend_idset() and some allied functions.
-- In particular, verify that their notion of backend ID matches
-- our temp schema index.
SELECT (current_schemas(true))[1] = ('pg_temp_' || beid::text) AS match
FROM pg_stat_get_backend_idset() beid
WHERE pg_stat_get_backend_pid(beid) = pg_backend_pid();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '[1] = ('pg_temp_' || beid::text) AS match\nFROM pg_stat_get_backend_idset() beid\n' at line 4")

-----------
QUERY:


-----
-- Test that resetting stats works for reset timestamp
-----

-- Test that reset_slru with a specified SLRU works.
SELECT stats_reset AS slru_commit_ts_reset_ts FROM pg_stat_slru WHERE name = 'commit_timestamp' \gset
SELECT stats_reset AS slru_notify_reset_ts FROM pg_stat_slru WHERE name = 'notify' \gset
SELECT pg_stat_reset_slru('commit_timestamp');
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '-----\n-- Test that resetting stats works for reset timestamp\n-----\n\n-- Test that' at line 1")

-----------
QUERY:

SELECT stats_reset > :'slru_commit_ts_reset_ts'::timestamptz FROM pg_stat_slru WHERE name = 'commit_timestamp';
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'slru_commit_ts_reset_ts'::timestamptz FROM pg_stat_slru WHERE name = 'commit_t' at line 1")

-----------
QUERY:

SELECT stats_reset AS slru_commit_ts_reset_ts FROM pg_stat_slru WHERE name = 'commit_timestamp' \gset

-- Test that multiple SLRUs are reset when no specific SLRU provided to reset function
SELECT pg_stat_reset_slru();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\n\n-- Test that multiple SLRUs are reset when no specific SLRU provided to r' at line 1")

-----------
QUERY:

SELECT stats_reset > :'slru_commit_ts_reset_ts'::timestamptz FROM pg_stat_slru WHERE name = 'commit_timestamp';
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'slru_commit_ts_reset_ts'::timestamptz FROM pg_stat_slru WHERE name = 'commit_t' at line 1")

-----------
QUERY:

SELECT stats_reset > :'slru_notify_reset_ts'::timestamptz FROM pg_stat_slru WHERE name = 'notify';
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'slru_notify_reset_ts'::timestamptz FROM pg_stat_slru WHERE name = 'notify'' at line 1")

-----------
QUERY:


-- Test that reset_shared with archiver specified as the stats type works
SELECT stats_reset AS archiver_reset_ts FROM pg_stat_archiver \gset
SELECT pg_stat_reset_shared('archiver');
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT pg_stat_reset_shared('archiver')' at line 2")

-----------
QUERY:

SELECT stats_reset > :'archiver_reset_ts'::timestamptz FROM pg_stat_archiver;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'archiver_reset_ts'::timestamptz FROM pg_stat_archiver' at line 1")

-----------
QUERY:


-- Test that reset_shared with bgwriter specified as the stats type works
SELECT stats_reset AS bgwriter_reset_ts FROM pg_stat_bgwriter \gset
SELECT pg_stat_reset_shared('bgwriter');
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT pg_stat_reset_shared('bgwriter')' at line 2")

-----------
QUERY:

SELECT stats_reset > :'bgwriter_reset_ts'::timestamptz FROM pg_stat_bgwriter;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'bgwriter_reset_ts'::timestamptz FROM pg_stat_bgwriter' at line 1")

-----------
QUERY:


-- Test that reset_shared with checkpointer specified as the stats type works
SELECT stats_reset AS checkpointer_reset_ts FROM pg_stat_checkpointer \gset
SELECT pg_stat_reset_shared('checkpointer');
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT pg_stat_reset_shared('checkpointer')' at line 2")

-----------
QUERY:

SELECT stats_reset > :'checkpointer_reset_ts'::timestamptz FROM pg_stat_checkpointer;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'checkpointer_reset_ts'::timestamptz FROM pg_stat_checkpointer' at line 1")

-----------
QUERY:


-- Test that reset_shared with recovery_prefetch specified as the stats type works
SELECT stats_reset AS recovery_prefetch_reset_ts FROM pg_stat_recovery_prefetch \gset
SELECT pg_stat_reset_shared('recovery_prefetch');
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT pg_stat_reset_shared('recovery_prefetch')' at line 2")

-----------
QUERY:

SELECT stats_reset > :'recovery_prefetch_reset_ts'::timestamptz FROM pg_stat_recovery_prefetch;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'recovery_prefetch_reset_ts'::timestamptz FROM pg_stat_recovery_prefetch' at line 1")

-----------
QUERY:


-- Test that reset_shared with slru specified as the stats type works
SELECT max(stats_reset) AS slru_reset_ts FROM pg_stat_slru \gset
SELECT pg_stat_reset_shared('slru');
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT pg_stat_reset_shared('slru')' at line 2")

-----------
QUERY:

SELECT max(stats_reset) > :'slru_reset_ts'::timestamptz FROM pg_stat_slru;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'slru_reset_ts'::timestamptz FROM pg_stat_slru' at line 1")

-----------
QUERY:


-- Test that reset_shared with wal specified as the stats type works
SELECT stats_reset AS wal_reset_ts FROM pg_stat_wal \gset
SELECT pg_stat_reset_shared('wal');
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT pg_stat_reset_shared('wal')' at line 2")

-----------
QUERY:

SELECT stats_reset > :'wal_reset_ts'::timestamptz FROM pg_stat_wal;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'wal_reset_ts'::timestamptz FROM pg_stat_wal' at line 1")

-----------
QUERY:


-- Test error case for reset_shared with unknown stats type
SELECT pg_stat_reset_shared('unknown');
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_reset_shared does not exist')

-----------
QUERY:


-- Test that reset works for pg_stat_database

-- Since pg_stat_database stats_reset starts out as NULL, reset it once first so we have something to compare it to
SELECT pg_stat_reset();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_reset does not exist')

-----------
QUERY:

SELECT stats_reset AS db_reset_ts FROM pg_stat_database WHERE datname = (SELECT current_database()) \gset
SELECT pg_stat_reset();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT pg_stat_reset()' at line 1")

-----------
QUERY:

SELECT stats_reset > :'db_reset_ts'::timestamptz FROM pg_stat_database WHERE datname = (SELECT current_database());
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':'db_reset_ts'::timestamptz FROM pg_stat_database WHERE datname = (SELECT curren' at line 1")

-----------
QUERY:



----
-- pg_stat_get_snapshot_timestamp behavior
----
BEGIN;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '----\n-- pg_stat_get_snapshot_timestamp behavior\n----\nBEGIN' at line 1")

-----------
QUERY:

SET LOCAL stats_fetch_consistency = snapshot;
RESULT:
	mySQL: ERROR - (1193, "Unknown system variable 'stats_fetch_consistency'")

-----------
QUERY:

-- no snapshot yet, return NULL
SELECT pg_stat_get_snapshot_timestamp();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_snapshot_timestamp does not exist')

-----------
QUERY:

-- any attempt at accessing stats will build snapshot
SELECT pg_stat_get_function_calls(0);
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_function_calls does not exist')

-----------
QUERY:

SELECT pg_stat_get_snapshot_timestamp() >= NOW();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_snapshot_timestamp does not exist')

-----------
QUERY:

-- shows NULL again after clearing
SELECT pg_stat_clear_snapshot();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_clear_snapshot does not exist')

-----------
QUERY:

SELECT pg_stat_get_snapshot_timestamp();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_snapshot_timestamp does not exist')

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:


----
-- Changing stats_fetch_consistency in a transaction.
----
BEGIN;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '----\n-- Changing stats_fetch_consistency in a transaction.\n----\nBEGIN' at line 1")

-----------
QUERY:

-- Stats filled under the cache mode
SET LOCAL stats_fetch_consistency = cache;
RESULT:
	mySQL: ERROR - (1193, "Unknown system variable 'stats_fetch_consistency'")

-----------
QUERY:

SELECT pg_stat_get_function_calls(0);
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_function_calls does not exist')

-----------
QUERY:

SELECT pg_stat_get_snapshot_timestamp() IS NOT NULL AS snapshot_ok;
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_snapshot_timestamp does not exist')

-----------
QUERY:

-- Success in accessing pre-existing snapshot data.
SET LOCAL stats_fetch_consistency = snapshot;
RESULT:
	mySQL: ERROR - (1193, "Unknown system variable 'stats_fetch_consistency'")

-----------
QUERY:

SELECT pg_stat_get_snapshot_timestamp() IS NOT NULL AS snapshot_ok;
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_snapshot_timestamp does not exist')

-----------
QUERY:

SELECT pg_stat_get_function_calls(0);
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_function_calls does not exist')

-----------
QUERY:

SELECT pg_stat_get_snapshot_timestamp() IS NOT NULL AS snapshot_ok;
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_snapshot_timestamp does not exist')

-----------
QUERY:

-- Snapshot cleared.
SET LOCAL stats_fetch_consistency = none;
RESULT:
	mySQL: ERROR - (1193, "Unknown system variable 'stats_fetch_consistency'")

-----------
QUERY:

SELECT pg_stat_get_snapshot_timestamp() IS NOT NULL AS snapshot_ok;
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_snapshot_timestamp does not exist')

-----------
QUERY:

SELECT pg_stat_get_function_calls(0);
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_function_calls does not exist')

-----------
QUERY:

SELECT pg_stat_get_snapshot_timestamp() IS NOT NULL AS snapshot_ok;
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_snapshot_timestamp does not exist')

-----------
QUERY:

ROLLBACK;
RESULT:
	mySQL: []

-----------
QUERY:


----
-- pg_stat_have_stats behavior
----
-- fixed-numbered stats exist
SELECT pg_stat_have_stats('bgwriter', 0, 0);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '----\n-- pg_stat_have_stats behavior\n----\n-- fixed-numbered stats exist\nSELECT pg' at line 1")

-----------
QUERY:

-- unknown stats kinds error out
SELECT pg_stat_have_stats('zaphod', 0, 0);
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_have_stats does not exist')

-----------
QUERY:

-- db stats have objoid 0
SELECT pg_stat_have_stats('database', :dboid, 1);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':dboid, 1)' at line 2")

-----------
QUERY:

SELECT pg_stat_have_stats('database', :dboid, 0);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':dboid, 0)' at line 1")

-----------
QUERY:


-- pg_stat_have_stats returns true for committed index creation
CREATE table stats_test_tab1 as select generate_series(1,10) a;
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.generate_series does not exist')

-----------
QUERY:

CREATE index stats_test_idx1 on stats_test_tab1(a);
RESULT:
	mySQL: ERROR - (1146, "Table 'test.stats_test_tab1' doesn't exist")

-----------
QUERY:

SELECT 'stats_test_idx1'::regclass::oid AS stats_test_idx1_oid \gset
SET enable_seqscan TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass::oid AS stats_test_idx1_oid \\gset\nSET enable_seqscan TO off' at line 1")

-----------
QUERY:

select a from stats_test_tab1 where a = 3;
RESULT:
	mySQL: ERROR - (1146, "Table 'test.stats_test_tab1' doesn't exist")

-----------
QUERY:

SELECT pg_stat_have_stats('relation', :dboid, :stats_test_idx1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':dboid, :stats_test_idx1_oid)' at line 1")

-----------
QUERY:


-- pg_stat_have_stats returns false for dropped index with stats
SELECT pg_stat_have_stats('relation', :dboid, :stats_test_idx1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':dboid, :stats_test_idx1_oid)' at line 2")

-----------
QUERY:

DROP index stats_test_idx1;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1")

-----------
QUERY:

SELECT pg_stat_have_stats('relation', :dboid, :stats_test_idx1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':dboid, :stats_test_idx1_oid)' at line 1")

-----------
QUERY:


-- pg_stat_have_stats returns false for rolled back index creation
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

CREATE index stats_test_idx1 on stats_test_tab1(a);
RESULT:
	mySQL: ERROR - (1146, "Table 'test.stats_test_tab1' doesn't exist")

-----------
QUERY:

SELECT 'stats_test_idx1'::regclass::oid AS stats_test_idx1_oid \gset
select a from stats_test_tab1 where a = 3;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass::oid AS stats_test_idx1_oid \\gset\nselect a from stats_test_tab1 where' at line 1")

-----------
QUERY:

SELECT pg_stat_have_stats('relation', :dboid, :stats_test_idx1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':dboid, :stats_test_idx1_oid)' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_have_stats('relation', :dboid, :stats_test_idx1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':dboid, :stats_test_idx1_oid)' at line 1")

-----------
QUERY:


-- pg_stat_have_stats returns true for reindex CONCURRENTLY
CREATE index stats_test_idx1 on stats_test_tab1(a);
RESULT:
	mySQL: ERROR - (1146, "Table 'test.stats_test_tab1' doesn't exist")

-----------
QUERY:

SELECT 'stats_test_idx1'::regclass::oid AS stats_test_idx1_oid \gset
select a from stats_test_tab1 where a = 3;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass::oid AS stats_test_idx1_oid \\gset\nselect a from stats_test_tab1 where' at line 1")

-----------
QUERY:

SELECT pg_stat_have_stats('relation', :dboid, :stats_test_idx1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':dboid, :stats_test_idx1_oid)' at line 1")

-----------
QUERY:

REINDEX index CONCURRENTLY stats_test_idx1;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'REINDEX index CONCURRENTLY stats_test_idx1' at line 1")

-----------
QUERY:

-- false for previous oid
SELECT pg_stat_have_stats('relation', :dboid, :stats_test_idx1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':dboid, :stats_test_idx1_oid)' at line 2")

-----------
QUERY:

-- true for new oid
SELECT 'stats_test_idx1'::regclass::oid AS stats_test_idx1_oid \gset
SELECT pg_stat_have_stats('relation', :dboid, :stats_test_idx1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass::oid AS stats_test_idx1_oid \\gset\nSELECT pg_stat_have_stats('relation' at line 2")

-----------
QUERY:


-- pg_stat_have_stats returns true for a rolled back drop index with stats
BEGIN;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_have_stats('relation', :dboid, :stats_test_idx1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':dboid, :stats_test_idx1_oid)' at line 1")

-----------
QUERY:

DROP index stats_test_idx1;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_have_stats('relation', :dboid, :stats_test_idx1_oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':dboid, :stats_test_idx1_oid)' at line 1")

-----------
QUERY:


-- put enable_seqscan back to on
SET enable_seqscan TO on;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO on' at line 2")

-----------
QUERY:


-- ensure that stats accessors handle NULL input correctly
SELECT pg_stat_get_replication_slot(NULL);
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_replication_slot does not exist')

-----------
QUERY:

SELECT pg_stat_get_subscription_stats(NULL);
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_get_subscription_stats does not exist')

-----------
QUERY:



-- Test that the following operations are tracked in pg_stat_io:
-- - reads of target blocks into shared buffers
-- - writes of shared buffers to permanent storage
-- - extends of relations using shared buffers
-- - fsyncs done to ensure the durability of data dirtying shared buffers
-- - shared buffer hits

-- There is no test for blocks evicted from shared buffers, because we cannot
-- be sure of the state of shared buffers at the point the test is run.

-- Create a regular table and insert some data to generate IOCONTEXT_NORMAL
-- extends.
SELECT sum(extends) AS io_sum_shared_before_extends
  FROM pg_stat_io WHERE context = 'normal' AND object = 'relation' \gset
SELECT sum(writes) AS writes, sum(fsyncs) AS fsyncs
  FROM pg_stat_io
  WHERE object = 'relation' \gset io_sum_shared_before_
CREATE TABLE test_io_shared(a int);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT sum(writes) AS writes, sum(fsyncs) AS fsyncs\n  FROM pg_stat_io\n  WH' at line 14")

-----------
QUERY:

INSERT INTO test_io_shared SELECT i FROM generate_series(1,100)i;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(1,100)i' at line 1")

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

SELECT sum(extends) AS io_sum_shared_after_extends
  FROM pg_stat_io WHERE context = 'normal' AND object = 'relation' \gset
SELECT :io_sum_shared_after_extends > :io_sum_shared_before_extends;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT :io_sum_shared_after_extends > :io_sum_shared_before_extends' at line 2")

-----------
QUERY:


-- After a checkpoint, there should be some additional IOCONTEXT_NORMAL writes
-- and fsyncs.
-- See comment above for rationale for two explicit CHECKPOINTs.
CHECKPOINT;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CHECKPOINT' at line 4")

-----------
QUERY:

CHECKPOINT;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CHECKPOINT' at line 1")

-----------
QUERY:

SELECT sum(writes) AS writes, sum(fsyncs) AS fsyncs
  FROM pg_stat_io
  WHERE object = 'relation' \gset io_sum_shared_after_
SELECT :io_sum_shared_after_writes > :io_sum_shared_before_writes;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset io_sum_shared_after_\nSELECT :io_sum_shared_after_writes > :io_sum_shared_b' at line 3")

-----------
QUERY:

SELECT current_setting('fsync') = 'off'
  OR :io_sum_shared_after_fsyncs > :io_sum_shared_before_fsyncs;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':io_sum_shared_after_fsyncs > :io_sum_shared_before_fsyncs' at line 2")

-----------
QUERY:


-- Change the tablespace so that the table is rewritten directly, then SELECT
-- from it to cause it to be read back into shared buffers.
SELECT sum(reads) AS io_sum_shared_before_reads
  FROM pg_stat_io WHERE context = 'normal' AND object = 'relation' \gset
-- Do this in a transaction to prevent spurious failures due to concurrent accesses to our newly
-- rewritten table, e.g. by autovacuum.
BEGIN;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'reads) AS io_sum_shared_before_reads\n  FROM pg_stat_io WHERE context = 'normal' ' at line 3")

-----------
QUERY:

ALTER TABLE test_io_shared SET TABLESPACE regress_tblspace;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SET TABLESPACE regress_tblspace' at line 1")

-----------
QUERY:

-- SELECT from the table so that the data is read into shared buffers and
-- context /* REPLACED */''normal/* REPLACED */'', object /* REPLACED */''relation/* REPLACED */'' reads are counted.
SELECT COUNT(*) FROM test_io_shared;
RESULT:
	mySQL: ERROR - (1146, "Table 'test.test_io_shared' doesn't exist")

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

SELECT sum(reads) AS io_sum_shared_after_reads
  FROM pg_stat_io WHERE context = 'normal' AND object = 'relation'  \gset
SELECT :io_sum_shared_after_reads > :io_sum_shared_before_reads;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'reads) AS io_sum_shared_after_reads\n  FROM pg_stat_io WHERE context = 'normal' A' at line 1")

-----------
QUERY:


SELECT sum(hits) AS io_sum_shared_before_hits
  FROM pg_stat_io WHERE context = 'normal' AND object = 'relation' \gset
-- Select from the table again to count hits.
-- Ensure we generate hits by forcing a nested loop self-join with no
-- materialize node. The outer side/* REPLACED */''s buffer will stay pinned, preventing its
-- eviction, while we loop through the inner side and generate hits.
BEGIN;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\n-- Select from the table again to count hits.\n-- Ensure we generate hits b' at line 2")

-----------
QUERY:

SET LOCAL enable_nestloop TO on;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO on' at line 1")

-----------
QUERY:
 SET LOCAL enable_mergejoin TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 1")

-----------
QUERY:

SET LOCAL enable_hashjoin TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 1")

-----------
QUERY:
 SET LOCAL enable_material TO off;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TO off' at line 1")

-----------
QUERY:

-- ensure plan stays as we expect it to
EXPLAIN (COSTS OFF) SELECT COUNT(*) FROM test_io_shared t1 INNER JOIN test_io_shared t2 USING (a);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT COUNT(*) FROM test_io_shared t1 INNER JOIN test_io_shared t2 U' at line 2")

-----------
QUERY:

SELECT COUNT(*) FROM test_io_shared t1 INNER JOIN test_io_shared t2 USING (a);
RESULT:
	mySQL: ERROR - (1146, "Table 'test.test_io_shared' doesn't exist")

-----------
QUERY:

COMMIT;
RESULT:
	mySQL: []

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

SELECT sum(hits) AS io_sum_shared_after_hits
  FROM pg_stat_io WHERE context = 'normal' AND object = 'relation' \gset
SELECT :io_sum_shared_after_hits > :io_sum_shared_before_hits;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT :io_sum_shared_after_hits > :io_sum_shared_before_hits' at line 2")

-----------
QUERY:


DROP TABLE test_io_shared;
RESULT:
	mySQL: ERROR - (1051, "Unknown table 'test.test_io_shared'")

-----------
QUERY:


-- Test that the follow IOCONTEXT_LOCAL IOOps are tracked in pg_stat_io:
-- - eviction of local buffers in order to reuse them
-- - reads of temporary table blocks into local buffers
-- - writes of local buffers to permanent storage
-- - extends of temporary tables

-- Set temp_buffers to its minimum so that we can trigger writes with fewer
-- inserted tuples. Do so in a new session in case temporary tables have been
-- accessed by previous tests in this session.
\c
SET temp_buffers TO 100;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\c\nSET temp_buffers TO 100' at line 10")

-----------
QUERY:

CREATE TEMPORARY TABLE test_io_local(a int, b TEXT);
RESULT:
	mySQL: []

-----------
QUERY:

SELECT sum(extends) AS extends, sum(evictions) AS evictions, sum(writes) AS writes
  FROM pg_stat_io
  WHERE context = 'normal' AND object = 'temp relation' \gset io_sum_local_before_
-- Insert tuples into the temporary table, generating extends in the stats.
-- Insert enough values that we need to reuse and write out dirty local
-- buffers, generating evictions and writes.
INSERT INTO test_io_local SELECT generate_series(1, 5000) as id, repeat('a', 200);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset io_sum_local_before_\n-- Insert tuples into the temporary table, generating' at line 3")

-----------
QUERY:

-- Ensure the table is large enough to exceed our temp_buffers setting.
SELECT pg_relation_size('test_io_local') / current_setting('block_size')::int8 > 100;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::int8 > 100' at line 2")

-----------
QUERY:


SELECT sum(reads) AS io_sum_local_before_reads
  FROM pg_stat_io WHERE context = 'normal' AND object = 'temp relation' \gset
-- Read in evicted buffers, generating reads.
SELECT COUNT(*) FROM test_io_local;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'reads) AS io_sum_local_before_reads\n  FROM pg_stat_io WHERE context = 'normal' A' at line 1")

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

SELECT sum(evictions) AS evictions,
       sum(reads) AS reads,
       sum(writes) AS writes,
       sum(extends) AS extends
  FROM pg_stat_io
  WHERE context = 'normal' AND object = 'temp relation'  \gset io_sum_local_after_
SELECT :io_sum_local_after_evictions > :io_sum_local_before_evictions,
       :io_sum_local_after_reads > :io_sum_local_before_reads,
       :io_sum_local_after_writes > :io_sum_local_before_writes,
       :io_sum_local_after_extends > :io_sum_local_before_extends;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'reads) AS reads,\n       sum(writes) AS writes,\n       sum(extends) AS extends\n  ' at line 2")

-----------
QUERY:


-- Change the tablespaces so that the temporary table is rewritten to other
-- local buffers, exercising a different codepath than standard local buffer
-- writes.
ALTER TABLE test_io_local SET TABLESPACE regress_tblspace;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SET TABLESPACE regress_tblspace' at line 4")

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

SELECT sum(writes) AS io_sum_local_new_tblspc_writes
  FROM pg_stat_io WHERE context = 'normal' AND object = 'temp relation'  \gset
SELECT :io_sum_local_new_tblspc_writes > :io_sum_local_after_writes;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT :io_sum_local_new_tblspc_writes > :io_sum_local_after_writes' at line 2")

-----------
QUERY:

RESET temp_buffers;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'temp_buffers' at line 1")

-----------
QUERY:


-- Test that reuse of strategy buffers and reads of blocks into these reused
-- buffers while VACUUMing are tracked in pg_stat_io. If there is sufficient
-- demand for shared buffers from concurrent queries, some buffers may be
-- pinned by other backends before they can be reused. In such cases, the
-- backend will evict a buffer from outside the ring and add it to the
-- ring. This is considered an eviction and not a reuse.

-- Set wal_skip_threshold smaller than the expected size of
-- test_io_vac_strategy so that, even if wal_level is minimal, VACUUM FULL will
-- fsync the newly rewritten test_io_vac_strategy instead of writing it to WAL.
-- Writing it to WAL will result in the newly written relation pages being in
-- shared buffers -- preventing us from testing BAS_VACUUM BufferAccessStrategy
-- reads.
SET wal_skip_threshold = '1 kB';
RESULT:
	mySQL: ERROR - (1193, "Unknown system variable 'wal_skip_threshold'")

-----------
QUERY:

SELECT sum(reuses) AS reuses, sum(reads) AS reads, sum(evictions) AS evictions
  FROM pg_stat_io WHERE context = 'vacuum' \gset io_sum_vac_strategy_before_
CREATE TABLE test_io_vac_strategy(a int, b int) WITH (autovacuum_enabled = 'false');
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'reads) AS reads, sum(evictions) AS evictions\n  FROM pg_stat_io WHERE context = '' at line 1")

-----------
QUERY:

INSERT INTO test_io_vac_strategy SELECT i, i from generate_series(1, 4500)i;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(1, 4500)i' at line 1")

-----------
QUERY:

-- Ensure that the next VACUUM will need to perform IO by rewriting the table
-- first with VACUUM (FULL).
VACUUM (FULL) test_io_vac_strategy;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VACUUM (FULL) test_io_vac_strategy' at line 3")

-----------
QUERY:

-- Use the minimum BUFFER_USAGE_LIMIT to cause reuses or evictions with the
-- smallest table possible.
VACUUM (PARALLEL 0, BUFFER_USAGE_LIMIT 128) test_io_vac_strategy;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VACUUM (PARALLEL 0, BUFFER_USAGE_LIMIT 128) test_io_vac_strategy' at line 3")

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

SELECT sum(reuses) AS reuses, sum(reads) AS reads, sum(evictions) AS evictions
  FROM pg_stat_io WHERE context = 'vacuum' \gset io_sum_vac_strategy_after_
SELECT :io_sum_vac_strategy_after_reads > :io_sum_vac_strategy_before_reads;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'reads) AS reads, sum(evictions) AS evictions\n  FROM pg_stat_io WHERE context = '' at line 1")

-----------
QUERY:

SELECT (:io_sum_vac_strategy_after_reuses + :io_sum_vac_strategy_after_evictions) >
  (:io_sum_vac_strategy_before_reuses + :io_sum_vac_strategy_before_evictions);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ':io_sum_vac_strategy_after_reuses + :io_sum_vac_strategy_after_evictions) >\n  (:' at line 1")

-----------
QUERY:

RESET wal_skip_threshold;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'wal_skip_threshold' at line 1")

-----------
QUERY:


-- Test that extends done by a CTAS, which uses a BAS_BULKWRITE
-- BufferAccessStrategy, are tracked in pg_stat_io.
SELECT sum(extends) AS io_sum_bulkwrite_strategy_extends_before
  FROM pg_stat_io WHERE context = 'bulkwrite' \gset
CREATE TABLE test_io_bulkwrite_strategy AS SELECT i FROM generate_series(1,100)i;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nCREATE TABLE test_io_bulkwrite_strategy AS SELECT i FROM generate_series(1' at line 4")

-----------
QUERY:

SELECT pg_stat_force_next_flush();
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_force_next_flush does not exist')

-----------
QUERY:

SELECT sum(extends) AS io_sum_bulkwrite_strategy_extends_after
  FROM pg_stat_io WHERE context = 'bulkwrite' \gset
SELECT :io_sum_bulkwrite_strategy_extends_after > :io_sum_bulkwrite_strategy_extends_before;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\gset\nSELECT :io_sum_bulkwrite_strategy_extends_after > :io_sum_bulkwrite_strate' at line 2")

-----------
QUERY:


-- Test IO stats reset
SELECT pg_stat_have_stats('io', 0, 0);
RESULT:
	mySQL: ERROR - (1305, 'FUNCTION test.pg_stat_have_stats does not exist')

-----------
QUERY:

SELECT sum(evictions) + sum(reuses) + sum(extends) + sum(fsyncs) + sum(reads) + sum(writes) + sum(writebacks) + sum(hits) AS io_stats_pre_reset
  FROM pg_stat_io \gset
SELECT pg_stat_reset_shared('io');
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'reads) + sum(writes) + sum(writebacks) + sum(hits) AS io_stats_pre_reset\n  FROM ' at line 1")

-----------
QUERY:

SELECT sum(evictions) + sum(reuses) + sum(extends) + sum(fsyncs) + sum(reads) + sum(writes) + sum(writebacks) + sum(hits) AS io_stats_post_reset
  FROM pg_stat_io \gset
SELECT :io_stats_post_reset < :io_stats_pre_reset;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'reads) + sum(writes) + sum(writebacks) + sum(hits) AS io_stats_post_reset\n  FROM' at line 1")

-----------
QUERY:



-- test BRIN index doesn/* REPLACED */''t block HOT update
CREATE TABLE brin_hot (
  id  integer PRIMARY KEY,
  val integer NOT NULL
) WITH (autovacuum_enabled = off, fillfactor = 70);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(autovacuum_enabled = off, fillfactor = 70)' at line 5")

-----------
QUERY:


INSERT INTO brin_hot SELECT *, 0 FROM generate_series(1, 235);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(1, 235)' at line 1")

-----------
QUERY:

CREATE INDEX val_brin ON brin_hot using brin(val);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'using brin(val)' at line 1")

-----------
QUERY:


CREATE FUNCTION wait_for_hot_stats() RETURNS void AS $$
DECLARE
  start_time timestamptz := clock_timestamp();
  updated bool;
BEGIN
  -- we don/* REPLACED */''t want to wait forever /* REPLACED */, loop will exit after 30 seconds
  FOR i IN 1 .. 300 LOOP
    SELECT (pg_stat_get_tuples_hot_updated('brin_hot'::regclass::oid) > 0) INTO updated;
    EXIT WHEN updated;

    -- wait a little
    PERFORM pg_sleep_for('100 milliseconds');
    -- reset stats snapshot so we can test again
    PERFORM pg_stat_clear_snapshot();
  END LOOP;
  -- report time waited in postmaster log (where it won/* REPLACED */''t change test output)
  RAISE log 'wait_for_hot_stats delayed % seconds',
    EXTRACT(epoch FROM clock_timestamp() - start_time);
END
$$ LANGUAGE plpgsql;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'void AS $$\nDECLARE\n  start_time timestamptz := clock_timestamp();\n  updated bool' at line 1")

-----------
QUERY:


UPDATE brin_hot SET val = -3 WHERE id = 42;
RESULT:
	mySQL: ERROR - (1146, "Table 'test.brin_hot' doesn't exist")

-----------
QUERY:


-- We can/* REPLACED */''t just call wait_for_hot_stats() at this point, because we only
-- transmit stats when the session goes idle, and we probably didn/* REPLACED */''t
-- transmit the last couple of counts yet thanks to the rate-limiting logic
-- in pgstat_report_stat().  But instead of waiting for the rate limiter/* REPLACED */''s
-- timeout to elapse, let/* REPLACED */''s just start a new session.  The old one will
-- then send its stats before dying.
\c -

SELECT wait_for_hot_stats();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\c -\n\nSELECT wait_for_hot_stats()' at line 7")

-----------
QUERY:

SELECT pg_stat_get_tuples_hot_updated('brin_hot'::regclass::oid);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '::regclass::oid)' at line 1")

-----------
QUERY:


DROP TABLE brin_hot;
RESULT:
	mySQL: ERROR - (1051, "Unknown table 'test.brin_hot'")

-----------
QUERY:

DROP FUNCTION wait_for_hot_stats();
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:


-- Test handling of index predicates - updating attributes in precicates
-- should not block HOT when summarizing indexes are involved. We update
-- a row that was not indexed due to the index predicate, and becomes
-- indexable - the HOT-updated tuple is forwarded to the BRIN index.
CREATE TABLE brin_hot_2 (a int, b int);
RESULT:
	mySQL: []

-----------
QUERY:

INSERT INTO brin_hot_2 VALUES (1, 100);
RESULT:
	mySQL: []

-----------
QUERY:

CREATE INDEX ON brin_hot_2 USING brin (b) WHERE a = 2;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON brin_hot_2 USING brin (b) WHERE a = 2' at line 1")

-----------
QUERY:


UPDATE brin_hot_2 SET a = 2;
RESULT:
	mySQL: []

-----------
QUERY:


EXPLAIN (COSTS OFF) SELECT * FROM brin_hot_2 WHERE a = 2 AND b = 100;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM brin_hot_2 WHERE a = 2 AND b = 100' at line 1")

-----------
QUERY:

SELECT COUNT(*) FROM brin_hot_2 WHERE a = 2 AND b = 100;
RESULT:
	mySQL: ((1,),)

-----------
QUERY:


SET enable_seqscan = off;
RESULT:
	mySQL: ERROR - (1193, "Unknown system variable 'enable_seqscan'")

-----------
QUERY:


EXPLAIN (COSTS OFF) SELECT * FROM brin_hot_2 WHERE a = 2 AND b = 100;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM brin_hot_2 WHERE a = 2 AND b = 100' at line 1")

-----------
QUERY:

SELECT COUNT(*) FROM brin_hot_2 WHERE a = 2 AND b = 100;
RESULT:
	mySQL: ((1,),)

-----------
QUERY:


DROP TABLE brin_hot_2;
RESULT:
	mySQL: []

-----------
QUERY:


-- Test that updates to indexed columns are still propagated to the
-- BRIN column.
-- https://postgr.es/m/05ebcb44-f383-86e3-4f31-0a97a55634cf@enterprisedb.com
CREATE TABLE brin_hot_3 (a int, filler text) WITH (fillfactor = 10);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(fillfactor = 10)' at line 4")

-----------
QUERY:

INSERT INTO brin_hot_3 SELECT 1, repeat(' ', 500) FROM generate_series(1, 20);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(1, 20)' at line 1")

-----------
QUERY:

CREATE INDEX ON brin_hot_3 USING brin (a) WITH (pages_per_range = 1);
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON brin_hot_3 USING brin (a) WITH (pages_per_range = 1)' at line 1")

-----------
QUERY:

UPDATE brin_hot_3 SET a = 2;
RESULT:
	mySQL: ERROR - (1146, "Table 'test.brin_hot_3' doesn't exist")

-----------
QUERY:


EXPLAIN (COSTS OFF) SELECT * FROM brin_hot_3 WHERE a = 2;
RESULT:
	mySQL: ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COSTS OFF) SELECT * FROM brin_hot_3 WHERE a = 2' at line 1")

-----------
QUERY:

SELECT COUNT(*) FROM brin_hot_3 WHERE a = 2;
RESULT:
	mySQL: ERROR - (1146, "Table 'test.brin_hot_3' doesn't exist")

-----------
QUERY:


DROP TABLE brin_hot_3;
RESULT:
	mySQL: ERROR - (1051, "Unknown table 'test.brin_hot_3'")

-----------
QUERY:


SET enable_seqscan = on;
RESULT:
	mySQL: ERROR - (1193, "Unknown system variable 'enable_seqscan'")

-----------
QUERY:


-- End of Stats Test

RESULT:
	mySQL: []
