--
-- TIMESTAMPTZ
--

CREATE TABLE TIMESTAMPTZ_TBL (d1 timestamp(2) with time zone)
ERROR: --
-- TIMESTAMPTZ
--

CREATE TABLE TIMESTAMPTZ_TBL (d1 timestamp(2) with time zone)

Parser Error: Type TIMESTAMP WITH TIME ZONE does not support any modifiers!


-- Test shorthand input values
-- We can''t just ''select'' the results since they aren''t constants /* REPLACED */, test for
-- equality instead.  We can do that by running the test inside a transaction
-- block, within which the value of ''now'' shouldn''t change, and so these
-- related values shouldn''t either.

BEGIN


INSERT INTO TIMESTAMPTZ_TBL VALUES ('today')
ERROR: 

INSERT INTO TIMESTAMPTZ_TBL VALUES ('today')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('yesterday')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('yesterday')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('tomorrow')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('tomorrow')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('tomorrow EST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('tomorrow EST')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('tomorrow zulu')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('tomorrow zulu')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'today'
ERROR: 

SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'today'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'tomorrow'
ERROR: 
SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'tomorrow'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'yesterday'
ERROR: 
SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'yesterday'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'tomorrow EST'
ERROR: 
SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'tomorrow EST'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'tomorrow zulu'
ERROR: 
SELECT count(*) AS One FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp with time zone 'tomorrow zulu'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


COMMIT


DELETE FROM TIMESTAMPTZ_TBL
ERROR: 

DELETE FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?
LINE 3: DELETE FROM TIMESTAMPTZ_TBL
                    ^


-- Verify that ''now'' *does* change over a reasonable interval such as 100 msec,
-- and that it doesn''t change over the same interval within a transaction block

INSERT INTO TIMESTAMPTZ_TBL VALUES ('now')
ERROR: 

-- Verify that ''now'' *does* change over a reasonable interval such as 100 msec,
-- and that it doesn''t change over the same interval within a transaction block

INSERT INTO TIMESTAMPTZ_TBL VALUES ('now')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

SELECT pg_sleep(0.1)
ERROR: 
SELECT pg_sleep(0.1)

Catalog Error: Scalar Function with name pg_sleep does not exist!
Did you mean "pg_get_expr"?


BEGIN

INSERT INTO TIMESTAMPTZ_TBL VALUES ('now')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('now')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

SELECT pg_sleep(0.1)
ERROR: 
SELECT pg_sleep(0.1)

Catalog Error: Scalar Function with name pg_sleep does not exist!
Did you mean "pg_get_expr"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('now')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('now')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

SELECT pg_sleep(0.1)
ERROR: 
SELECT pg_sleep(0.1)

Catalog Error: Scalar Function with name pg_sleep does not exist!
Did you mean "pg_get_expr"?

SELECT count(*) AS two FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp(2) with time zone 'now'
ERROR: 
SELECT count(*) AS two FROM TIMESTAMPTZ_TBL WHERE d1 = timestamp(2) with time zone 'now'

Parser Error: Type TIMESTAMP WITH TIME ZONE does not support any modifiers!

SELECT count(d1) AS three, count(DISTINCT d1) AS two FROM TIMESTAMPTZ_TBL
ERROR: 
SELECT count(d1) AS three, count(DISTINCT d1) AS two FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

COMMIT


TRUNCATE TIMESTAMPTZ_TBL
ERROR: 

TRUNCATE TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?
LINE 3: TRUNCATE TIMESTAMPTZ_TBL
                 ^


-- Special values
INSERT INTO TIMESTAMPTZ_TBL VALUES ('-infinity')
ERROR: 

-- Special values
INSERT INTO TIMESTAMPTZ_TBL VALUES ('-infinity')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('infinity')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('infinity')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('epoch')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('epoch')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT timestamptz 'infinity' = timestamptz '+infinity' AS t
RESULT: 
	[(False,)]


-- Postgres v6.0 standard output format
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01 1997 PST')
ERROR: 

-- Postgres v6.0 standard output format
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01 1997 PST')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


-- Variations on Postgres v6.1 standard output format
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.000001 1997 PST')
ERROR: 

-- Variations on Postgres v6.1 standard output format
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.000001 1997 PST')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.999999 1997 PST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.999999 1997 PST')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.4 1997 PST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.4 1997 PST')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.5 1997 PST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.5 1997 PST')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.6 1997 PST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mon Feb 10 17:32:01.6 1997 PST')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


-- ISO 8601 format
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-01-02')
ERROR: 

-- ISO 8601 format
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-01-02')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-01-02 03:04:05')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-01-02 03:04:05')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01-08')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01-08')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01-0800')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01-0800')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01 -08:00')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01 -08:00')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970210 173201 -0800')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970210 173201 -0800')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-06-10 17:32:01 -07:00')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-06-10 17:32:01 -07:00')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('2001-09-22T18:19:20')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2001-09-22T18:19:20')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


-- POSIX format (note that the timezone abbrev is just decoration here)
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 08:14:01 GMT+8')
ERROR: 

-- POSIX format (note that the timezone abbrev is just decoration here)
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 08:14:01 GMT+8')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 13:14:02 GMT-1')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 13:14:02 GMT-1')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 12:14:03 GMT-2')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 12:14:03 GMT-2')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 03:14:04 PST+8')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 03:14:04 PST+8')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 02:14:05 MST+7:00')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('2000-03-15 02:14:05 MST+7:00')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


-- Variations for acceptable input formats
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 17:32:01 1997 -0800')
ERROR: 

-- Variations for acceptable input formats
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 17:32:01 1997 -0800')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 5:32PM 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 5:32PM 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997/02/10 17:32:01-0800')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997/02/10 17:32:01-0800')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01 PST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-02-10 17:32:01 PST')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb-10-1997 17:32:01 PST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb-10-1997 17:32:01 PST')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('02-10-1997 17:32:01 PST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('02-10-1997 17:32:01 PST')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970210 173201 PST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970210 173201 PST')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

set datestyle to ymd
ERROR: 
set datestyle to ymd

Catalog Error: unrecognized configuration parameter "datestyle"

Did you mean: "user"

INSERT INTO TIMESTAMPTZ_TBL VALUES ('97FEB10 5:32:01PM UTC')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('97FEB10 5:32:01PM UTC')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('97/02/10 17:32:01 UTC')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('97/02/10 17:32:01 UTC')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

reset datestyle
ERROR: 
reset datestyle

Catalog Error: unrecognized configuration parameter "datestyle"

Did you mean: "user"

INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997.041 17:32:01 UTC')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997.041 17:32:01 UTC')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


-- timestamps at different timezones
INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970210 173201 America/New_York')
ERROR: 

-- timestamps at different timezones
INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970210 173201 America/New_York')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

SELECT '19970210 173201' AT TIME ZONE 'America/New_York'
ERROR: 
SELECT '19970210 173201' AT TIME ZONE 'America/New_York'

Binder Error: Could not choose a best candidate function for the function call "timezone(STRING_LITERAL, STRING_LITERAL)". In order to select one, please add explicit type casts.
	Candidate functions:
	timezone(VARCHAR, TIMESTAMP WITH TIME ZONE) -> TIMESTAMP
	timezone(VARCHAR, TIME WITH TIME ZONE) -> TIME WITH TIME ZONE
	timezone(VARCHAR, TIMESTAMP) -> TIMESTAMP WITH TIME ZONE


INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970710 173201 America/New_York')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970710 173201 America/New_York')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

SELECT '19970710 173201' AT TIME ZONE 'America/New_York'
ERROR: 
SELECT '19970710 173201' AT TIME ZONE 'America/New_York'

Binder Error: Could not choose a best candidate function for the function call "timezone(STRING_LITERAL, STRING_LITERAL)". In order to select one, please add explicit type casts.
	Candidate functions:
	timezone(VARCHAR, TIMESTAMP WITH TIME ZONE) -> TIMESTAMP
	timezone(VARCHAR, TIME WITH TIME ZONE) -> TIME WITH TIME ZONE
	timezone(VARCHAR, TIMESTAMP) -> TIMESTAMP WITH TIME ZONE


INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970710 173201 America/Does_not_exist')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('19970710 173201 America/Does_not_exist')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

SELECT '19970710 173201' AT TIME ZONE 'America/Does_not_exist'
ERROR: 
SELECT '19970710 173201' AT TIME ZONE 'America/Does_not_exist'

Binder Error: Could not choose a best candidate function for the function call "timezone(STRING_LITERAL, STRING_LITERAL)". In order to select one, please add explicit type casts.
	Candidate functions:
	timezone(VARCHAR, TIMESTAMP WITH TIME ZONE) -> TIMESTAMP
	timezone(VARCHAR, TIME WITH TIME ZONE) -> TIME WITH TIME ZONE
	timezone(VARCHAR, TIMESTAMP) -> TIMESTAMP WITH TIME ZONE



-- Daylight saving time for timestamps beyond 32-bit time_t range.
SELECT '20500710 173201 Europe/Helsinki'::timestamptz
ERROR: 

-- Daylight saving time for timestamps beyond 32-bit time_t range.
SELECT '20500710 173201 Europe/Helsinki'::timestamptz

Conversion Error: timestamp field value out of range: "20500710 173201 Europe/Helsinki", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
 -- DST
SELECT '20500110 173201 Europe/Helsinki'::timestamptz
ERROR:  -- DST
SELECT '20500110 173201 Europe/Helsinki'::timestamptz

Conversion Error: timestamp field value out of range: "20500110 173201 Europe/Helsinki", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
 -- non-DST

SELECT '205000-07-10 17:32:01 Europe/Helsinki'::timestamptz
RESULT: 
	[('205000-07-10 14:32:01+00',)]
 -- DST
SELECT '205000-01-10 17:32:01 Europe/Helsinki'::timestamptz
RESULT: 
	[('205000-01-10 15:32:01+00',)]
 -- non-DST

-- Test non-error-throwing API
SELECT pg_input_is_valid('now', 'timestamptz')
ERROR:  -- non-DST

-- Test non-error-throwing API
SELECT pg_input_is_valid('now', 'timestamptz')

Catalog Error: Scalar Function with name pg_input_is_valid does not exist!
Did you mean "json_valid"?

SELECT pg_input_is_valid('garbage', 'timestamptz')
ERROR: 
SELECT pg_input_is_valid('garbage', 'timestamptz')

Catalog Error: Scalar Function with name pg_input_is_valid does not exist!
Did you mean "json_valid"?

SELECT pg_input_is_valid('2001-01-01 00:00 Nehwon/Lankhmar', 'timestamptz')
ERROR: 
SELECT pg_input_is_valid('2001-01-01 00:00 Nehwon/Lankhmar', 'timestamptz')

Catalog Error: Scalar Function with name pg_input_is_valid does not exist!
Did you mean "json_valid"?

SELECT * FROM pg_input_error_info('garbage', 'timestamptz')
ERROR: 
SELECT * FROM pg_input_error_info('garbage', 'timestamptz')

Catalog Error: Table Function with name pg_input_error_info does not exist!
Did you mean "pragma_storage_info"?

SELECT * FROM pg_input_error_info('2001-01-01 00:00 Nehwon/Lankhmar', 'timestamptz')
ERROR: 
SELECT * FROM pg_input_error_info('2001-01-01 00:00 Nehwon/Lankhmar', 'timestamptz')

Catalog Error: Table Function with name pg_input_error_info does not exist!
Did you mean "pragma_storage_info"?


-- Check date conversion and date arithmetic
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-06-10 18:32:01 PDT')
ERROR: 

-- Check date conversion and date arithmetic
INSERT INTO TIMESTAMPTZ_TBL VALUES ('1997-06-10 18:32:01 PDT')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 17:32:01 1997')
ERROR: 

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 10 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 11 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 11 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 12 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 12 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 13 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 13 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 14 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 14 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 15 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 15 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 0097 BC')
ERROR: 

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 0097 BC')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 0097')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 0097')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 0597')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 0597')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1097')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1097')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1697')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1697')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1797')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1797')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1897')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1897')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 2097')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 2097')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 28 17:32:01 1996')
ERROR: 

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 28 17:32:01 1996')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 29 17:32:01 1996')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 29 17:32:01 1996')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mar 01 17:32:01 1996')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mar 01 17:32:01 1996')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 30 17:32:01 1996')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 30 17:32:01 1996')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 1996')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 1996')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Jan 01 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Jan 01 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 28 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 28 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 29 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 29 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mar 01 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Mar 01 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 30 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 30 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 1997')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 1997')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 1999')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 1999')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Jan 01 17:32:01 2000')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Jan 01 17:32:01 2000')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 2000')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Dec 31 17:32:01 2000')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Jan 01 17:32:01 2001')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Jan 01 17:32:01 2001')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


-- Currently unsupported syntax and ranges
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 -0097')
ERROR: 

-- Currently unsupported syntax and ranges
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 -0097')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?

INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 5097 BC')
ERROR: 
INSERT INTO TIMESTAMPTZ_TBL VALUES ('Feb 16 17:32:01 5097 BC')

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


-- Alternative field order that we''ve historically supported (sort of)
-- with regular and POSIXy timezone specs
SELECT 'Wed Jul 11 10:51:14 America/New_York 2001'::timestamptz
ERROR: 

-- Alternative field order that we''ve historically supported (sort of)
-- with regular and POSIXy timezone specs
SELECT 'Wed Jul 11 10:51:14 America/New_York 2001'::timestamptz

Conversion Error: timestamp field value out of range: "Wed Jul 11 10:51:14 America/New_York 2001", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

SELECT 'Wed Jul 11 10:51:14 GMT-4 2001'::timestamptz
ERROR: 
SELECT 'Wed Jul 11 10:51:14 GMT-4 2001'::timestamptz

Conversion Error: timestamp field value out of range: "Wed Jul 11 10:51:14 GMT-4 2001", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

SELECT 'Wed Jul 11 10:51:14 GMT+4 2001'::timestamptz
ERROR: 
SELECT 'Wed Jul 11 10:51:14 GMT+4 2001'::timestamptz

Conversion Error: timestamp field value out of range: "Wed Jul 11 10:51:14 GMT+4 2001", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

SELECT 'Wed Jul 11 10:51:14 PST-03:00 2001'::timestamptz
ERROR: 
SELECT 'Wed Jul 11 10:51:14 PST-03:00 2001'::timestamptz

Conversion Error: timestamp field value out of range: "Wed Jul 11 10:51:14 PST-03:00 2001", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

SELECT 'Wed Jul 11 10:51:14 PST+03:00 2001'::timestamptz
ERROR: 
SELECT 'Wed Jul 11 10:51:14 PST+03:00 2001'::timestamptz

Conversion Error: timestamp field value out of range: "Wed Jul 11 10:51:14 PST+03:00 2001", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])


SELECT d1 FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT d1 FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


-- Check behavior at the boundaries of the timestamp range
SELECT '4714-11-24 00:00:00+00 BC'::timestamptz
ERROR: 

-- Check behavior at the boundaries of the timestamp range
SELECT '4714-11-24 00:00:00+00 BC'::timestamptz

Conversion Error: timestamp field value out of range: "4714-11-24 00:00:00+00 BC", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

SELECT '4714-11-23 16:00:00-08 BC'::timestamptz
ERROR: 
SELECT '4714-11-23 16:00:00-08 BC'::timestamptz

Conversion Error: timestamp field value out of range: "4714-11-23 16:00:00-08 BC", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

SELECT 'Sun Nov 23 16:00:00 4714 PST BC'::timestamptz
ERROR: 
SELECT 'Sun Nov 23 16:00:00 4714 PST BC'::timestamptz

Conversion Error: timestamp field value out of range: "Sun Nov 23 16:00:00 4714 PST BC", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

SELECT '4714-11-23 23:59:59+00 BC'::timestamptz
ERROR: 
SELECT '4714-11-23 23:59:59+00 BC'::timestamptz

Conversion Error: timestamp field value out of range: "4714-11-23 23:59:59+00 BC", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
  -- out of range
SELECT '294276-12-31 23:59:59+00'::timestamptz
ERROR:   -- out of range
SELECT '294276-12-31 23:59:59+00'::timestamptz

Conversion Error: timestamp field value out of range: "294276-12-31 23:59:59+00", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

SELECT '294276-12-31 15:59:59-08'::timestamptz
ERROR: 
SELECT '294276-12-31 15:59:59-08'::timestamptz

Conversion Error: timestamp field value out of range: "294276-12-31 15:59:59-08", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

SELECT '294277-01-01 00:00:00+00'::timestamptz
ERROR: 
SELECT '294277-01-01 00:00:00+00'::timestamptz

Conversion Error: timestamp field value out of range: "294277-01-01 00:00:00+00", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
  -- out of range
SELECT '294277-12-31 16:00:00-08'::timestamptz
ERROR:   -- out of range
SELECT '294277-12-31 16:00:00-08'::timestamptz

Conversion Error: timestamp field value out of range: "294277-12-31 16:00:00-08", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
  -- out of range

-- Demonstrate functions and operators
SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 > timestamp with time zone '1997-01-02'
ERROR:   -- out of range

-- Demonstrate functions and operators
SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 > timestamp with time zone '1997-01-02'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 < timestamp with time zone '1997-01-02'
ERROR: 

SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 < timestamp with time zone '1997-01-02'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 = timestamp with time zone '1997-01-02'
ERROR: 

SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 = timestamp with time zone '1997-01-02'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 != timestamp with time zone '1997-01-02'
ERROR: 

SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 != timestamp with time zone '1997-01-02'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 <= timestamp with time zone '1997-01-02'
ERROR: 

SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 <= timestamp with time zone '1997-01-02'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 >= timestamp with time zone '1997-01-02'
ERROR: 

SELECT d1 FROM TIMESTAMPTZ_TBL
   WHERE d1 >= timestamp with time zone '1997-01-02'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT d1 - timestamp with time zone '1997-01-02' AS diff
   FROM TIMESTAMPTZ_TBL WHERE d1 BETWEEN '1902-01-01' AND '2038-01-01'
ERROR: 

SELECT d1 - timestamp with time zone '1997-01-02' AS diff
   FROM TIMESTAMPTZ_TBL WHERE d1 BETWEEN '1902-01-01' AND '2038-01-01'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT date_trunc( 'week', timestamp with time zone '2004-02-29 15:44:17.71393' ) AS week_trunc
RESULT: 
	[(datetime.datetime(2004, 2, 23, 0, 0, tzinfo=<DstTzInfo 'Europe/Zurich' CET+1:00:00 STD>),)]


SELECT date_trunc('day', timestamp with time zone '2001-02-16 20:38:40+00', 'Australia/Sydney') as sydney_trunc
ERROR: 

SELECT date_trunc('day', timestamp with time zone '2001-02-16 20:38:40+00', 'Australia/Sydney') as sydney_trunc

Binder Error: No function matches the given name and argument types 'date_trunc(STRING_LITERAL, TIMESTAMP WITH TIME ZONE, STRING_LITERAL)'. You might need to add explicit type casts.
	Candidate functions:
	date_trunc(VARCHAR, TIMESTAMP) -> TIMESTAMP
	date_trunc(VARCHAR, DATE) -> TIMESTAMP
	date_trunc(VARCHAR, INTERVAL) -> INTERVAL
	date_trunc(VARCHAR, TIMESTAMP WITH TIME ZONE) -> TIMESTAMP WITH TIME ZONE

  -- zone name
SELECT date_trunc('day', timestamp with time zone '2001-02-16 20:38:40+00', 'GMT') as gmt_trunc
ERROR:   -- zone name
SELECT date_trunc('day', timestamp with time zone '2001-02-16 20:38:40+00', 'GMT') as gmt_trunc

Binder Error: No function matches the given name and argument types 'date_trunc(STRING_LITERAL, TIMESTAMP WITH TIME ZONE, STRING_LITERAL)'. You might need to add explicit type casts.
	Candidate functions:
	date_trunc(VARCHAR, TIMESTAMP) -> TIMESTAMP
	date_trunc(VARCHAR, DATE) -> TIMESTAMP
	date_trunc(VARCHAR, INTERVAL) -> INTERVAL
	date_trunc(VARCHAR, TIMESTAMP WITH TIME ZONE) -> TIMESTAMP WITH TIME ZONE

  -- fixed-offset abbreviation
SELECT date_trunc('day', timestamp with time zone '2001-02-16 20:38:40+00', 'VET') as vet_trunc
ERROR:   -- fixed-offset abbreviation
SELECT date_trunc('day', timestamp with time zone '2001-02-16 20:38:40+00', 'VET') as vet_trunc

Binder Error: No function matches the given name and argument types 'date_trunc(STRING_LITERAL, TIMESTAMP WITH TIME ZONE, STRING_LITERAL)'. You might need to add explicit type casts.
	Candidate functions:
	date_trunc(VARCHAR, TIMESTAMP) -> TIMESTAMP
	date_trunc(VARCHAR, DATE) -> TIMESTAMP
	date_trunc(VARCHAR, INTERVAL) -> INTERVAL
	date_trunc(VARCHAR, TIMESTAMP WITH TIME ZONE) -> TIMESTAMP WITH TIME ZONE

  -- variable-offset abbreviation

-- verify date_bin behaves the same as date_trunc for relevant intervals
SELECT
  str,
  interval,
  date_trunc(str, ts, 'Australia/Sydney') = date_bin(interval::interval, ts, timestamp with time zone '2001-01-01+11') AS equal
FROM (
  VALUES
  ('day', '1 d'),
  ('hour', '1 h'),
  ('minute', '1 m'),
  ('second', '1 s'),
  ('millisecond', '1 ms'),
  ('microsecond', '1 us')
) intervals (str, interval),
(VALUES (timestamptz '2020-02-29 15:44:17.71393+00')) ts (ts)
ERROR:   -- variable-offset abbreviation

-- verify date_bin behaves the same as date_trunc for relevant intervals
SELECT
  str,
  interval,
  date_trunc(str, ts, 'Australia/Sydney') = date_bin(interval::interval, ts, timestamp with time zone '2001-01-01+11') AS equal
FROM (
  VALUES
  ('day', '1 d'),
  ('hour', '1 h'),
  ('minute', '1 m'),
  ('second', '1 s'),
  ('millisecond', '1 ms'),
  ('microsecond', '1 us')
) intervals (str, interval),
(VALUES (timestamptz '2020-02-29 15:44:17.71393+00')) ts (ts)

Binder Error: No function matches the given name and argument types 'date_trunc(VARCHAR, TIMESTAMP WITH TIME ZONE, STRING_LITERAL)'. You might need to add explicit type casts.
	Candidate functions:
	date_trunc(VARCHAR, TIMESTAMP) -> TIMESTAMP
	date_trunc(VARCHAR, DATE) -> TIMESTAMP
	date_trunc(VARCHAR, INTERVAL) -> INTERVAL
	date_trunc(VARCHAR, TIMESTAMP WITH TIME ZONE) -> TIMESTAMP WITH TIME ZONE



-- bin timestamps into arbitrary intervals
SELECT
  interval,
  ts,
  origin,
  date_bin(interval::interval, ts, origin)
FROM (
  VALUES
  ('15 days'),
  ('2 hours'),
  ('1 hour 30 minutes'),
  ('15 minutes'),
  ('10 seconds'),
  ('100 milliseconds'),
  ('250 microseconds')
) intervals (interval),
(VALUES (timestamptz '2020-02-11 15:44:17.71393')) ts (ts),
(VALUES (timestamptz '2001-01-01')) origin (origin)
ERROR: 

-- bin timestamps into arbitrary intervals
SELECT
  interval,
  ts,
  origin,
  date_bin(interval::interval, ts, origin)
FROM (
  VALUES
  ('15 days'),
  ('2 hours'),
  ('1 hour 30 minutes'),
  ('15 minutes'),
  ('10 seconds'),
  ('100 milliseconds'),
  ('250 microseconds')
) intervals (interval),
(VALUES (timestamptz '2020-02-11 15:44:17.71393')) ts (ts),
(VALUES (timestamptz '2001-01-01')) origin (origin)

Catalog Error: Scalar Function with name date_bin does not exist!
Did you mean "date_sub"?


-- shift bins using the origin parameter:
SELECT date_bin('5 min'::interval, timestamptz '2020-02-01 01:01:01+00', timestamptz '2020-02-01 00:02:30+00')
ERROR: 

-- shift bins using the origin parameter:
SELECT date_bin('5 min'::interval, timestamptz '2020-02-01 01:01:01+00', timestamptz '2020-02-01 00:02:30+00')

Catalog Error: Scalar Function with name date_bin does not exist!
Did you mean "date_sub"?


-- test roundoff edge case when source < origin
SELECT date_bin('30 minutes'::interval, timestamptz '2024-02-01 15:00:00', timestamptz '2024-02-01 17:00:00')
ERROR: 

-- test roundoff edge case when source < origin
SELECT date_bin('30 minutes'::interval, timestamptz '2024-02-01 15:00:00', timestamptz '2024-02-01 17:00:00')

Catalog Error: Scalar Function with name date_bin does not exist!
Did you mean "date_sub"?


-- disallow intervals with months or years
SELECT date_bin('5 months'::interval, timestamp with time zone '2020-02-01 01:01:01+00', timestamp with time zone '2001-01-01+00')
ERROR: 

-- disallow intervals with months or years
SELECT date_bin('5 months'::interval, timestamp with time zone '2020-02-01 01:01:01+00', timestamp with time zone '2001-01-01+00')

Catalog Error: Scalar Function with name date_bin does not exist!
Did you mean "date_sub"?

SELECT date_bin('5 years'::interval,  timestamp with time zone '2020-02-01 01:01:01+00', timestamp with time zone '2001-01-01+00')
ERROR: 
SELECT date_bin('5 years'::interval,  timestamp with time zone '2020-02-01 01:01:01+00', timestamp with time zone '2001-01-01+00')

Catalog Error: Scalar Function with name date_bin does not exist!
Did you mean "date_sub"?


-- disallow zero intervals
SELECT date_bin('0 days'::interval, timestamp with time zone '1970-01-01 01:00:00+00' , timestamp with time zone '1970-01-01 00:00:00+00')
ERROR: 

-- disallow zero intervals
SELECT date_bin('0 days'::interval, timestamp with time zone '1970-01-01 01:00:00+00' , timestamp with time zone '1970-01-01 00:00:00+00')

Catalog Error: Scalar Function with name date_bin does not exist!
Did you mean "date_sub"?


-- disallow negative intervals
SELECT date_bin('-2 days'::interval, timestamp with time zone '1970-01-01 01:00:00+00' , timestamp with time zone '1970-01-01 00:00:00+00')
ERROR: 

-- disallow negative intervals
SELECT date_bin('-2 days'::interval, timestamp with time zone '1970-01-01 01:00:00+00' , timestamp with time zone '1970-01-01 00:00:00+00')

Catalog Error: Scalar Function with name date_bin does not exist!
Did you mean "date_sub"?


-- test overflow cases
select date_bin('15 minutes'::interval, timestamptz '294276-12-30', timestamptz '4000-12-20 BC')
ERROR: 

-- test overflow cases
select date_bin('15 minutes'::interval, timestamptz '294276-12-30', timestamptz '4000-12-20 BC')

Catalog Error: Scalar Function with name date_bin does not exist!
Did you mean "date_sub"?

select date_bin('200000000 days'::interval, '2024-02-01'::timestamptz, '2024-01-01'::timestamptz)
ERROR: 
select date_bin('200000000 days'::interval, '2024-02-01'::timestamptz, '2024-01-01'::timestamptz)

Catalog Error: Scalar Function with name date_bin does not exist!
Did you mean "date_sub"?

select date_bin('365000 days'::interval, '4400-01-01 BC'::timestamptz, '4000-01-01 BC'::timestamptz)
ERROR: 
select date_bin('365000 days'::interval, '4400-01-01 BC'::timestamptz, '4000-01-01 BC'::timestamptz)

Catalog Error: Scalar Function with name date_bin does not exist!
Did you mean "date_sub"?


-- Test casting within a BETWEEN qualifier
SELECT d1 - timestamp with time zone '1997-01-02' AS diff
  FROM TIMESTAMPTZ_TBL
  WHERE d1 BETWEEN timestamp with time zone '1902-01-01' AND timestamp with time zone '2038-01-01'
ERROR: 

-- Test casting within a BETWEEN qualifier
SELECT d1 - timestamp with time zone '1997-01-02' AS diff
  FROM TIMESTAMPTZ_TBL
  WHERE d1 BETWEEN timestamp with time zone '1902-01-01' AND timestamp with time zone '2038-01-01'

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


-- DATE_PART (timestamptz_part)
SELECT d1 as timestamptz,
   date_part( 'year', d1) AS year, date_part( 'month', d1) AS month,
   date_part( 'day', d1) AS day, date_part( 'hour', d1) AS hour,
   date_part( 'minute', d1) AS minute, date_part( 'second', d1) AS second
   FROM TIMESTAMPTZ_TBL
ERROR: 

-- DATE_PART (timestamptz_part)
SELECT d1 as timestamptz,
   date_part( 'year', d1) AS year, date_part( 'month', d1) AS month,
   date_part( 'day', d1) AS day, date_part( 'hour', d1) AS hour,
   date_part( 'minute', d1) AS minute, date_part( 'second', d1) AS second
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT d1 as timestamptz,
   date_part( 'quarter', d1) AS quarter, date_part( 'msec', d1) AS msec,
   date_part( 'usec', d1) AS usec
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT d1 as timestamptz,
   date_part( 'quarter', d1) AS quarter, date_part( 'msec', d1) AS msec,
   date_part( 'usec', d1) AS usec
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT d1 as timestamptz,
   date_part( 'isoyear', d1) AS isoyear, date_part( 'week', d1) AS week,
   date_part( 'isodow', d1) AS isodow, date_part( 'dow', d1) AS dow,
   date_part( 'doy', d1) AS doy
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT d1 as timestamptz,
   date_part( 'isoyear', d1) AS isoyear, date_part( 'week', d1) AS week,
   date_part( 'isodow', d1) AS isodow, date_part( 'dow', d1) AS dow,
   date_part( 'doy', d1) AS doy
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT d1 as timestamptz,
   date_part( 'decade', d1) AS decade,
   date_part( 'century', d1) AS century,
   date_part( 'millennium', d1) AS millennium,
   round(date_part( 'julian', d1)) AS julian,
   date_part( 'epoch', d1) AS epoch
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT d1 as timestamptz,
   date_part( 'decade', d1) AS decade,
   date_part( 'century', d1) AS century,
   date_part( 'millennium', d1) AS millennium,
   round(date_part( 'julian', d1)) AS julian,
   date_part( 'epoch', d1) AS epoch
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT d1 as timestamptz,
   date_part( 'timezone', d1) AS timezone,
   date_part( 'timezone_hour', d1) AS timezone_hour,
   date_part( 'timezone_minute', d1) AS timezone_minute
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT d1 as timestamptz,
   date_part( 'timezone', d1) AS timezone,
   date_part( 'timezone_hour', d1) AS timezone_hour,
   date_part( 'timezone_minute', d1) AS timezone_minute
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


-- extract implementation is mostly the same as date_part, so only
-- test a few cases for additional coverage.
SELECT d1 as "timestamp",
   extract(microseconds from d1) AS microseconds,
   extract(milliseconds from d1) AS milliseconds,
   extract(seconds from d1) AS seconds,
   round(extract(julian from d1)) AS julian,
   extract(epoch from d1) AS epoch
   FROM TIMESTAMPTZ_TBL
ERROR: 

-- extract implementation is mostly the same as date_part, so only
-- test a few cases for additional coverage.
SELECT d1 as "timestamp",
   extract(microseconds from d1) AS microseconds,
   extract(milliseconds from d1) AS milliseconds,
   extract(seconds from d1) AS seconds,
   round(extract(julian from d1)) AS julian,
   extract(epoch from d1) AS epoch
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


-- value near upper bound uses special case in code
SELECT date_part('epoch', '294270-01-01 00:00:00+00'::timestamptz)
ERROR: 

-- value near upper bound uses special case in code
SELECT date_part('epoch', '294270-01-01 00:00:00+00'::timestamptz)

Conversion Error: timestamp field value out of range: "294270-01-01 00:00:00+00", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

SELECT extract(epoch from '294270-01-01 00:00:00+00'::timestamptz)
ERROR: 
SELECT extract(epoch from '294270-01-01 00:00:00+00'::timestamptz)

Conversion Error: timestamp field value out of range: "294270-01-01 00:00:00+00", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

-- another internal overflow test case
SELECT extract(epoch from '5000-01-01 00:00:00+00'::timestamptz)
RESULT: 
	[(95617584000.0,)]


-- test edge-case overflow in timestamp subtraction
SELECT timestamptz '294276-12-31 23:59:59 UTC' - timestamptz '1999-12-23 19:59:04.224193 UTC' AS ok
ERROR: 

-- test edge-case overflow in timestamp subtraction
SELECT timestamptz '294276-12-31 23:59:59 UTC' - timestamptz '1999-12-23 19:59:04.224193 UTC' AS ok

Conversion Error: timestamp field value out of range: "294276-12-31 23:59:59 UTC", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

SELECT timestamptz '294276-12-31 23:59:59 UTC' - timestamptz '1999-12-23 19:59:04.224192 UTC' AS overflows
ERROR: 
SELECT timestamptz '294276-12-31 23:59:59 UTC' - timestamptz '1999-12-23 19:59:04.224192 UTC' AS overflows

Conversion Error: timestamp field value out of range: "294276-12-31 23:59:59 UTC", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])


-- TO_CHAR()
SELECT to_char(d1, 'DAY Day day DY Dy dy MONTH Month month RM MON Mon mon')
   FROM TIMESTAMPTZ_TBL
ERROR: 

-- TO_CHAR()
SELECT to_char(d1, 'DAY Day day DY Dy dy MONTH Month month RM MON Mon mon')
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT to_char(d1, 'FMDAY FMDay FMday FMMONTH FMMonth FMmonth FMRM')
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT to_char(d1, 'FMDAY FMDay FMday FMMONTH FMMonth FMmonth FMRM')
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT to_char(d1, 'Y,YYY YYYY YYY YY Y CC Q MM WW DDD DD D J')
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT to_char(d1, 'Y,YYY YYYY YYY YY Y CC Q MM WW DDD DD D J')
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT to_char(d1, 'FMY,YYY FMYYYY FMYYY FMYY FMY FMCC FMQ FMMM FMWW FMDDD FMDD FMD FMJ')
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT to_char(d1, 'FMY,YYY FMYYYY FMYYY FMYY FMY FMCC FMQ FMMM FMWW FMDDD FMDD FMD FMJ')
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT to_char(d1, 'HH HH12 HH24 MI SS SSSS')
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT to_char(d1, 'HH HH12 HH24 MI SS SSSS')
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT to_char(d1, E'"HH:MI:SS is" HH:MI:SS "\\"text between quote marks\\""')
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT to_char(d1, E'"HH:MI:SS is" HH:MI:SS "\\"text between quote marks\\""')
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT to_char(d1, 'HH24--text--MI--text--SS')
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT to_char(d1, 'HH24--text--MI--text--SS')
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT to_char(d1, 'YYYYTH YYYYth Jth')
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT to_char(d1, 'YYYYTH YYYYth Jth')
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT to_char(d1, 'YYYY A.D. YYYY a.d. YYYY bc HH:MI:SS P.M. HH:MI:SS p.m. HH:MI:SS pm')
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT to_char(d1, 'YYYY A.D. YYYY a.d. YYYY bc HH:MI:SS P.M. HH:MI:SS p.m. HH:MI:SS pm')
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT to_char(d1, 'IYYY IYY IY I IW IDDD ID')
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT to_char(d1, 'IYYY IYY IY I IW IDDD ID')
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT to_char(d1, 'FMIYYY FMIYY FMIY FMI FMIW FMIDDD FMID')
   FROM TIMESTAMPTZ_TBL
ERROR: 

SELECT to_char(d1, 'FMIYYY FMIYY FMIY FMI FMIW FMIDDD FMID')
   FROM TIMESTAMPTZ_TBL

Catalog Error: Table with name TIMESTAMPTZ_TBL does not exist!
Did you mean "TEXT_TBL"?


SELECT to_char(d, 'FF1 FF2 FF3 FF4 FF5 FF6  ff1 ff2 ff3 ff4 ff5 ff6  MS US')
   FROM (VALUES
       ('2018-11-02 12:34:56'::timestamptz),
       ('2018-11-02 12:34:56.78'),
       ('2018-11-02 12:34:56.78901'),
       ('2018-11-02 12:34:56.78901234')
   ) d(d)
ERROR: 

SELECT to_char(d, 'FF1 FF2 FF3 FF4 FF5 FF6  ff1 ff2 ff3 ff4 ff5 ff6  MS US')
   FROM (VALUES
       ('2018-11-02 12:34:56'::timestamptz),
       ('2018-11-02 12:34:56.78'),
       ('2018-11-02 12:34:56.78901'),
       ('2018-11-02 12:34:56.78901234')
   ) d(d)

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?


-- Check OF, TZH, TZM with various zone offsets, particularly fractional hours
SET timezone = '00:00'
ERROR: 

-- Check OF, TZH, TZM with various zone offsets, particularly fractional hours
SET timezone = '00:00'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
ERROR: 
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '+02:00'
ERROR: 
SET timezone = '+02:00'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
ERROR: 
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '-13:00'
ERROR: 
SET timezone = '-13:00'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
ERROR: 
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '-00:30'
ERROR: 
SET timezone = '-00:30'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
ERROR: 
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '00:30'
ERROR: 
SET timezone = '00:30'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
ERROR: 
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '-04:30'
ERROR: 
SET timezone = '-04:30'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
ERROR: 
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '04:30'
ERROR: 
SET timezone = '04:30'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
ERROR: 
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '-04:15'
ERROR: 
SET timezone = '-04:15'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
ERROR: 
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '04:15'
ERROR: 
SET timezone = '04:15'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"
ERROR: 
SELECT to_char(now(), 'OF') as "OF", to_char(now(), 'TZH:TZM') as "TZH:TZM"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

RESET timezone


-- Check of, tzh, tzm with various zone offsets.
SET timezone = '00:00'
ERROR: 

-- Check of, tzh, tzm with various zone offsets.
SET timezone = '00:00'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'of') as "Of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
ERROR: 
SELECT to_char(now(), 'of') as "Of", to_char(now(), 'tzh:tzm') as "tzh:tzm"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '+02:00'
ERROR: 
SET timezone = '+02:00'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
ERROR: 
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '-13:00'
ERROR: 
SET timezone = '-13:00'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
ERROR: 
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '-00:30'
ERROR: 
SET timezone = '-00:30'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
ERROR: 
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '00:30'
ERROR: 
SET timezone = '00:30'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
ERROR: 
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '-04:30'
ERROR: 
SET timezone = '-04:30'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
ERROR: 
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '04:30'
ERROR: 
SET timezone = '04:30'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
ERROR: 
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '-04:15'
ERROR: 
SET timezone = '-04:15'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
ERROR: 
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

SET timezone = '04:15'
ERROR: 
SET timezone = '04:15'

Not implemented Error: Unknown TimeZone setting

SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"
ERROR: 
SELECT to_char(now(), 'of') as "of", to_char(now(), 'tzh:tzm') as "tzh:tzm"

Catalog Error: Scalar Function with name to_char does not exist!
Did you mean "chr"?

RESET timezone



CREATE TABLE TIMESTAMPTZ_TST (a int , b timestamptz)


-- Test year field value with len > 4
INSERT INTO TIMESTAMPTZ_TST VALUES(1, 'Sat Mar 12 23:58:48 1000 IST')
ERROR: 

-- Test year field value with len > 4
INSERT INTO TIMESTAMPTZ_TST VALUES(1, 'Sat Mar 12 23:58:48 1000 IST')

Conversion Error: timestamp field value out of range: "Sat Mar 12 23:58:48 1000 IST", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
LINE 4: INSERT INTO TIMESTAMPTZ_TST VALUES(1, 'Sat Mar 12 23:58:48 1000 IST')
                                              ^

INSERT INTO TIMESTAMPTZ_TST VALUES(2, 'Sat Mar 12 23:58:48 10000 IST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TST VALUES(2, 'Sat Mar 12 23:58:48 10000 IST')

Conversion Error: timestamp field value out of range: "Sat Mar 12 23:58:48 10000 IST", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
LINE 2: INSERT INTO TIMESTAMPTZ_TST VALUES(2, 'Sat Mar 12 23:58:48 10000 IST')
                                              ^

INSERT INTO TIMESTAMPTZ_TST VALUES(3, 'Sat Mar 12 23:58:48 100000 IST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TST VALUES(3, 'Sat Mar 12 23:58:48 100000 IST')

Conversion Error: timestamp field value out of range: "Sat Mar 12 23:58:48 100000 IST", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
LINE 2: INSERT INTO TIMESTAMPTZ_TST VALUES(3, 'Sat Mar 12 23:58:48 100000 IST')
                                              ^

INSERT INTO TIMESTAMPTZ_TST VALUES(3, '10000 Mar 12 23:58:48 IST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TST VALUES(3, '10000 Mar 12 23:58:48 IST')

Conversion Error: timestamp field value out of range: "10000 Mar 12 23:58:48 IST", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
LINE 2: INSERT INTO TIMESTAMPTZ_TST VALUES(3, '10000 Mar 12 23:58:48 IST')
                                              ^

INSERT INTO TIMESTAMPTZ_TST VALUES(4, '100000312 23:58:48 IST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TST VALUES(4, '100000312 23:58:48 IST')

Conversion Error: timestamp field value out of range: "100000312 23:58:48 IST", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
LINE 2: INSERT INTO TIMESTAMPTZ_TST VALUES(4, '100000312 23:58:48 IST')
                                              ^

INSERT INTO TIMESTAMPTZ_TST VALUES(4, '1000000312 23:58:48 IST')
ERROR: 
INSERT INTO TIMESTAMPTZ_TST VALUES(4, '1000000312 23:58:48 IST')

Conversion Error: timestamp field value out of range: "1000000312 23:58:48 IST", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
LINE 2: INSERT INTO TIMESTAMPTZ_TST VALUES(4, '1000000312 23:58:48 IST')
                                              ^

--Verify data
SELECT * FROM TIMESTAMPTZ_TST ORDER BY a
RESULT: 
	[]

--Cleanup
DROP TABLE TIMESTAMPTZ_TST


-- test timestamptz constructors
set TimeZone to 'America/New_York'


-- numeric timezone
SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33)
RESULT: 
	[(datetime.datetime(1973, 7, 15, 8, 15, 55, 330000, tzinfo=<DstTzInfo 'America/New_York' EDT-1 day, 20:00:00 DST>),)]

SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33, '+2')
RESULT: 
	[(datetime.datetime(1973, 7, 15, 4, 15, 55, 330000, tzinfo=<DstTzInfo 'America/New_York' EDT-1 day, 20:00:00 DST>),)]

SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33, '-2')
RESULT: 
	[(datetime.datetime(1973, 7, 15, 4, 15, 55, 330000, tzinfo=<DstTzInfo 'America/New_York' EDT-1 day, 20:00:00 DST>),)]

WITH tzs (tz) AS (VALUES
    ('+1'), ('+1:'), ('+1:0'), ('+100'), ('+1:00'), ('+01:00'),
    ('+10'), ('+1000'), ('+10:'), ('+10:0'), ('+10:00'), ('+10:00:'),
    ('+10:00:1'), ('+10:00:01'),
    ('+10:00:10'))
     SELECT make_timestamptz(2010, 2, 27, 3, 45, 00, tz), tz FROM tzs
RESULT: 
	[(datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+1'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+1:'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+1:0'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+100'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+1:00'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+01:00'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+10'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+1000'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+10:'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+10:0'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+10:00'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+10:00:'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+10:00:1'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+10:00:01'), (datetime.datetime(2010, 2, 26, 22, 45, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>), '+10:00:10')]


-- these should fail
SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33, '2')
RESULT: 
	[(datetime.datetime(1973, 7, 15, 4, 15, 55, 330000, tzinfo=<DstTzInfo 'America/New_York' EDT-1 day, 20:00:00 DST>),)]

SELECT make_timestamptz(2014, 12, 10, 10, 10, 10, '+16')
RESULT: 
	[(datetime.datetime(2014, 12, 10, 5, 10, 10, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>),)]

SELECT make_timestamptz(2014, 12, 10, 10, 10, 10, '-16')
RESULT: 
	[(datetime.datetime(2014, 12, 10, 5, 10, 10, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>),)]


-- should be true
SELECT make_timestamptz(1973, 07, 15, 08, 15, 55.33, '+2') = '1973-07-15 08:15:55.33+02'::timestamptz
RESULT: 
	[(False,)]


-- full timezone names
SELECT make_timestamptz(2014, 12, 10, 0, 0, 0, 'Europe/Prague') = timestamptz '2014-12-10 00:00:00 Europe/Prague'
RESULT: 
	[(True,)]

SELECT make_timestamptz(2014, 12, 10, 0, 0, 0, 'Europe/Prague') AT TIME ZONE 'UTC'
RESULT: 
	[(datetime.datetime(2014, 12, 9, 23, 0),)]

SELECT make_timestamptz(1846, 12, 10, 0, 0, 0, 'Asia/Manila') AT TIME ZONE 'UTC'
RESULT: 
	[(datetime.datetime(1846, 12, 9, 15, 56),)]

SELECT make_timestamptz(1881, 12, 10, 0, 0, 0, 'Europe/Paris') AT TIME ZONE 'UTC'
RESULT: 
	[(datetime.datetime(1881, 12, 9, 23, 50, 39),)]

SELECT make_timestamptz(1910, 12, 24, 0, 0, 0, 'Nehwon/Lankhmar')
RESULT: 
	[(datetime.datetime(1910, 12, 23, 19, 0, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>),)]


-- abbreviations
SELECT make_timestamptz(2008, 12, 10, 10, 10, 10, 'EST')
RESULT: 
	[(datetime.datetime(2008, 12, 10, 10, 10, 10, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>),)]

SELECT make_timestamptz(2008, 12, 10, 10, 10, 10, 'EDT')
RESULT: 
	[(datetime.datetime(2008, 12, 10, 5, 10, 10, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>),)]

SELECT make_timestamptz(2014, 12, 10, 10, 10, 10, 'PST8PDT')
RESULT: 
	[(datetime.datetime(2014, 12, 10, 13, 10, 10, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>),)]


RESET TimeZone


-- generate_series for timestamptz
select * from generate_series('2020-01-01 00:00'::timestamptz,
                              '2020-01-02 03:00'::timestamptz,
                              '1 hour'::interval)
ERROR: 

-- generate_series for timestamptz
select * from generate_series('2020-01-01 00:00'::timestamptz,
                              '2020-01-02 03:00'::timestamptz,
                              '1 hour'::interval)

Conversion Error: timestamp field value out of range: "2020-01-01 00:00", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

-- the LIMIT should allow this to terminate in a reasonable amount of time
-- (but that unfortunately doesn''t work yet for SELECT * FROM ...)
select generate_series('2022-01-01 00:00'::timestamptz,
                       'infinity'::timestamptz,
                       '1 month'::interval) limit 10
ERROR: 
-- the LIMIT should allow this to terminate in a reasonable amount of time
-- (but that unfortunately doesn''t work yet for SELECT * FROM ...)
select generate_series('2022-01-01 00:00'::timestamptz,
                       'infinity'::timestamptz,
                       '1 month'::interval) limit 10

Conversion Error: timestamp field value out of range: "2022-01-01 00:00", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

-- errors
select * from generate_series('2020-01-01 00:00'::timestamptz,
                              '2020-01-02 03:00'::timestamptz,
                              '0 hour'::interval)
ERROR: 
-- errors
select * from generate_series('2020-01-01 00:00'::timestamptz,
                              '2020-01-02 03:00'::timestamptz,
                              '0 hour'::interval)

Conversion Error: timestamp field value out of range: "2020-01-01 00:00", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])

select generate_series(timestamptz '1995-08-06 12:12:12', timestamptz '1996-08-06 12:12:12', interval 'infinity')
ERROR: 
select generate_series(timestamptz '1995-08-06 12:12:12', timestamptz '1996-08-06 12:12:12', interval 'infinity')

Conversion Error: Could not convert string 'infinity' to INTERVAL

select generate_series(timestamptz '1995-08-06 12:12:12', timestamptz '1996-08-06 12:12:12', interval '-infinity')
ERROR: 
select generate_series(timestamptz '1995-08-06 12:12:12', timestamptz '1996-08-06 12:12:12', interval '-infinity')

Conversion Error: Could not convert string '-infinity' to INTERVAL


-- Interval crossing time shift for Europe/Warsaw timezone (with DST)
SET TimeZone to 'UTC'


SELECT date_add('2022-10-30 00:00:00+01'::timestamptz,
                '1 day'::interval)
RESULT: 
	[(datetime.datetime(2022, 10, 30, 23, 0, tzinfo=<UTC>),)]

SELECT date_add('2021-10-31 00:00:00+02'::timestamptz,
                '1 day'::interval,
                'Europe/Warsaw')
ERROR: 
SELECT date_add('2021-10-31 00:00:00+02'::timestamptz,
                '1 day'::interval,
                'Europe/Warsaw')

Binder Error: Macro function 'date_add(date, interval)' requires 2 positional arguments, but 3 positional arguments were provided.

SELECT date_subtract('2022-10-30 00:00:00+01'::timestamptz,
                     '1 day'::interval)
ERROR: 
SELECT date_subtract('2022-10-30 00:00:00+01'::timestamptz,
                     '1 day'::interval)

Catalog Error: Scalar Function with name date_subtract does not exist!
Did you mean "date_sub"?

SELECT date_subtract('2021-10-31 00:00:00+02'::timestamptz,
                     '1 day'::interval,
                     'Europe/Warsaw')
ERROR: 
SELECT date_subtract('2021-10-31 00:00:00+02'::timestamptz,
                     '1 day'::interval,
                     'Europe/Warsaw')

Catalog Error: Scalar Function with name date_subtract does not exist!
Did you mean "date_sub"?

SELECT * FROM generate_series('2021-12-31 23:00:00+00'::timestamptz,
                              '2020-12-31 23:00:00+00'::timestamptz,
                              '-1 month'::interval,
                              'Europe/Warsaw')
ERROR: 
SELECT * FROM generate_series('2021-12-31 23:00:00+00'::timestamptz,
                              '2020-12-31 23:00:00+00'::timestamptz,
                              '-1 month'::interval,
                              'Europe/Warsaw')

Binder Error: No function matches the given name and argument types 'generate_series(TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE, INTERVAL, VARCHAR)'. You might need to add explicit type casts.
	Candidate functions:
	generate_series(BIGINT)
	generate_series(BIGINT, BIGINT)
	generate_series(BIGINT, BIGINT, BIGINT)
	generate_series(TIMESTAMP, TIMESTAMP, INTERVAL)
	generate_series(TIMESTAMP WITH TIME ZONE, TIMESTAMP WITH TIME ZONE, INTERVAL)


RESET TimeZone


--
-- Test behavior with a dynamic (time-varying) timezone abbreviation.
-- These tests rely on the knowledge that MSK (Europe/Moscow standard time)
-- moved forwards in Mar 2011 and backwards again in Oct 2014.
--

SET TimeZone to 'UTC'


SELECT '2011-03-27 00:00:00 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 26, 21, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 01:00:00 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 26, 22, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 01:59:59 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 26, 22, 59, 59, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:00:00 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:00:01 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 0, 1, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:59:59 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 59, 59, tzinfo=<UTC>),)]

SELECT '2011-03-27 03:00:00 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 03:00:01 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 0, 1, tzinfo=<UTC>),)]

SELECT '2011-03-27 04:00:00 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 0, 0, tzinfo=<UTC>),)]


SELECT '2011-03-27 00:00:00 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 0, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 01:00:00 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 1, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 01:59:59 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 1, 59, 59, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:00:00 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 2, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:00:01 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 2, 0, 1, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:59:59 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 2, 59, 59, tzinfo=<UTC>),)]

SELECT '2011-03-27 03:00:00 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 3, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 03:00:01 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 3, 0, 1, tzinfo=<UTC>),)]

SELECT '2011-03-27 04:00:00 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 4, 0, tzinfo=<UTC>),)]


SELECT '2014-10-26 00:00:00 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 25, 20, 0, tzinfo=<UTC>),)]

SELECT '2014-10-26 00:59:59 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 25, 20, 59, 59, tzinfo=<UTC>),)]

SELECT '2014-10-26 01:00:00 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 25, 22, 0, tzinfo=<UTC>),)]

SELECT '2014-10-26 01:00:01 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 25, 22, 0, 1, tzinfo=<UTC>),)]

SELECT '2014-10-26 02:00:00 Europe/Moscow'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 25, 23, 0, tzinfo=<UTC>),)]


SELECT '2014-10-26 00:00:00 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 26, 0, 0, tzinfo=<UTC>),)]

SELECT '2014-10-26 00:59:59 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 26, 0, 59, 59, tzinfo=<UTC>),)]

SELECT '2014-10-26 01:00:00 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 0, tzinfo=<UTC>),)]

SELECT '2014-10-26 01:00:01 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 0, 1, tzinfo=<UTC>),)]

SELECT '2014-10-26 02:00:00 MSK'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 26, 2, 0, tzinfo=<UTC>),)]


SELECT '2011-03-27 00:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 21, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 01:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 22, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 01:59:59'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 22, 59, 59, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:00:01'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 0, 1, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:59:59'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 59, 59, tzinfo=<UTC>),)]

SELECT '2011-03-27 03:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 03:00:01'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 0, 1, tzinfo=<UTC>),)]

SELECT '2011-03-27 04:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 0, 0, tzinfo=<UTC>),)]


SELECT '2011-03-27 00:00:00'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 0, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 01:00:00'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 1, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 01:59:59'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 1, 59, 59, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:00:00'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 2, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:00:01'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 2, 0, 1, tzinfo=<UTC>),)]

SELECT '2011-03-27 02:59:59'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 2, 59, 59, tzinfo=<UTC>),)]

SELECT '2011-03-27 03:00:00'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 3, 0, tzinfo=<UTC>),)]

SELECT '2011-03-27 03:00:01'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 3, 0, 1, tzinfo=<UTC>),)]

SELECT '2011-03-27 04:00:00'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 4, 0, tzinfo=<UTC>),)]


SELECT '2014-10-26 00:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2014, 10, 25, 20, 0, tzinfo=<UTC>),)]

SELECT '2014-10-26 00:59:59'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2014, 10, 25, 20, 59, 59, tzinfo=<UTC>),)]

SELECT '2014-10-26 01:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2014, 10, 25, 22, 0, tzinfo=<UTC>),)]

SELECT '2014-10-26 01:00:01'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2014, 10, 25, 22, 0, 1, tzinfo=<UTC>),)]

SELECT '2014-10-26 02:00:00'::timestamp AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2014, 10, 25, 23, 0, tzinfo=<UTC>),)]


SELECT '2014-10-26 00:00:00'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2014, 10, 26, 0, 0, tzinfo=<UTC>),)]

SELECT '2014-10-26 00:59:59'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2014, 10, 26, 0, 59, 59, tzinfo=<UTC>),)]

SELECT '2014-10-26 01:00:00'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 0, tzinfo=<UTC>),)]

SELECT '2014-10-26 01:00:01'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 0, 1, tzinfo=<UTC>),)]

SELECT '2014-10-26 02:00:00'::timestamp AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2014, 10, 26, 2, 0, tzinfo=<UTC>),)]


SELECT make_timestamptz(2014, 10, 26, 0, 0, 0, 'MSK')
RESULT: 
	[(datetime.datetime(2014, 10, 26, 0, 0, tzinfo=<UTC>),)]

SELECT make_timestamptz(2014, 10, 26, 1, 0, 0, 'MSK')
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 0, tzinfo=<UTC>),)]


SELECT to_timestamp(         0)
RESULT: 
	[(datetime.datetime(1970, 1, 1, 0, 0, tzinfo=<UTC>),)]
          -- 1970-01-01 00:00:00+00
SELECT to_timestamp( 946684800)
RESULT: 
	[(datetime.datetime(2000, 1, 1, 0, 0, tzinfo=<UTC>),)]
          -- 2000-01-01 00:00:00+00
SELECT to_timestamp(1262349296.7890123)
RESULT: 
	[(datetime.datetime(2010, 1, 1, 12, 34, 56, 789012, tzinfo=<UTC>),)]
  -- 2010-01-01 12:34:56.789012+00
-- edge cases
SELECT to_timestamp(-210866803200)
RESULT: 
	[('4714-11-24 (BC) 00:00:00+00',)]
       --   4714-11-24 00:00:00+00 BC
-- upper limit varies between integer and float timestamps, so hard to test
-- nonfinite values
SELECT to_timestamp(' Infinity'::float)
ERROR:        --   4714-11-24 00:00:00+00 BC
-- upper limit varies between integer and float timestamps, so hard to test
-- nonfinite values
SELECT to_timestamp(' Infinity'::float)

Conversion Error: Could not convert epoch seconds to TIMESTAMP WITH TIME ZONE

SELECT to_timestamp('-Infinity'::float)
ERROR: 
SELECT to_timestamp('-Infinity'::float)

Conversion Error: Could not convert epoch seconds to TIMESTAMP WITH TIME ZONE

SELECT to_timestamp('NaN'::float)
ERROR: 
SELECT to_timestamp('NaN'::float)

Conversion Error: Could not convert epoch seconds to TIMESTAMP WITH TIME ZONE



SET TimeZone to 'Europe/Moscow'


SELECT '2011-03-26 21:00:00 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 0, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>),)]

SELECT '2011-03-26 22:00:00 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 1, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>),)]

SELECT '2011-03-26 22:59:59 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 1, 59, 59, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>),)]

SELECT '2011-03-26 23:00:00 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 3, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>),)]

SELECT '2011-03-26 23:00:01 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 3, 0, 1, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>),)]

SELECT '2011-03-26 23:59:59 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 3, 59, 59, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>),)]

SELECT '2011-03-27 00:00:00 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2011, 3, 27, 4, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>),)]


SELECT '2014-10-25 21:00:00 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>),)]

SELECT '2014-10-25 21:59:59 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 59, 59, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+4:00:00 STD>),)]

SELECT '2014-10-25 22:00:00 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>),)]

SELECT '2014-10-25 22:00:01 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 0, 1, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>),)]

SELECT '2014-10-25 23:00:00 UTC'::timestamptz
RESULT: 
	[(datetime.datetime(2014, 10, 26, 2, 0, tzinfo=<DstTzInfo 'Europe/Moscow' MSK+3:00:00 STD>),)]


RESET TimeZone


SELECT '2011-03-26 21:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 0, 0),)]

SELECT '2011-03-26 22:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 1, 0),)]

SELECT '2011-03-26 22:59:59 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 1, 59, 59),)]

SELECT '2011-03-26 23:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 3, 0),)]

SELECT '2011-03-26 23:00:01 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 3, 0, 1),)]

SELECT '2011-03-26 23:59:59 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 3, 59, 59),)]

SELECT '2011-03-27 00:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 4, 0),)]


SELECT '2014-10-25 21:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 0),)]

SELECT '2014-10-25 21:59:59 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 59, 59),)]

SELECT '2014-10-25 22:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 0),)]

SELECT '2014-10-25 22:00:01 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2014, 10, 26, 1, 0, 1),)]

SELECT '2014-10-25 23:00:00 UTC'::timestamptz AT TIME ZONE 'Europe/Moscow'
RESULT: 
	[(datetime.datetime(2014, 10, 26, 2, 0),)]


SELECT '2011-03-26 21:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 21, 0),)]

SELECT '2011-03-26 22:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 22, 0),)]

SELECT '2011-03-26 22:59:59 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 22, 59, 59),)]

SELECT '2011-03-26 23:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 0),)]

SELECT '2011-03-26 23:00:01 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 0, 1),)]

SELECT '2011-03-26 23:59:59 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 26, 23, 59, 59),)]

SELECT '2011-03-27 00:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2011, 3, 27, 0, 0),)]


SELECT '2014-10-25 21:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2014, 10, 25, 21, 0),)]

SELECT '2014-10-25 21:59:59 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2014, 10, 25, 21, 59, 59),)]

SELECT '2014-10-25 22:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2014, 10, 25, 22, 0),)]

SELECT '2014-10-25 22:00:01 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2014, 10, 25, 22, 0, 1),)]

SELECT '2014-10-25 23:00:00 UTC'::timestamptz AT TIME ZONE 'MSK'
RESULT: 
	[(datetime.datetime(2014, 10, 25, 23, 0),)]


--
-- Test LOCAL time zone
--
BEGIN

SET LOCAL TIME ZONE 'Europe/Paris'
ERROR: 
SET LOCAL TIME ZONE 'Europe/Paris'

Not implemented Error: SET LOCAL is not implemented.

VALUES (CAST('1978-07-07 19:38 America/New_York' AS TIMESTAMP WITH TIME ZONE) AT LOCAL)
ERROR: 
VALUES (CAST('1978-07-07 19:38 America/New_York' AS TIMESTAMP WITH TIME ZONE) AT LOCAL)

Parser Error: syntax error at or near "LOCAL"

VALUES (TIMESTAMP '1978-07-07 19:38' AT LOCAL)
ERROR: 
VALUES (TIMESTAMP '1978-07-07 19:38' AT LOCAL)

Parser Error: syntax error at or near "LOCAL"

SET LOCAL TIME ZONE 'Australia/Sydney'
ERROR: 
SET LOCAL TIME ZONE 'Australia/Sydney'

Not implemented Error: SET LOCAL is not implemented.

VALUES (CAST('1978-07-07 19:38 America/New_York' AS TIMESTAMP WITH TIME ZONE) AT LOCAL)
ERROR: 
VALUES (CAST('1978-07-07 19:38 America/New_York' AS TIMESTAMP WITH TIME ZONE) AT LOCAL)

Parser Error: syntax error at or near "LOCAL"

VALUES (TIMESTAMP '1978-07-07 19:38' AT LOCAL)
ERROR: 
VALUES (TIMESTAMP '1978-07-07 19:38' AT LOCAL)

Parser Error: syntax error at or near "LOCAL"

SET LOCAL TimeZone TO 'UTC'
ERROR: 
SET LOCAL TimeZone TO 'UTC'

Not implemented Error: SET LOCAL is not implemented.

CREATE VIEW timestamp_local_view AS
  SELECT CAST('1978-07-07 19:38 America/New_York' AS TIMESTAMP WITH TIME ZONE) AT LOCAL AS ttz_at_local,
         timezone(CAST('1978-07-07 19:38 America/New_York' AS TIMESTAMP WITH TIME ZONE)) AS ttz_func,
         TIMESTAMP '1978-07-07 19:38' AT LOCAL AS t_at_local,
         timezone(TIMESTAMP '1978-07-07 19:38') AS t_func
ERROR: 
CREATE VIEW timestamp_local_view AS
  SELECT CAST('1978-07-07 19:38 America/New_York' AS TIMESTAMP WITH TIME ZONE) AT LOCAL AS ttz_at_local,
         timezone(CAST('1978-07-07 19:38 America/New_York' AS TIMESTAMP WITH TIME ZONE)) AS ttz_func,
         TIMESTAMP '1978-07-07 19:38' AT LOCAL AS t_at_local,
         timezone(TIMESTAMP '1978-07-07 19:38') AS t_func

Parser Error: syntax error at or near "LOCAL"

SELECT pg_get_viewdef('timestamp_local_view', true)
ERROR: 
SELECT pg_get_viewdef('timestamp_local_view', true)

Binder Error: Macro function 'pg_get_viewdef(oid)' requires a single positional argument, but 2 positional arguments were provided.

\x
TABLE timestamp_local_view
ERROR: 
\x
TABLE timestamp_local_view

Parser Error: syntax error at or near "\"

\x
DROP VIEW timestamp_local_view
ERROR: 
\x
DROP VIEW timestamp_local_view

Parser Error: syntax error at or near "\"

COMMIT


--
-- Test that AT TIME ZONE isn''t misoptimized when using an index (bug #14504)
--
create temp table tmptz (f1 timestamptz primary key)

insert into tmptz values ('2017-01-18 00:00+00')
ERROR: 
insert into tmptz values ('2017-01-18 00:00+00')

Conversion Error: timestamp field value out of range: "2017-01-18 00:00+00", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH:MM| ZONE])
LINE 2: insert into tmptz values ('2017-01-18 00:00+00')
                                  ^

explain (costs off)
select * from tmptz where f1 at time zone 'utc' = '2017-01-18 00:00'
ERROR: 
explain (costs off)
select * from tmptz where f1 at time zone 'utc' = '2017-01-18 00:00'

Not implemented Error: Unimplemented explain type: costs

select * from tmptz where f1 at time zone 'utc' = '2017-01-18 00:00'
RESULT: 
	[]


-- test arithmetic with infinite timestamps
SELECT timestamptz 'infinity' - timestamptz 'infinity'
RESULT: 
	[(datetime.timedelta(0),)]

SELECT timestamptz 'infinity' - timestamptz '-infinity'
RESULT: 
	[(datetime.timedelta(days=213503982, seconds=30461, microseconds=552614),)]

SELECT timestamptz '-infinity' - timestamptz 'infinity'
RESULT: 
	[(datetime.timedelta(days=-213503983, seconds=55938, microseconds=447386),)]

SELECT timestamptz '-infinity' - timestamptz '-infinity'
RESULT: 
	[(datetime.timedelta(days=-1, seconds=86399, microseconds=999000),)]

SELECT timestamptz 'infinity' - timestamptz '1995-08-06 12:12:12'
RESULT: 
	[(datetime.timedelta(days=106742642, seconds=60522, microseconds=776807),)]

SELECT timestamptz '-infinity' - timestamptz '1995-08-06 12:12:12'
RESULT: 
	[(datetime.timedelta(days=-106761340, seconds=30061, microseconds=224193),)]


-- test age() with infinite timestamps
SELECT age(timestamptz 'infinity')
RESULT: 
	[(datetime.timedelta(days=-105200180, seconds=32066, microseconds=989193),)]

SELECT age(timestamptz '-infinity')
RESULT: 
	[(datetime.timedelta(days=105239280, seconds=62528, microseconds=542807),)]

SELECT age(timestamptz 'infinity', timestamptz 'infinity')
RESULT: 
	[(datetime.timedelta(0),)]

SELECT age(timestamptz 'infinity', timestamptz '-infinity')
RESULT: 
	[(datetime.timedelta(days=210439459, seconds=30461, microseconds=552614),)]

SELECT age(timestamptz '-infinity', timestamptz 'infinity')
RESULT: 
	[(datetime.timedelta(days=-210439460, seconds=55938, microseconds=447386),)]

SELECT age(timestamptz '-infinity', timestamptz '-infinity')
RESULT: 
	[(datetime.timedelta(days=-1, seconds=86399, microseconds=999000),)]


