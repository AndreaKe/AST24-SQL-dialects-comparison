
-----------
QUERY:
--
-- TRANSACTIONS
--

BEGIN;
RESULT:
	[]

-----------
QUERY:


CREATE TABLE xacttest (a smallint, b real);
RESULT:
	[]

-----------
QUERY:

INSERT INTO xacttest VALUES
  (56, 7.8),
  (100, 99.097),
  (0, 0.09561),
  (42, 324.78);
RESULT:
	[]

-----------
QUERY:

INSERT INTO xacttest (a, b) VALUES (777, 777.777);
RESULT:
	[]

-----------
QUERY:


END;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'END' at line 1")

-----------
QUERY:


-- should retrieve one value--
SELECT a FROM xacttest WHERE a > 100;
RESULT:
	((777,),)

-----------
QUERY:



BEGIN;
RESULT:
	[]

-----------
QUERY:


CREATE TABLE disappear (a int4);
RESULT:
	[]

-----------
QUERY:


DELETE FROM xacttest;
RESULT:
	[]

-----------
QUERY:


-- should be empty
SELECT * FROM xacttest;
RESULT:
	()

-----------
QUERY:


ABORT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ABORT' at line 1")

-----------
QUERY:


-- should not exist
SELECT oid FROM pg_class WHERE relname = 'disappear';
RESULT:
	ERROR - (1146, "Table 'test.pg_class' doesn't exist")

-----------
QUERY:


-- should have members again
SELECT * FROM xacttest;
RESULT:
	()

-----------
QUERY:


-- Test that transaction characteristics cannot be reset.
BEGIN TRANSACTION ISOLATION LEVEL SERIALIZABLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TRANSACTION ISOLATION LEVEL SERIALIZABLE' at line 2")

-----------
QUERY:

SELECT COUNT(*) FROM xacttest;
RESULT:
	((0,),)

-----------
QUERY:

RESET transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 1")

-----------
QUERY:
 -- error
END;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'END' at line 2")

-----------
QUERY:


BEGIN TRANSACTION READ ONLY;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TRANSACTION READ ONLY' at line 1")

-----------
QUERY:

SELECT COUNT(*) FROM xacttest;
RESULT:
	((0,),)

-----------
QUERY:

RESET transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:
 -- error
END;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'END' at line 2")

-----------
QUERY:


BEGIN TRANSACTION DEFERRABLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TRANSACTION DEFERRABLE' at line 1")

-----------
QUERY:

SELECT COUNT(*) FROM xacttest;
RESULT:
	((0,),)

-----------
QUERY:

RESET transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:
 -- error
END;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'END' at line 2")

-----------
QUERY:


CREATE FUNCTION errfunc() RETURNS int LANGUAGE SQL AS 'SELECT 1'
SET transaction_read_only = on;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 'SELECT 1'\nSET transaction_read_only = on' at line 1")

-----------
QUERY:
 -- error

-- Read-only tests

CREATE TABLE writetest (a int);
RESULT:
	[]

-----------
QUERY:

CREATE TEMPORARY TABLE temptest (a int);
RESULT:
	[]

-----------
QUERY:


BEGIN;
RESULT:
	[]

-----------
QUERY:

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE, READ ONLY, DEFERRABLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ', DEFERRABLE' at line 1")

-----------
QUERY:
 -- ok
SELECT * FROM writetest;
RESULT:
	()

-----------
QUERY:
 -- ok
SET TRANSACTION READ WRITE;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 --fail
COMMIT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--fail\nCOMMIT' at line 1")

-----------
QUERY:


BEGIN;
RESULT:
	[]

-----------
QUERY:

SET TRANSACTION READ ONLY;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SET TRANSACTION READ WRITE;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SET TRANSACTION READ ONLY;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SELECT * FROM writetest;
RESULT:
	()

-----------
QUERY:
 -- ok
SAVEPOINT x;
RESULT:
	[]

-----------
QUERY:

SET TRANSACTION READ ONLY;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SELECT * FROM writetest;
RESULT:
	()

-----------
QUERY:
 -- ok
SET TRANSACTION READ ONLY;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SET TRANSACTION READ WRITE;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 --fail
COMMIT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--fail\nCOMMIT' at line 1")

-----------
QUERY:


BEGIN;
RESULT:
	[]

-----------
QUERY:

SET TRANSACTION READ WRITE;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SAVEPOINT x;
RESULT:
	[]

-----------
QUERY:

SET TRANSACTION READ WRITE;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SET TRANSACTION READ ONLY;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SELECT * FROM writetest;
RESULT:
	()

-----------
QUERY:
 -- ok
SET TRANSACTION READ ONLY;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SET TRANSACTION READ WRITE;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 --fail
COMMIT;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--fail\nCOMMIT' at line 1")

-----------
QUERY:


BEGIN;
RESULT:
	[]

-----------
QUERY:

SET TRANSACTION READ WRITE;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SAVEPOINT x;
RESULT:
	[]

-----------
QUERY:

SET TRANSACTION READ ONLY;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SELECT * FROM writetest;
RESULT:
	()

-----------
QUERY:
 -- ok
ROLLBACK TO SAVEPOINT x;
RESULT:
	[]

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:
  -- off
SAVEPOINT y;
RESULT:
	[]

-----------
QUERY:

SET TRANSACTION READ ONLY;
RESULT:
	ERROR - (1568, "Transaction characteristics can't be changed while a transaction is in progress")

-----------
QUERY:
 -- ok
SELECT * FROM writetest;
RESULT:
	()

-----------
QUERY:
 -- ok
RELEASE SAVEPOINT y;
RESULT:
	[]

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:
  -- off
COMMIT;
RESULT:
	[]

-----------
QUERY:


SET SESSION CHARACTERISTICS AS TRANSACTION READ ONLY;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS TRANSACTION READ ONLY' at line 1")

-----------
QUERY:


DROP TABLE writetest;
RESULT:
	[]

-----------
QUERY:
 -- fail
INSERT INTO writetest VALUES (1);
RESULT:
	ERROR - (1146, "Table 'test.writetest' doesn't exist")

-----------
QUERY:
 -- fail
SELECT * FROM writetest;
RESULT:
	ERROR - (1146, "Table 'test.writetest' doesn't exist")

-----------
QUERY:
 -- ok
DELETE FROM temptest;
RESULT:
	[]

-----------
QUERY:
 -- ok
UPDATE temptest SET a = 0 FROM writetest WHERE temptest.a = 1 AND writetest.a = temptest.a;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM writetest WHERE temptest.a = 1 AND writetest.a = temptest.a' at line 2")

-----------
QUERY:
 -- ok
PREPARE test AS UPDATE writetest SET a = 0;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS UPDATE writetest SET a = 0' at line 2")

-----------
QUERY:
 -- ok
EXECUTE test;
RESULT:
	ERROR - (1243, 'Unknown prepared statement handler (test) given to EXECUTE')

-----------
QUERY:
 -- fail
SELECT * FROM writetest, temptest;
RESULT:
	ERROR - (1146, "Table 'test.writetest' doesn't exist")

-----------
QUERY:
 -- ok
CREATE TABLE test AS SELECT * FROM writetest;
RESULT:
	ERROR - (1146, "Table 'test.writetest' doesn't exist")

-----------
QUERY:
 -- fail

START TRANSACTION READ WRITE;
RESULT:
	[]

-----------
QUERY:

DROP TABLE writetest;
RESULT:
	ERROR - (1051, "Unknown table 'test.writetest'")

-----------
QUERY:
 -- ok
COMMIT;
RESULT:
	[]

-----------
QUERY:


-- Subtransactions, basic tests
-- create & drop tables
SET SESSION CHARACTERISTICS AS TRANSACTION READ WRITE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS TRANSACTION READ WRITE' at line 3")

-----------
QUERY:

CREATE TABLE trans_foobar (a int);
RESULT:
	[]

-----------
QUERY:

BEGIN;
RESULT:
	[]

-----------
QUERY:

	CREATE TABLE trans_foo (a int);
RESULT:
	[]

-----------
QUERY:

	SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		DROP TABLE trans_foo;
RESULT:
	[]

-----------
QUERY:

		CREATE TABLE trans_bar (a int);
RESULT:
	[]

-----------
QUERY:

	ROLLBACK TO SAVEPOINT one;
RESULT:
	ERROR - (1305, 'SAVEPOINT one does not exist')

-----------
QUERY:

	RELEASE SAVEPOINT one;
RESULT:
	ERROR - (1305, 'SAVEPOINT one does not exist')

-----------
QUERY:

	SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:

		CREATE TABLE trans_baz (a int);
RESULT:
	[]

-----------
QUERY:

	RELEASE SAVEPOINT two;
RESULT:
	ERROR - (1305, 'SAVEPOINT two does not exist')

-----------
QUERY:

	drop TABLE trans_foobar;
RESULT:
	[]

-----------
QUERY:

	CREATE TABLE trans_barbaz (a int);
RESULT:
	[]

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:

-- should exist: trans_barbaz, trans_baz, trans_foo
SELECT * FROM trans_foo;
RESULT:
	ERROR - (1146, "Table 'test.trans_foo' doesn't exist")

-----------
QUERY:
		-- should be empty
SELECT * FROM trans_bar;
RESULT:
	()

-----------
QUERY:
		-- shouldn/* REPLACED */ ''t exist
SELECT * FROM trans_barbaz;
RESULT:
	()

-----------
QUERY:
	-- should be empty
SELECT * FROM trans_baz;
RESULT:
	()

-----------
QUERY:
		-- should be empty

-- inserts
BEGIN;
RESULT:
	[]

-----------
QUERY:

	INSERT INTO trans_foo VALUES (1);
RESULT:
	ERROR - (1146, "Table 'test.trans_foo' doesn't exist")

-----------
QUERY:

	SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		INSERT into trans_bar VALUES (1);
RESULT:
	[]

-----------
QUERY:

	ROLLBACK TO one;
RESULT:
	[]

-----------
QUERY:

	RELEASE SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

	SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:

		INSERT into trans_barbaz VALUES (1);
RESULT:
	[]

-----------
QUERY:

	RELEASE two;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'two' at line 1")

-----------
QUERY:

	SAVEPOINT three;
RESULT:
	[]

-----------
QUERY:

		SAVEPOINT four;
RESULT:
	[]

-----------
QUERY:

			INSERT INTO trans_foo VALUES (2);
RESULT:
	ERROR - (1146, "Table 'test.trans_foo' doesn't exist")

-----------
QUERY:

		RELEASE SAVEPOINT four;
RESULT:
	[]

-----------
QUERY:

	ROLLBACK TO SAVEPOINT three;
RESULT:
	[]

-----------
QUERY:

	RELEASE SAVEPOINT three;
RESULT:
	[]

-----------
QUERY:

	INSERT INTO trans_foo VALUES (3);
RESULT:
	ERROR - (1146, "Table 'test.trans_foo' doesn't exist")

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:

SELECT * FROM trans_foo;
RESULT:
	ERROR - (1146, "Table 'test.trans_foo' doesn't exist")

-----------
QUERY:
		-- should have 1 and 3
SELECT * FROM trans_barbaz;
RESULT:
	((1,),)

-----------
QUERY:
	-- should have 1

-- test whole-tree commit
BEGIN;
RESULT:
	[]

-----------
QUERY:

	SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		SELECT trans_foo;
RESULT:
	ERROR - (1054, "Unknown column 'trans_foo' in 'field list'")

-----------
QUERY:

	ROLLBACK TO SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

	RELEASE SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

	SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:

		CREATE TABLE savepoints (a int);
RESULT:
	[]

-----------
QUERY:

		SAVEPOINT three;
RESULT:
	[]

-----------
QUERY:

			INSERT INTO savepoints VALUES (1);
RESULT:
	[]

-----------
QUERY:

			SAVEPOINT four;
RESULT:
	[]

-----------
QUERY:

				INSERT INTO savepoints VALUES (2);
RESULT:
	[]

-----------
QUERY:

				SAVEPOINT five;
RESULT:
	[]

-----------
QUERY:

					INSERT INTO savepoints VALUES (3);
RESULT:
	[]

-----------
QUERY:

				ROLLBACK TO SAVEPOINT five;
RESULT:
	[]

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:
		-- should not be in a transaction block
SELECT * FROM savepoints;
RESULT:
	((1,), (2,))

-----------
QUERY:


-- test whole-tree rollback
BEGIN;
RESULT:
	[]

-----------
QUERY:

	SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		DELETE FROM savepoints WHERE a=1;
RESULT:
	[]

-----------
QUERY:

	RELEASE SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

	SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:

		DELETE FROM savepoints WHERE a=1;
RESULT:
	[]

-----------
QUERY:

		SAVEPOINT three;
RESULT:
	[]

-----------
QUERY:

			DELETE FROM savepoints WHERE a=2;
RESULT:
	[]

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:
		-- should not be in a transaction block

SELECT * FROM savepoints;
RESULT:
	((1,), (2,))

-----------
QUERY:


-- test whole-tree commit on an aborted subtransaction
BEGIN;
RESULT:
	[]

-----------
QUERY:

	INSERT INTO savepoints VALUES (4);
RESULT:
	[]

-----------
QUERY:

	SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		INSERT INTO savepoints VALUES (5);
RESULT:
	[]

-----------
QUERY:

		SELECT trans_foo;
RESULT:
	ERROR - (1054, "Unknown column 'trans_foo' in 'field list'")

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:

SELECT * FROM savepoints;
RESULT:
	((1,), (2,), (4,), (5,))

-----------
QUERY:


BEGIN;
RESULT:
	[]

-----------
QUERY:

	INSERT INTO savepoints VALUES (6);
RESULT:
	[]

-----------
QUERY:

	SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		INSERT INTO savepoints VALUES (7);
RESULT:
	[]

-----------
QUERY:

	RELEASE SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

	INSERT INTO savepoints VALUES (8);
RESULT:
	[]

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:

-- rows 6 and 8 should have been created by the same xact
SELECT a.xmin = b.xmin FROM savepoints a, savepoints b WHERE a.a=6 AND b.a=8;
RESULT:
	ERROR - (1054, "Unknown column 'a.xmin' in 'field list'")

-----------
QUERY:

-- rows 6 and 7 should have been created by different xacts
SELECT a.xmin = b.xmin FROM savepoints a, savepoints b WHERE a.a=6 AND b.a=7;
RESULT:
	ERROR - (1054, "Unknown column 'a.xmin' in 'field list'")

-----------
QUERY:


BEGIN;
RESULT:
	[]

-----------
QUERY:

	INSERT INTO savepoints VALUES (9);
RESULT:
	[]

-----------
QUERY:

	SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		INSERT INTO savepoints VALUES (10);
RESULT:
	[]

-----------
QUERY:

	ROLLBACK TO SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		INSERT INTO savepoints VALUES (11);
RESULT:
	[]

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:

SELECT a FROM savepoints WHERE a in (9, 10, 11);
RESULT:
	((9,), (11,))

-----------
QUERY:

-- rows 9 and 11 should have been created by different xacts
SELECT a.xmin = b.xmin FROM savepoints a, savepoints b WHERE a.a=9 AND b.a=11;
RESULT:
	ERROR - (1054, "Unknown column 'a.xmin' in 'field list'")

-----------
QUERY:


BEGIN;
RESULT:
	[]

-----------
QUERY:

	INSERT INTO savepoints VALUES (12);
RESULT:
	[]

-----------
QUERY:

	SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		INSERT INTO savepoints VALUES (13);
RESULT:
	[]

-----------
QUERY:

		SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:

			INSERT INTO savepoints VALUES (14);
RESULT:
	[]

-----------
QUERY:

	ROLLBACK TO SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		INSERT INTO savepoints VALUES (15);
RESULT:
	[]

-----------
QUERY:

		SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:

			INSERT INTO savepoints VALUES (16);
RESULT:
	[]

-----------
QUERY:

			SAVEPOINT three;
RESULT:
	[]

-----------
QUERY:

				INSERT INTO savepoints VALUES (17);
RESULT:
	[]

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:

SELECT a FROM savepoints WHERE a BETWEEN 12 AND 17;
RESULT:
	((12,), (15,), (16,), (17,))

-----------
QUERY:


BEGIN;
RESULT:
	[]

-----------
QUERY:

	INSERT INTO savepoints VALUES (18);
RESULT:
	[]

-----------
QUERY:

	SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		INSERT INTO savepoints VALUES (19);
RESULT:
	[]

-----------
QUERY:

		SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:

			INSERT INTO savepoints VALUES (20);
RESULT:
	[]

-----------
QUERY:

	ROLLBACK TO SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		INSERT INTO savepoints VALUES (21);
RESULT:
	[]

-----------
QUERY:

	ROLLBACK TO SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		INSERT INTO savepoints VALUES (22);
RESULT:
	[]

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:

SELECT a FROM savepoints WHERE a BETWEEN 18 AND 22;
RESULT:
	((18,), (22,))

-----------
QUERY:


DROP TABLE savepoints;
RESULT:
	[]

-----------
QUERY:


-- only in a transaction block:
SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

ROLLBACK TO SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

RELEASE SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:


-- Only /* REPLACED */ ''rollback to/* REPLACED */ '' allowed in aborted state
BEGIN;
RESULT:
	[]

-----------
QUERY:

  SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

  SELECT 0/0;
RESULT:
	((None,),)

-----------
QUERY:

  SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:
    -- ignored till the end of ...
  RELEASE SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:
      -- ignored till the end of ...
  ROLLBACK TO SAVEPOINT one;
RESULT:
	ERROR - (1305, 'SAVEPOINT one does not exist')

-----------
QUERY:

  SELECT 1;
RESULT:
	((1,),)

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:

SELECT 1;
RESULT:
	((1,),)

-----------
QUERY:
			-- this should work

-- check non-transactional behavior of cursors
BEGIN;
RESULT:
	[]

-----------
QUERY:

	DECLARE c CURSOR FOR SELECT unique2 FROM tenk1 ORDER BY unique2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DECLARE c CURSOR FOR SELECT unique2 FROM tenk1 ORDER BY unique2' at line 1")

-----------
QUERY:

	SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		FETCH 10 FROM c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FETCH 10 FROM c' at line 1")

-----------
QUERY:

	ROLLBACK TO SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

		FETCH 10 FROM c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FETCH 10 FROM c' at line 1")

-----------
QUERY:

	RELEASE SAVEPOINT one;
RESULT:
	[]

-----------
QUERY:

	FETCH 10 FROM c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FETCH 10 FROM c' at line 1")

-----------
QUERY:

	CLOSE c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CLOSE c' at line 1")

-----------
QUERY:

	DECLARE c CURSOR FOR SELECT unique2/0 FROM tenk1 ORDER BY unique2;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DECLARE c CURSOR FOR SELECT unique2/0 FROM tenk1 ORDER BY unique2' at line 1")

-----------
QUERY:

	SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:

		FETCH 10 FROM c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FETCH 10 FROM c' at line 1")

-----------
QUERY:

	ROLLBACK TO SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:

	-- c is now dead to the world ...
		FETCH 10 FROM c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FETCH 10 FROM c' at line 2")

-----------
QUERY:

	ROLLBACK TO SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:

	RELEASE SAVEPOINT two;
RESULT:
	[]

-----------
QUERY:

	FETCH 10 FROM c;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FETCH 10 FROM c' at line 1")

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:


--
-- Check that /* REPLACED */ ''stable/* REPLACED */ '' functions are really stable.  They should not be
-- able to see the partial results of the calling query.  (Ideally we would
-- also check that they don/* REPLACED */ ''t see commits of concurrent transactions, but
-- that/* REPLACED */ ''s a mite hard to do within the limitations of pg_regress.)
--
select * from xacttest;
RESULT:
	()

-----------
QUERY:


create or replace function max_xacttest() returns smallint language sql as
'select max(a) from xacttest' stable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'function max_xacttest() returns smallint language sql as\n'select max(a) from xac' at line 1")

-----------
QUERY:


begin;
RESULT:
	[]

-----------
QUERY:

update xacttest set a = max_xacttest() + 10 where a > 0;
RESULT:
	ERROR - (1305, 'FUNCTION test.max_xacttest does not exist')

-----------
QUERY:

select * from xacttest;
RESULT:
	()

-----------
QUERY:

rollback;
RESULT:
	[]

-----------
QUERY:


-- But a volatile function can see the partial results of the calling query
create or replace function max_xacttest() returns smallint language sql as
'select max(a) from xacttest' volatile;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'function max_xacttest() returns smallint language sql as\n'select max(a) from xac' at line 2")

-----------
QUERY:


begin;
RESULT:
	[]

-----------
QUERY:

update xacttest set a = max_xacttest() + 10 where a > 0;
RESULT:
	ERROR - (1305, 'FUNCTION test.max_xacttest does not exist')

-----------
QUERY:

select * from xacttest;
RESULT:
	()

-----------
QUERY:

rollback;
RESULT:
	[]

-----------
QUERY:


-- Now the same test with plpgsql (since it depends on SPI which is different)
create or replace function max_xacttest() returns smallint language plpgsql as
'begin return max(a) from xacttest;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'function max_xacttest() returns smallint language plpgsql as\n'begin return max(a' at line 2")

-----------
QUERY:
 end' stable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'end' stable' at line 1")

-----------
QUERY:


begin;
RESULT:
	[]

-----------
QUERY:

update xacttest set a = max_xacttest() + 10 where a > 0;
RESULT:
	ERROR - (1305, 'FUNCTION test.max_xacttest does not exist')

-----------
QUERY:

select * from xacttest;
RESULT:
	()

-----------
QUERY:

rollback;
RESULT:
	[]

-----------
QUERY:


create or replace function max_xacttest() returns smallint language plpgsql as
'begin return max(a) from xacttest;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'function max_xacttest() returns smallint language plpgsql as\n'begin return max(a' at line 1")

-----------
QUERY:
 end' volatile;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'end' volatile' at line 1")

-----------
QUERY:


begin;
RESULT:
	[]

-----------
QUERY:

update xacttest set a = max_xacttest() + 10 where a > 0;
RESULT:
	ERROR - (1305, 'FUNCTION test.max_xacttest does not exist')

-----------
QUERY:

select * from xacttest;
RESULT:
	()

-----------
QUERY:

rollback;
RESULT:
	[]

-----------
QUERY:



-- test case for problems with dropping an open relation during abort
BEGIN;
RESULT:
	[]

-----------
QUERY:

	savepoint x;
RESULT:
	[]

-----------
QUERY:

		CREATE TABLE koju (a INT UNIQUE);
RESULT:
	[]

-----------
QUERY:

		INSERT INTO koju VALUES (1);
RESULT:
	[]

-----------
QUERY:

		INSERT INTO koju VALUES (1);
RESULT:
	ERROR - (1062, "Duplicate entry '1' for key 'koju.a'")

-----------
QUERY:

	rollback to x;
RESULT:
	ERROR - (1305, 'SAVEPOINT x does not exist')

-----------
QUERY:


	CREATE TABLE koju (a INT UNIQUE);
RESULT:
	ERROR - (1050, "Table 'koju' already exists")

-----------
QUERY:

	INSERT INTO koju VALUES (1);
RESULT:
	ERROR - (1062, "Duplicate entry '1' for key 'koju.a'")

-----------
QUERY:

	INSERT INTO koju VALUES (1);
RESULT:
	ERROR - (1062, "Duplicate entry '1' for key 'koju.a'")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:


DROP TABLE trans_foo;
RESULT:
	ERROR - (1051, "Unknown table 'test.trans_foo'")

-----------
QUERY:

DROP TABLE trans_baz;
RESULT:
	[]

-----------
QUERY:

DROP TABLE trans_barbaz;
RESULT:
	[]

-----------
QUERY:



-- test case for problems with revalidating an open relation during abort
create function inverse(int) returns float8 as
$$
begin
  analyze revalidate_bug;
  return 1::float8/$1;
exception
  when division_by_zero then return 0;
end$$ language plpgsql volatile;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'int) returns float8 as\n$$\nbegin\n  analyze revalidate_bug;\n  return 1::float8/$1;' at line 2")

-----------
QUERY:


create table revalidate_bug (c float8 unique);
RESULT:
	[]

-----------
QUERY:

insert into revalidate_bug values (1);
RESULT:
	[]

-----------
QUERY:

insert into revalidate_bug values (inverse(0));
RESULT:
	ERROR - (1305, 'FUNCTION test.inverse does not exist')

-----------
QUERY:


drop table revalidate_bug;
RESULT:
	[]

-----------
QUERY:

drop function inverse(int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(int)' at line 1")

-----------
QUERY:



-- verify that cursors created during an aborted subtransaction are
-- closed, but that we do not rollback the effect of any FETCHs
-- performed in the aborted subtransaction
begin;
RESULT:
	[]

-----------
QUERY:


savepoint x;
RESULT:
	[]

-----------
QUERY:

create table trans_abc (a int);
RESULT:
	[]

-----------
QUERY:

insert into trans_abc values (5);
RESULT:
	[]

-----------
QUERY:

insert into trans_abc values (10);
RESULT:
	[]

-----------
QUERY:

declare foo cursor for select * from trans_abc;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'declare foo cursor for select * from trans_abc' at line 1")

-----------
QUERY:

fetch from foo;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'fetch from foo' at line 1")

-----------
QUERY:

rollback to x;
RESULT:
	ERROR - (1305, 'SAVEPOINT x does not exist')

-----------
QUERY:


-- should fail
fetch from foo;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'fetch from foo' at line 2")

-----------
QUERY:

commit;
RESULT:
	[]

-----------
QUERY:


begin;
RESULT:
	[]

-----------
QUERY:


create table trans_abc (a int);
RESULT:
	ERROR - (1050, "Table 'trans_abc' already exists")

-----------
QUERY:

insert into trans_abc values (5);
RESULT:
	[]

-----------
QUERY:

insert into trans_abc values (10);
RESULT:
	[]

-----------
QUERY:

insert into trans_abc values (15);
RESULT:
	[]

-----------
QUERY:

declare foo cursor for select * from trans_abc;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'declare foo cursor for select * from trans_abc' at line 1")

-----------
QUERY:


fetch from foo;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'fetch from foo' at line 1")

-----------
QUERY:


savepoint x;
RESULT:
	[]

-----------
QUERY:

fetch from foo;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'fetch from foo' at line 1")

-----------
QUERY:

rollback to x;
RESULT:
	[]

-----------
QUERY:


fetch from foo;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'fetch from foo' at line 1")

-----------
QUERY:


abort;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'abort' at line 1")

-----------
QUERY:



-- Test for proper cleanup after a failure in a cursor portal
-- that was created in an outer subtransaction
CREATE FUNCTION invert(x float8) RETURNS float8 LANGUAGE plpgsql AS
$$ begin return 1/x; end $$;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'plpgsql AS\n$$ begin return 1/x; end $$' at line 3")

-----------
QUERY:


CREATE FUNCTION create_temp_tab() RETURNS text
LANGUAGE plpgsql AS $$
BEGIN
  CREATE TEMP TABLE new_table (f1 float8);
  -- case of interest is that we fail while holding an open
  -- relcache reference to new_table
  INSERT INTO new_table SELECT invert(0.0);
  RETURN 'foo';
END $$;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'plpgsql AS $$\nBEGIN\n  CREATE TEMP TABLE new_table (f1 float8);\n  -- case of inte' at line 2")

-----------
QUERY:


BEGIN;
RESULT:
	[]

-----------
QUERY:

DECLARE ok CURSOR FOR SELECT * FROM int8_tbl;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DECLARE ok CURSOR FOR SELECT * FROM int8_tbl' at line 1")

-----------
QUERY:

DECLARE ctt CURSOR FOR SELECT create_temp_tab();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DECLARE ctt CURSOR FOR SELECT create_temp_tab()' at line 1")

-----------
QUERY:

FETCH ok;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FETCH ok' at line 1")

-----------
QUERY:

SAVEPOINT s1;
RESULT:
	[]

-----------
QUERY:

FETCH ok;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FETCH ok' at line 1")

-----------
QUERY:
  -- should work
FETCH ctt;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FETCH ctt' at line 2")

-----------
QUERY:
 -- error occurs here
ROLLBACK TO s1;
RESULT:
	[]

-----------
QUERY:

FETCH ok;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FETCH ok' at line 1")

-----------
QUERY:
  -- should work
FETCH ctt;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FETCH ctt' at line 2")

-----------
QUERY:
 -- must be rejected
COMMIT;
RESULT:
	[]

-----------
QUERY:


DROP FUNCTION create_temp_tab();
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '()' at line 1")

-----------
QUERY:

DROP FUNCTION invert(x float8);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(x float8)' at line 1")

-----------
QUERY:



-- Tests for AND CHAIN

CREATE TABLE trans_abc (a int);
RESULT:
	ERROR - (1050, "Table 'trans_abc' already exists")

-----------
QUERY:


-- set nondefault value so we have something to override below
SET default_transaction_read_only = on;
RESULT:
	ERROR - (1193, "Unknown system variable 'default_transaction_read_only'")

-----------
QUERY:


START TRANSACTION ISOLATION LEVEL REPEATABLE READ, READ WRITE, DEFERRABLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ISOLATION LEVEL REPEATABLE READ, READ WRITE, DEFERRABLE' at line 1")

-----------
QUERY:

SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 1")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

INSERT INTO trans_abc VALUES (1);
RESULT:
	[]

-----------
QUERY:

INSERT INTO trans_abc VALUES (2);
RESULT:
	[]

-----------
QUERY:

COMMIT AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- TBLOCK_END
SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 2")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

INSERT INTO trans_abc VALUES ('error');
RESULT:
	ERROR - (1366, "Incorrect integer value: 'error' for column 'a' at row 1")

-----------
QUERY:

INSERT INTO trans_abc VALUES (3);
RESULT:
	[]

-----------
QUERY:
  -- check it/* REPLACED */ ''s really aborted
COMMIT AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- TBLOCK_ABORT_END
SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 2")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

INSERT INTO trans_abc VALUES (4);
RESULT:
	[]

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:


START TRANSACTION ISOLATION LEVEL REPEATABLE READ, READ WRITE, DEFERRABLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ISOLATION LEVEL REPEATABLE READ, READ WRITE, DEFERRABLE' at line 1")

-----------
QUERY:

SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 1")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

SAVEPOINT x;
RESULT:
	[]

-----------
QUERY:

INSERT INTO trans_abc VALUES ('error');
RESULT:
	ERROR - (1366, "Incorrect integer value: 'error' for column 'a' at row 1")

-----------
QUERY:

COMMIT AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- TBLOCK_ABORT_PENDING
SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 2")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

INSERT INTO trans_abc VALUES (5);
RESULT:
	[]

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:


START TRANSACTION ISOLATION LEVEL REPEATABLE READ, READ WRITE, DEFERRABLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ISOLATION LEVEL REPEATABLE READ, READ WRITE, DEFERRABLE' at line 1")

-----------
QUERY:

SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 1")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

SAVEPOINT x;
RESULT:
	[]

-----------
QUERY:

COMMIT AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- TBLOCK_SUBCOMMIT
SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 2")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:


START TRANSACTION ISOLATION LEVEL READ COMMITTED, READ WRITE, DEFERRABLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ISOLATION LEVEL READ COMMITTED, READ WRITE, DEFERRABLE' at line 1")

-----------
QUERY:

SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 1")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

SAVEPOINT x;
RESULT:
	[]

-----------
QUERY:

COMMIT AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- TBLOCK_SUBCOMMIT
SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 2")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

COMMIT;
RESULT:
	[]

-----------
QUERY:


-- different mix of options just for fun
START TRANSACTION ISOLATION LEVEL SERIALIZABLE, READ WRITE, NOT DEFERRABLE;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ISOLATION LEVEL SERIALIZABLE, READ WRITE, NOT DEFERRABLE' at line 2")

-----------
QUERY:

SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 1")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

INSERT INTO trans_abc VALUES (6);
RESULT:
	[]

-----------
QUERY:

ROLLBACK AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- TBLOCK_ABORT_PENDING
SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 2")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

INSERT INTO trans_abc VALUES ('error');
RESULT:
	ERROR - (1366, "Incorrect integer value: 'error' for column 'a' at row 1")

-----------
QUERY:

ROLLBACK AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- TBLOCK_ABORT_END
SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 2")

-----------
QUERY:

SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 1")

-----------
QUERY:

SHOW transaction_deferrable;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_deferrable' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:


-- not allowed outside a transaction block
COMMIT AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- error
ROLLBACK AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- error

SELECT * FROM trans_abc ORDER BY 1;
RESULT:
	((1,), (2,), (3,), (4,), (5,), (5,), (5,), (10,), (10,), (15,))

-----------
QUERY:


RESET default_transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'default_transaction_read_only' at line 1")

-----------
QUERY:


DROP TABLE trans_abc;
RESULT:
	[]

-----------
QUERY:



-- Test assorted behaviors around the implicit transaction block created
-- when multiple SQL commands are sent in a single Query message.  These
-- tests rely on the fact that psql will not break SQL commands apart at a
-- backslash-quoted semicolon, but will send them as one Query.

create temp table i_table (f1 int);
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'temp table i_table (f1 int)' at line 6")

-----------
QUERY:


-- psql will show all results of a multi-statement Query
SELECT 1\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 2")

-----------
QUERY:
 SELECT 2\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 SELECT 3;
RESULT:
	((3,),)

-----------
QUERY:


-- this implicitly commits:
insert into i_table values(1)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 2")

-----------
QUERY:
 select * from i_table;
RESULT:
	ERROR - (1146, "Table 'test.i_table' doesn't exist")

-----------
QUERY:

-- 1/0 error will cause rolling back the whole implicit transaction
insert into i_table values(2)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 2")

-----------
QUERY:
 select * from i_table\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 select 1/0;
RESULT:
	((None,),)

-----------
QUERY:

select * from i_table;
RESULT:
	ERROR - (1146, "Table 'test.i_table' doesn't exist")

-----------
QUERY:


rollback;
RESULT:
	[]

-----------
QUERY:
  -- we are not in a transaction at this point

-- can use regular begin/commit/rollback within a single Query
begin\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 4")

-----------
QUERY:
 insert into i_table values(3)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 commit;
RESULT:
	[]

-----------
QUERY:

rollback;
RESULT:
	[]

-----------
QUERY:
  -- we are not in a transaction at this point
begin\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 2")

-----------
QUERY:
 insert into i_table values(4)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 rollback;
RESULT:
	[]

-----------
QUERY:

rollback;
RESULT:
	[]

-----------
QUERY:
  -- we are not in a transaction at this point

-- begin converts implicit transaction into a regular one that
-- can extend past the end of the Query
select 1\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 5")

-----------
QUERY:
 begin\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 insert into i_table values(5);
RESULT:
	ERROR - (1146, "Table 'test.i_table' doesn't exist")

-----------
QUERY:

commit;
RESULT:
	[]

-----------
QUERY:

select 1\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 begin\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 insert into i_table values(6);
RESULT:
	ERROR - (1146, "Table 'test.i_table' doesn't exist")

-----------
QUERY:

rollback;
RESULT:
	[]

-----------
QUERY:


-- commit in implicit-transaction state commits but issues a warning.
insert into i_table values(7)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 2")

-----------
QUERY:
 commit\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 insert into i_table values(8)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 select 1/0;
RESULT:
	((None,),)

-----------
QUERY:

-- similarly, rollback aborts but issues a warning.
insert into i_table values(9)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 2")

-----------
QUERY:
 rollback\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 select 2;
RESULT:
	((2,),)

-----------
QUERY:


select * from i_table;
RESULT:
	ERROR - (1146, "Table 'test.i_table' doesn't exist")

-----------
QUERY:


rollback;
RESULT:
	[]

-----------
QUERY:
  -- we are not in a transaction at this point

-- implicit transaction block is still a transaction block, for e.g. VACUUM
SELECT 1\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 4")

-----------
QUERY:
 VACUUM;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VACUUM' at line 1")

-----------
QUERY:

SELECT 1\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 COMMIT\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 VACUUM;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'VACUUM' at line 1")

-----------
QUERY:


-- we disallow savepoint-related commands in implicit-transaction state
SELECT 1\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 2")

-----------
QUERY:
 SAVEPOINT sp;
RESULT:
	[]

-----------
QUERY:

SELECT 1\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 COMMIT\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 SAVEPOINT sp;
RESULT:
	[]

-----------
QUERY:

ROLLBACK TO SAVEPOINT sp\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 SELECT 2;
RESULT:
	((2,),)

-----------
QUERY:

SELECT 2\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 RELEASE SAVEPOINT sp\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 SELECT 3;
RESULT:
	((3,),)

-----------
QUERY:


-- but this is OK, because the BEGIN converts it to a regular xact
SELECT 1\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 2")

-----------
QUERY:
 BEGIN\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 SAVEPOINT sp\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 ROLLBACK TO SAVEPOINT sp\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 COMMIT;
RESULT:
	[]

-----------
QUERY:



-- Tests for AND CHAIN in implicit transaction blocks

SET TRANSACTION READ ONLY\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 3")

-----------
QUERY:
 COMMIT AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- error
SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 2")

-----------
QUERY:


SET TRANSACTION READ ONLY\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 ROLLBACK AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- error
SHOW transaction_read_only;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_read_only' at line 2")

-----------
QUERY:


CREATE TABLE trans_abc (a int);
RESULT:
	[]

-----------
QUERY:


-- COMMIT/ROLLBACK + COMMIT/ROLLBACK AND CHAIN
INSERT INTO trans_abc VALUES (7)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 2")

-----------
QUERY:
 COMMIT\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 INSERT INTO trans_abc VALUES (8)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 COMMIT AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- 7 commit, 8 error
INSERT INTO trans_abc VALUES (9)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 2")

-----------
QUERY:
 ROLLBACK\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 INSERT INTO trans_abc VALUES (10)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 ROLLBACK AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- 9 rollback, 10 error

-- COMMIT/ROLLBACK AND CHAIN + COMMIT/ROLLBACK
INSERT INTO trans_abc VALUES (11)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 4")

-----------
QUERY:
 COMMIT AND CHAIN\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 INSERT INTO trans_abc VALUES (12)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 COMMIT;
RESULT:
	[]

-----------
QUERY:
  -- 11 error, 12 not reached
INSERT INTO trans_abc VALUES (13)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 2")

-----------
QUERY:
 ROLLBACK AND CHAIN\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 INSERT INTO trans_abc VALUES (14)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 ROLLBACK;
RESULT:
	[]

-----------
QUERY:
  -- 13 error, 14 not reached

-- START TRANSACTION + COMMIT/ROLLBACK AND CHAIN
START TRANSACTION ISOLATION LEVEL REPEATABLE READ\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ISOLATION LEVEL REPEATABLE READ\\' at line 4")

-----------
QUERY:
 INSERT INTO trans_abc VALUES (15)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 COMMIT AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- 15 ok
SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 2")

-----------
QUERY:
  -- transaction is active at this point
COMMIT;
RESULT:
	[]

-----------
QUERY:


START TRANSACTION ISOLATION LEVEL REPEATABLE READ\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ISOLATION LEVEL REPEATABLE READ\\' at line 1")

-----------
QUERY:
 INSERT INTO trans_abc VALUES (16)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 ROLLBACK AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- 16 ok
SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 2")

-----------
QUERY:
  -- transaction is active at this point
ROLLBACK;
RESULT:
	[]

-----------
QUERY:


SET default_transaction_isolation = 'read committed';
RESULT:
	ERROR - (1193, "Unknown system variable 'default_transaction_isolation'")

-----------
QUERY:


-- START TRANSACTION + COMMIT/ROLLBACK + COMMIT/ROLLBACK AND CHAIN
START TRANSACTION ISOLATION LEVEL REPEATABLE READ\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ISOLATION LEVEL REPEATABLE READ\\' at line 2")

-----------
QUERY:
 INSERT INTO trans_abc VALUES (17)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 COMMIT\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 INSERT INTO trans_abc VALUES (18)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 COMMIT AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- 17 commit, 18 error
SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 2")

-----------
QUERY:
  -- out of transaction block

START TRANSACTION ISOLATION LEVEL REPEATABLE READ\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ISOLATION LEVEL REPEATABLE READ\\' at line 3")

-----------
QUERY:
 INSERT INTO trans_abc VALUES (19)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 ROLLBACK\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 INSERT INTO trans_abc VALUES (20)\;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' at line 1")

-----------
QUERY:
 ROLLBACK AND CHAIN;
RESULT:
	[]

-----------
QUERY:
  -- 19 rollback, 20 error
SHOW transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'transaction_isolation' at line 2")

-----------
QUERY:
  -- out of transaction block

RESET default_transaction_isolation;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'default_transaction_isolation' at line 3")

-----------
QUERY:


SELECT * FROM trans_abc ORDER BY 1;
RESULT:
	()

-----------
QUERY:


DROP TABLE trans_abc;
RESULT:
	[]

-----------
QUERY:


-- TRANSACTION SNAPSHOT
-- Incorrect identifier.
BEGIN TRANSACTION ISOLATION LEVEL REPEATABLE READ;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TRANSACTION ISOLATION LEVEL REPEATABLE READ' at line 3")

-----------
QUERY:

SET TRANSACTION SNAPSHOT 'Incorrect Identifier';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SNAPSHOT 'Incorrect Identifier'' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:

-- Correct identifier, missing file.
BEGIN TRANSACTION ISOLATION LEVEL REPEATABLE READ;
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TRANSACTION ISOLATION LEVEL REPEATABLE READ' at line 2")

-----------
QUERY:

SET TRANSACTION SNAPSHOT 'FFF-FFF-F';
RESULT:
	ERROR - (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SNAPSHOT 'FFF-FFF-F'' at line 1")

-----------
QUERY:

ROLLBACK;
RESULT:
	[]

-----------
QUERY:


-- Test for successful cleanup of an aborted transaction at session exit.
-- THIS MUST BE THE LAST TEST IN THIS FILE.

begin;
RESULT:
	[]

-----------
QUERY:

select 1/0;
RESULT:
	((None,),)

-----------
QUERY:

rollback to X;
RESULT:
	ERROR - (1305, 'SAVEPOINT X does not exist')
