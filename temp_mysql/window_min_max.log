/home/stephanie/mysql-server/build/runtime_output_directory/mysqld, Version: 8.0.36 (Source distribution). started with:
Tcp port: 13000  Unix socket: /home/stephanie/mysql-server/build/mysql-test/var/tmp/mysqld.1.sock
Time                 Id Command    Argument
2024-05-01T14:10:58.961868Z	    9 Query	SET GLOBAL general_log = 'ON'
2024-05-01T14:10:58.962508Z	    9 Query	SET NAMES utf8
2024-05-01T14:10:58.963042Z	    9 Query	SHOW WARNINGS
2024-05-01T14:10:58.964024Z	    9 Query	CREATE TABLE t(i INT, j INT)
2024-05-01T14:11:00.243445Z	    9 Query	INSERT INTO t VALUES (1,1)
2024-05-01T14:11:00.409924Z	    9 Query	INSERT INTO t VALUES (1,4)
2024-05-01T14:11:00.565728Z	    9 Query	INSERT INTO t VALUES (1,2)
2024-05-01T14:11:00.710202Z	    9 Query	INSERT INTO t VALUES (1,4)
2024-05-01T14:11:00.900191Z	    9 Query	ANALYZE TABLE t
2024-05-01T14:11:01.267601Z	    9 Query	SELECT i, j, MIN(i) OVER (ROWS UNBOUNDED PRECEDING) min,
MAX(j) OVER (ROWS UNBOUNDED PRECEDING) max FROM t
2024-05-01T14:11:01.269861Z	    9 Query	SELECT i, j, MIN(i) OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) min,
MAX(j) OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) max FROM t
2024-05-01T14:11:01.271785Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY j
2024-05-01T14:11:01.272994Z	    9 Query	SELECT i, j, MAX(i+j) OVER (ROWS UNBOUNDED PRECEDING) max FROM t ORDER BY j
2024-05-01T14:11:01.274117Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY j DESC
2024-05-01T14:11:01.275218Z	    9 Query	SELECT i, j, MAX(i+j) OVER (ROWS UNBOUNDED PRECEDING) max FROM t ORDER BY j DESC
2024-05-01T14:11:01.276263Z	    9 Query	SELECT i, j, MIN(i) OVER (ORDER BY j ROWS UNBOUNDED PRECEDING) min,
MAX(j) OVER (ORDER BY j ROWS UNBOUNDED PRECEDING) max FROM t
2024-05-01T14:11:01.277413Z	    9 Query	SELECT i, j, MIN(j) OVER (ORDER BY j ROWS UNBOUNDED PRECEDING) min,
MAX(i) OVER (ORDER BY i ROWS UNBOUNDED PRECEDING) max FROM t ORDER BY j
2024-05-01T14:11:01.278642Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ORDER BY j ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY j DESC
2024-05-01T14:11:01.279854Z	    9 Query	SELECT i, j, MAX(i+j) OVER (ORDER BY j ROWS UNBOUNDED PRECEDING) max FROM t ORDER BY j DESC
2024-05-01T14:11:01.281764Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ORDER BY j DESC ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY j DESC
2024-05-01T14:11:01.283264Z	    9 Query	SELECT i, j, MAX(i+j) OVER (ORDER BY j DESC ROWS UNBOUNDED PRECEDING) max FROM t ORDER BY j DESC
2024-05-01T14:11:01.284733Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY NULL DESC
2024-05-01T14:11:01.285886Z	    9 Query	EXPLAIN FORMAT=JSON SELECT i, j, MIN(i+j) OVER (ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY NULL DESC
2024-05-01T14:11:01.286928Z	    9 Query	SHOW WARNINGS
2024-05-01T14:11:01.287585Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY j DESC LIMIT 3
2024-05-01T14:11:01.288701Z	    9 Query	CREATE VIEW v AS
SELECT i, j, MIN(i+j) OVER (ORDER BY j DESC ROWS UNBOUNDED PRECEDING) min,
MAX(i+j) OVER (ORDER BY j DESC ROWS UNBOUNDED PRECEDING) max FROM t
2024-05-01T14:11:01.478716Z	    9 Query	SHOW CREATE VIEW v
2024-05-01T14:11:01.482634Z	    9 Query	SELECT * FROM v
2024-05-01T14:11:01.485083Z	    9 Query	DROP VIEW v
2024-05-01T14:11:01.701390Z	    9 Query	TRUNCATE TABLE t
2024-05-01T14:11:02.983830Z	    9 Query	INSERT INTO t VALUES (999961560, DEFAULT)
2024-05-01T14:11:03.105980Z	    9 Query	INSERT INTO t VALUES (44721, DEFAULT)
2024-05-01T14:11:03.237740Z	    9 Query	SELECT MIN(i) OVER () FROM t
2024-05-01T14:11:03.239323Z	    9 Query	SELECT MAX(i) OVER () FROM t
2024-05-01T14:11:03.240465Z	    9 Query	DROP TABLE t
2024-05-01T14:11:04.075125Z	    9 Query	CREATE TABLE t(i INT, j INT, k INT)
2024-05-01T14:11:05.023490Z	    9 Query	INSERT INTO t VALUES (1,1,1)
2024-05-01T14:11:05.187292Z	    9 Query	INSERT INTO t VALUES (1,4,1)
2024-05-01T14:11:05.466936Z	    9 Query	INSERT INTO t VALUES (1,2,1)
2024-05-01T14:11:05.677813Z	    9 Query	INSERT INTO t VALUES (1,4,1)
2024-05-01T14:11:05.835684Z	    9 Query	INSERT INTO t VALUES (1,4,1)
2024-05-01T14:11:05.924999Z	    9 Query	INSERT INTO t VALUES (1,1,2)
2024-05-01T14:11:06.091971Z	    9 Query	INSERT INTO t VALUES (1,4,2)
2024-05-01T14:11:06.202811Z	    9 Query	INSERT INTO t VALUES (1,2,2)
2024-05-01T14:11:06.359693Z	    9 Query	INSERT INTO t VALUES (1,4,2)
2024-05-01T14:11:06.588337Z	    9 Query	INSERT INTO t VALUES (1,1,3)
2024-05-01T14:11:06.759579Z	    9 Query	INSERT INTO t VALUES (1,4,3)
2024-05-01T14:11:06.881548Z	    9 Query	INSERT INTO t VALUES (1,2,3)
2024-05-01T14:11:07.060458Z	    9 Query	INSERT INTO t VALUES (1,4,3)
2024-05-01T14:11:07.171962Z	    9 Query	INSERT INTO t VALUES (1,1,4)
2024-05-01T14:11:07.329736Z	    9 Query	INSERT INTO t VALUES (1,4,4)
2024-05-01T14:11:07.635186Z	    9 Query	INSERT INTO t VALUES (1,2,4)
2024-05-01T14:11:07.796486Z	    9 Query	INSERT INTO t VALUES (1,4,4)
2024-05-01T14:11:07.928331Z	    9 Query	SELECT k, MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min,
MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max FROM t
2024-05-01T14:11:07.929222Z	    9 Query	SELECT k, MIN(i), SUM(j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min_wf FROM t GROUP BY (k)
2024-05-01T14:11:07.930062Z	    9 Query	SELECT k, MIN(i), SUM(j), MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max_wf FROM t GROUP BY (k)
2024-05-01T14:11:07.930818Z	    9 Query	SELECT k, MIN(i), SUM(j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min_wf FROM t GROUP BY (k) ORDER BY min_wf DESC
2024-05-01T14:11:07.931468Z	    9 Query	SELECT k, MIN(i), SUM(j), MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max_wf FROM t GROUP BY (k) ORDER BY max_wf DESC
2024-05-01T14:11:07.932052Z	    9 Query	SELECT k, GROUP_CONCAT(j ORDER BY j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min,
MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max FROM t GROUP BY (k)
2024-05-01T14:11:07.932808Z	    9 Query	SELECT k, AVG(DISTINCT j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min,
MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max FROM t GROUP BY (k)
2024-05-01T14:11:07.933438Z	    9 Query	SELECT k, GROUP_CONCAT(j ORDER BY j), MIN(k+1) OVER (ROWS UNBOUNDED PRECEDING) min FROM t GROUP BY (k)
2024-05-01T14:11:07.934116Z	    9 Query	SELECT k, GROUP_CONCAT(j ORDER BY j), MAX(k+1) OVER (ROWS UNBOUNDED PRECEDING) max FROM t GROUP BY (k)
2024-05-01T14:11:07.934798Z	    9 Query	SELECT k, GROUP_CONCAT(j ORDER BY j), MIN(k+1) OVER (ORDER BY k DESC ROWS UNBOUNDED PRECEDING) min FROM t GROUP BY (k)
2024-05-01T14:11:07.935342Z	    9 Query	SELECT k, GROUP_CONCAT(j ORDER BY j), MAX(k+1) OVER (ORDER BY k DESC ROWS UNBOUNDED PRECEDING) max FROM t GROUP BY (k)
2024-05-01T14:11:07.940381Z	    9 Query	CREATE TABLE t1 (id INTEGER, sex CHAR(1))
2024-05-01T14:11:08.876193Z	    9 Query	INSERT INTO t1 VALUES (1, 'M')
2024-05-01T14:11:09.030966Z	    9 Query	INSERT INTO t1 VALUES (2, 'F')
2024-05-01T14:11:09.122019Z	    9 Query	INSERT INTO t1 VALUES (3, 'F')
2024-05-01T14:11:09.237343Z	    9 Query	INSERT INTO t1 VALUES (4, 'F')
2024-05-01T14:11:09.528737Z	    9 Query	INSERT INTO t1 VALUES (5, 'M')
2024-05-01T14:11:09.744751Z	    9 Query	INSERT INTO t1 VALUES (10, NULL)
2024-05-01T14:11:09.934405Z	    9 Query	INSERT INTO t1 VALUES (11, NULL)
2024-05-01T14:11:10.034602Z	    9 Query	CREATE TABLE ss(c CHAR(1))
2024-05-01T14:11:11.169414Z	    9 Query	INSERT INTO ss VALUES ('M')
2024-05-01T14:11:11.359551Z	    9 Query	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min, MAX(AVG(id)) OVER w max FROM t1
GROUP BY sex HAVING sex='M' OR sex='F' OR sex IS NULL
WINDOW w AS (ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:11:11.361513Z	    9 Query	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min, MAX(AVG(id)) OVER w max FROM t1
GROUP BY sex HAVING sex=(SELECT c FROM ss LIMIT 1) OR sex='F' OR sex IS NULL
WINDOW w AS (ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:11:11.363573Z	    9 Query	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min, MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1
GROUP BY sex
WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:11:11.365922Z	    9 Query	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min, MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1
GROUP BY sex HAVING sex=(SELECT c FROM ss LIMIT 1) OR sex='F' OR sex IS NULL
WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:11:11.368204Z	    9 Query	SELECT sex, NTILE(2) OVER w , MIN(ASCII(sex)) OVER w min,
MAX(ASCII(sex)) OVER w max FROM t1
HAVING sex=(SELECT c FROM ss LIMIT 1)
WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING)
2024-05-01T14:11:11.369826Z	    9 Query	PREPARE p FROM ...
2024-05-01T14:11:11.377101Z	    9 Prepare	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min,
        MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1
    GROUP BY sex HAVING sex=(SELECT c FROM ss LIMIT 1) OR sex='F' OR sex IS NULL
    WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:11:11.377650Z	    9 Query	EXECUTE p
2024-05-01T14:11:11.377751Z	    9 Execute	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min,
        MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1
    GROUP BY sex HAVING sex=(SELECT c FROM ss LIMIT 1) OR sex='F' OR sex IS NULL
    WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:11:11.379850Z	    9 Query	EXECUTE p
2024-05-01T14:11:11.379982Z	    9 Execute	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min,
        MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1
    GROUP BY sex HAVING sex=(SELECT c FROM ss LIMIT 1) OR sex='F' OR sex IS NULL
    WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:11:11.382190Z	    9 Query	DROP PREPARE p
2024-05-01T14:11:11.382719Z	    9 Query	DROP TABLE t1,ss
2024-05-01T14:11:12.519895Z	    9 Query	SELECT k, MIN(i), SUM(j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min_wf FROM t
GROUP BY (k) WITH ROLLUP
2024-05-01T14:11:12.522307Z	    9 Query	SELECT k, MIN(i), SUM(j), MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max_wf FROM t
GROUP BY (k) WITH ROLLUP
2024-05-01T14:11:12.525184Z	    9 Query	SELECT k, MIN(i), SUM(j), MIN(k) OVER (ORDER BY k DESC ROWS UNBOUNDED PRECEDING) min_wf FROM t
GROUP BY (k) WITH ROLLUP ORDER BY k DESC
2024-05-01T14:11:12.526813Z	    9 Query	SELECT k, MIN(i), SUM(j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min_wf FROM t
GROUP BY k,j WITH ROLLUP
2024-05-01T14:11:12.528421Z	    9 Query	DROP TABLE t
2024-05-01T14:11:12.978076Z	    9 Query	CREATE TABLE t3(t3_id INT, k INT)
2024-05-01T14:11:14.001597Z	    9 Query	INSERT INTO t3 VALUES (0, 0)
2024-05-01T14:11:14.145811Z	    9 Query	INSERT INTO t3 VALUES (0, 0)
2024-05-01T14:11:14.335424Z	    9 Query	INSERT INTO t3 VALUES (2, 0)
2024-05-01T14:11:14.618568Z	    9 Query	INSERT INTO t3 VALUES (2, 0)
2024-05-01T14:11:14.858447Z	    9 Query	INSERT INTO t3 VALUES (4, 0)
2024-05-01T14:11:15.058052Z	    9 Query	INSERT INTO t3 VALUES (4, 0)
2024-05-01T14:11:15.183161Z	    9 Query	INSERT INTO t3 VALUES (6, 0)
2024-05-01T14:11:15.405796Z	    9 Query	INSERT INTO t3 VALUES (6, 0)
2024-05-01T14:11:15.662132Z	    9 Query	INSERT INTO t3 VALUES (8, 0)
2024-05-01T14:11:15.807837Z	    9 Query	INSERT INTO t3 VALUES (8, 0)
2024-05-01T14:11:15.951537Z	    9 Query	INSERT INTO t3 VALUES (1, 1)
2024-05-01T14:11:16.052325Z	    9 Query	INSERT INTO t3 VALUES (1, 1)
2024-05-01T14:11:16.229659Z	    9 Query	INSERT INTO t3 VALUES (3, 1)
2024-05-01T14:11:16.508057Z	    9 Query	INSERT INTO t3 VALUES (3, 1)
2024-05-01T14:11:16.785909Z	    9 Query	INSERT INTO t3 VALUES (5, 1)
2024-05-01T14:11:16.908490Z	    9 Query	INSERT INTO t3 VALUES (5, 1)
2024-05-01T14:11:17.031109Z	    9 Query	INSERT INTO t3 VALUES (7, 1)
2024-05-01T14:11:17.142425Z	    9 Query	INSERT INTO t3 VALUES (7, 1)
2024-05-01T14:11:17.264517Z	    9 Query	INSERT INTO t3 VALUES (9, 1)
2024-05-01T14:11:17.537931Z	    9 Query	INSERT INTO t3 VALUES (9, 1)
2024-05-01T14:11:17.743163Z	    9 Query	SELECT t3_id, MIN(t3_id) OVER w min,
MAX(t3_id) OVER w max,
CUME_DIST() OVER w c_dist,
LEAD(t3_id, 2) OVER w lead2,
NTH_VALUE(t3_id, 3) OVER w nth,
k FROM t3
WINDOW w AS (PARTITION BY k ORDER BY t3_id)
2024-05-01T14:11:17.745684Z	    9 Query	SELECT t3_id, MIN(t3_id) OVER w min,
MAX(t3_id) OVER w max,
CUME_DIST() OVER w c_dist,
LEAD(t3_id, 2) OVER w lead2,
NTH_VALUE(t3_id, 3) OVER w nth,
k FROM t3
WINDOW w AS (PARTITION BY k ORDER BY t3_id RANGE UNBOUNDED PRECEDING)
2024-05-01T14:11:17.748000Z	    9 Query	DROP TABLE t3
2024-05-01T14:11:18.444838Z	    9 Query	CREATE TABLE t(i INT, j INT)
2024-05-01T14:11:19.815601Z	    9 Query	INSERT INTO t VALUES (1,NULL)
2024-05-01T14:11:19.948970Z	    9 Query	INSERT INTO t VALUES (1,NULL)
2024-05-01T14:11:20.115686Z	    9 Query	INSERT INTO t VALUES (1,1)
2024-05-01T14:11:20.238367Z	    9 Query	INSERT INTO t VALUES (1,NULL)
2024-05-01T14:11:20.472426Z	    9 Query	INSERT INTO t VALUES (1,2)
2024-05-01T14:11:20.727068Z	    9 Query	INSERT INTO t VALUES (2,1)
2024-05-01T14:11:20.906156Z	    9 Query	INSERT INTO t VALUES (2,2)
2024-05-01T14:11:21.084272Z	    9 Query	INSERT INTO t VALUES (2,NULL)
2024-05-01T14:11:21.206067Z	    9 Query	INSERT INTO t VALUES (2,NULL)
2024-05-01T14:11:21.426442Z	    9 Query	CREATE TABLE t1 (id INTEGER, sex CHAR(1))
2024-05-01T14:11:22.478140Z	    9 Query	INSERT INTO t1 VALUES (1, 'M')
2024-05-01T14:11:22.689680Z	    9 Query	INSERT INTO t1 VALUES (2, 'F')
2024-05-01T14:11:22.834561Z	    9 Query	INSERT INTO t1 VALUES (3, 'F')
2024-05-01T14:11:22.956821Z	    9 Query	INSERT INTO t1 VALUES (4, 'F')
2024-05-01T14:11:23.046332Z	    9 Query	INSERT INTO t1 VALUES (5, 'M')
2024-05-01T14:11:23.179540Z	    9 Query	CREATE TABLE t2 (user_id INTEGER NOT NULL, date DATE)
2024-05-01T14:11:25.219097Z	    9 Query	INSERT INTO t2 VALUES (1, '2002-06-09')
2024-05-01T14:11:25.507881Z	    9 Query	INSERT INTO t2 VALUES (2, '2002-06-09')
2024-05-01T14:11:25.797696Z	    9 Query	INSERT INTO t2 VALUES (1, '2002-06-09')
2024-05-01T14:11:26.075789Z	    9 Query	INSERT INTO t2 VALUES (3, '2002-06-09')
2024-05-01T14:11:26.153802Z	    9 Query	INSERT INTO t2 VALUES (4, '2002-06-09')
2024-05-01T14:11:26.292628Z	    9 Query	INSERT INTO t2 VALUES (4, '2002-06-09')
2024-05-01T14:11:26.615654Z	    9 Query	INSERT INTO t2 VALUES (5, '2002-06-09')
2024-05-01T14:11:26.989381Z	    9 Query	SELECT t.*, MIN(t.rank) OVER (ROWS UNBOUNDED PRECEDING) min,
MAX(t.rank) OVER (ROWS UNBOUNDED PRECEDING) max FROM
(SELECT sex, id, date, ROW_NUMBER() OVER w AS row_no, RANK() OVER w AS `rank` FROM t1,t2
WHERE t1.id=t2.user_id
WINDOW w AS (PARTITION BY date ORDER BY id)
) AS t
2024-05-01T14:11:26.992383Z	    9 Query	SELECT t1.*, RANK() OVER (ORDER BY sex) `rank`, MIN(id) OVER (ORDER BY sex,id ROWS UNBOUNDED PRECEDING) min FROM t1
2024-05-01T14:11:26.994138Z	    9 Query	SELECT t1.*, PERCENT_RANK() OVER (ORDER BY sex) p_rank, MAX(id) OVER (ORDER BY sex,id ROWS UNBOUNDED PRECEDING) max FROM t1
2024-05-01T14:11:26.995659Z	    9 Query	SELECT t1.*, CUME_DIST() OVER (ORDER BY sex) c_dist, MIN(id) OVER (ORDER BY sex,id ROWS UNBOUNDED PRECEDING) min FROM t1
2024-05-01T14:11:26.997276Z	    9 Query	SELECT * from (SELECT t1.*, MIN(id) OVER (ROWS UNBOUNDED PRECEDING) min, RANK() OVER (ORDER BY sex) `rank` FROM t1) alias ORDER BY id
2024-05-01T14:11:26.998952Z	    9 Query	SELECT * from (SELECT t1.*, MAX(id) OVER (ROWS UNBOUNDED PRECEDING) max, PERCENT_RANK() OVER (ORDER BY sex) p_rank FROM t1) alias ORDER BY id
2024-05-01T14:11:27.000854Z	    9 Query	SELECT * from (SELECT t1.*, MAX(id) OVER (ROWS UNBOUNDED PRECEDING) max, CUME_DIST() OVER (ORDER BY sex) c_dist FROM t1) alias ORDER BY id
2024-05-01T14:11:27.003197Z	    9 Query	SELECT t1.*, MIN(id) OVER (ORDER BY id ROWS UNBOUNDED PRECEDING) min,
MAX(id) OVER (ORDER BY id ROWS UNBOUNDED PRECEDING) max,
RANK() OVER (ORDER BY sex,id) `rank`,
ROW_NUMBER() OVER (ORDER BY sex,id) row_num
FROM t1
2024-05-01T14:11:27.005208Z	    9 Query	SELECT t.*, MIN(id + r00 + r01) OVER (ORDER BY id ROWS UNBOUNDED PRECEDING) AS min,
MAX(id + r00 + r01) OVER (ORDER BY id ROWS UNBOUNDED PRECEDING) AS max FROM (
SELECT t1.*,
RANK() OVER (ORDER BY sex, id) AS r00,
RANK() OVER (ORDER BY sex, id DESC) AS r01,
RANK() OVER (ORDER BY sex, id DESC) AS r02,
RANK() OVER (PARTITION BY id ORDER BY sex) AS r03,
RANK() OVER (ORDER BY sex,id) AS r04,
RANK() OVER (ORDER BY sex,id) AS r05,
RANK() OVER (ORDER BY sex, id) AS r06,
RANK() OVER (ORDER BY sex, id) AS r07,
RANK() OVER (ORDER BY sex, id) AS r08,
RANK() OVER (ORDER BY sex, id) AS r09,
RANK() OVER (ORDER BY sex, id) AS r10,
RANK() OVER (ORDER BY sex, id) AS r11,
RANK() OVER (ORDER BY sex, id) AS r12,
RANK() OVER (ORDER BY sex, id) AS r13,
RANK() OVER (ORDER BY sex, id) AS r14
FROM t1) t
2024-05-01T14:11:27.009455Z	    9 Query	DROP TABLE t
2024-05-01T14:11:27.690022Z	    9 Query	SELECT AVG(id) OVER w, MIN(id) OVER w min, MAX(id) OVER w max FROM t1
WINDOW w AS (PARTITION BY sex)
2024-05-01T14:11:27.691204Z	    9 Query	SELECT * FROM (
SELECT id, SUM(id) OVER w, MIN(id) OVER w min, MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex)
) alias ORDER BY id
2024-05-01T14:11:27.692450Z	    9 Query	SELECT MIN(id) OVER w min FROM t1 WINDOW w AS (PARTITION BY sex)
2024-05-01T14:11:27.693279Z	    9 Query	SELECT MAX(id) OVER w max FROM t1 WINDOW w AS (PARTITION BY sex)
2024-05-01T14:11:27.694217Z	    9 Query	SELECT id, MIN(id) OVER w min, MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING)
2024-05-01T14:11:27.695587Z	    9 Query	CREATE VIEW v AS
SELECT id, SUM(id) OVER w, MIN(id) OVER w min, MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING)
2024-05-01T14:11:27.991122Z	    9 Query	SHOW CREATE VIEW v
2024-05-01T14:11:27.994095Z	    9 Query	SELECT * FROM v
2024-05-01T14:11:27.996108Z	    9 Query	DROP VIEW v
2024-05-01T14:11:28.191548Z	    9 Query	SELECT SUM(id) OVER w, MIN(id) OVER w min,
MAX(id) OVER w max FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING)
2024-05-01T14:11:28.193634Z	    9 Query	SELECT id, SUM(id) OVER w, MIN(id) OVER w min,
MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 1 FOLLOWING AND 2 FOLLOWING)
2024-05-01T14:11:28.195485Z	    9 Query	SELECT SUM(id) OVER w, COUNT(*) OVER w, MIN(id) OVER w min,
MAX(id) OVER w max FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 1 FOLLOWING AND 2 FOLLOWING)
2024-05-01T14:11:28.196947Z	    9 Query	SELECT id, AVG(id) OVER (ROWS UNBOUNDED PRECEDING) avg,
MIN(id) OVER (ROWS UNBOUNDED PRECEDING) min FROM t1
2024-05-01T14:11:28.198194Z	    9 Query	SELECT id, AVG(id) OVER (ROWS UNBOUNDED PRECEDING),
MAX(id) OVER (ROWS UNBOUNDED PRECEDING) max FROM t1
2024-05-01T14:11:28.199519Z	    9 Query	SELECT id, AVG(id) OVER w avg, COUNT(id) OVER w count, MIN(id) OVER w min,
MAX(id) OVER w max FROM t1
WINDOW w AS (ORDER BY id ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)
2024-05-01T14:11:28.201181Z	    9 Query	CREATE TABLE td(d DOUBLE)
2024-05-01T14:11:29.374527Z	    9 Query	INSERT INTO td VALUES (2)
2024-05-01T14:11:29.577627Z	    9 Query	INSERT INTO td VALUES (2)
2024-05-01T14:11:29.773886Z	    9 Query	INSERT INTO td VALUES (3)
2024-05-01T14:11:30.053623Z	    9 Query	INSERT INTO td VALUES (1)
2024-05-01T14:11:30.175154Z	    9 Query	INSERT INTO td VALUES (1.2)
2024-05-01T14:11:30.320064Z	    9 Query	INSERT INTO td VALUES (NULL)
2024-05-01T14:11:30.585618Z	    9 Query	SELECT d, MIN(d) OVER (ORDER BY d) min, MAX(d) OVER (ORDER BY d) max FROM td
2024-05-01T14:11:30.587309Z	    9 Query	SELECT d, MIN(d) OVER () min, MAX(d) OVER () max FROM td
2024-05-01T14:11:30.588731Z	    9 Query	SELECT d, MIN(d) OVER (ORDER BY d ROWS BETWEEN 2 PRECEDING AND 1 FOLLOWING) min FROM td
2024-05-01T14:11:30.590056Z	    9 Query	SELECT d, MAX(d) OVER (ORDER BY d ROWS BETWEEN 2 PRECEDING AND 1 FOLLOWING) max FROM td
2024-05-01T14:11:30.591347Z	    9 Query	TRUNCATE td
2024-05-01T14:11:32.637561Z	    9 Query	INSERT INTO td VALUES (10)
2024-05-01T14:11:32.780659Z	    9 Query	INSERT INTO td VALUES (1)
2024-05-01T14:11:32.916858Z	    9 Query	INSERT INTO td VALUES (2)
2024-05-01T14:11:33.070887Z	    9 Query	INSERT INTO td VALUES (3)
2024-05-01T14:11:33.192679Z	    9 Query	INSERT INTO td VALUES (4)
2024-05-01T14:11:33.515147Z	    9 Query	INSERT INTO td VALUES (5)
2024-05-01T14:11:34.004291Z	    9 Query	INSERT INTO td VALUES (6)
2024-05-01T14:11:34.254693Z	    9 Query	INSERT INTO td VALUES (7)
2024-05-01T14:11:34.488106Z	    9 Query	INSERT INTO td VALUES (8)
2024-05-01T14:11:34.738221Z	    9 Query	INSERT INTO td VALUES (9)
2024-05-01T14:11:34.883845Z	    9 Query	SELECT d, MIN(d) OVER w min, MAX(d) OVER w max FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN 2 PRECEDING AND CURRENT ROW)
2024-05-01T14:11:34.886200Z	    9 Query	SELECT d, SUM(d) OVER w sum, MIN(d) OVER w min, MAX(d) OVER w max FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN 2 PRECEDING AND 2 FOLLOWING)
2024-05-01T14:11:34.888185Z	    9 Query	SELECT d, SUM(d) OVER w sum, MIN(d) OVER w min, MAX(d) OVER w max FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN CURRENT ROW AND 2 FOLLOWING)
2024-05-01T14:11:34.889702Z	    9 Query	INSERT INTO td SELECT * FROM td
2024-05-01T14:11:35.051773Z	    9 Query	SELECT d, SUM(d) OVER w sum, MAX(d) OVER w max, MIN(d) OVER w min FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN 2 PRECEDING AND CURRENT ROW)
2024-05-01T14:11:35.054290Z	    9 Query	SELECT d, SUM(d) OVER w sum, MAX(d) OVER w max, MIN(d) OVER w min FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN 2 PRECEDING AND 2 FOLLOWING)
2024-05-01T14:11:35.056620Z	    9 Query	SELECT d, SUM(d) OVER w sum, MAX(d) OVER w max, MIN(d) OVER w min FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN CURRENT ROW AND 2 FOLLOWING)
2024-05-01T14:11:35.058481Z	    9 Query	DROP TABLE td
2024-05-01T14:11:35.721155Z	    9 Query	SELECT ROW_NUMBER() OVER w `row_number`, id, MIN(id) OVER w min, MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)
2024-05-01T14:11:35.721825Z	    9 Query	SELECT ROW_NUMBER() OVER w `row_number`, MIN(id) OVER w min,
MAX(id) OVER w max FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 1 FOLLOWING AND 2 FOLLOWING)
2024-05-01T14:11:35.722302Z	    9 Query	INSERT INTO t1 VALUES (10, NULL)
2024-05-01T14:11:35.899967Z	    9 Query	SELECT RANK() OVER w `rank`, id, MIN(id) OVER w min, MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id)
2024-05-01T14:11:35.903413Z	    9 Query	SELECT RANK() OVER w `rank`, MIN(id) OVER w min,
MAX(id) OVER w max FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 1 FOLLOWING AND 2 FOLLOWING)
2024-05-01T14:11:35.907438Z	    9 Query	SELECT id, sex, MIN(id) OVER w min,
MAX(id) OVER w max,
ROW_NUMBER() OVER w `row_number`,
RANK() OVER w  `rank` FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING)
2024-05-01T14:11:35.909705Z	    9 Query	SELECT id, sex, MIN(id) OVER w min,
MAX(id) OVER w max,
ROW_NUMBER() OVER w `row_number`,
CUME_DIST() OVER w  `cume_dist` FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING)
2024-05-01T14:11:35.912867Z	    9 Query	CREATE TABLE t11 (id INTEGER, sex CHAR(1), p INTEGER DEFAULT 1)
2024-05-01T14:11:36.968719Z	    9 Query	INSERT INTO t11(id, sex) SELECT * FROM t1
2024-05-01T14:11:37.122212Z	    9 Query	UPDATE t11 SET p=p+1
2024-05-01T14:11:37.291327Z	    9 Query	INSERT INTO t11(id, sex) SELECT * FROM t1
2024-05-01T14:11:37.402931Z	    9 Query	CREATE TABLE t22 (user_id INTEGER NOT NULL, date DATE, p INTEGER DEFAULT 1)
2024-05-01T14:11:38.548938Z	    9 Query	INSERT INTO t22(user_id, date) SELECT * FROM t2
2024-05-01T14:11:39.162942Z	    9 Query	UPDATE t22 SET p=p+1
2024-05-01T14:11:39.428650Z	    9 Query	INSERT INTO t22(user_id, date) SELECT * FROM t2
2024-05-01T14:11:39.653386Z	    9 Query	SELECT id, MIN(id) OVER (ORDER BY id RANGE 2 PRECEDING) min FROM t1 ORDER BY id
2024-05-01T14:11:39.654226Z	    9 Query	SELECT id, MIN(id) OVER (ORDER BY id RANGE 2 PRECEDING) max FROM t1 ORDER BY id
2024-05-01T14:11:39.655223Z	    9 Query	SELECT id, MIN(id) OVER (ORDER BY id RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) min FROM t1 ORDER BY id
2024-05-01T14:11:39.655876Z	    9 Query	SELECT id, MAX(id) OVER (ORDER BY id RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) max FROM t1 ORDER BY id
2024-05-01T14:11:39.656991Z	    9 Query	SELECT id, MIN(id) OVER (ORDER BY id RANGE UNBOUNDED PRECEDING) min FROM t1 ORDER BY id
2024-05-01T14:11:39.657888Z	    9 Query	SELECT id, MAX(id) OVER (ORDER BY id RANGE UNBOUNDED PRECEDING) max FROM t1 ORDER BY id
2024-05-01T14:11:39.658631Z	    9 Query	SELECT p, id, MIN(id) OVER (PARTITION BY p ORDER BY id RANGE 2 PRECEDING) min FROM t11 ORDER BY p,id
2024-05-01T14:11:39.659407Z	    9 Query	SELECT p, id, MAX(id) OVER (PARTITION BY p ORDER BY id RANGE 2 PRECEDING) max FROM t11 ORDER BY p,id
2024-05-01T14:11:39.660094Z	    9 Query	SELECT p, id, MIN(id) OVER (PARTITION BY p ORDER BY id RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) min FROM t11 ORDER BY p,id
2024-05-01T14:11:39.661631Z	    9 Query	SELECT p, id, MAX(id) OVER (PARTITION BY p ORDER BY id RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) max FROM t11 ORDER BY p,id
2024-05-01T14:11:39.662641Z	    9 Query	SELECT p, id, MIN(id) OVER (PARTITION BY p ORDER BY id RANGE UNBOUNDED PRECEDING) min FROM t11 ORDER BY p,id
2024-05-01T14:11:39.663588Z	    9 Query	SELECT p, id, MAX(id) OVER (PARTITION BY p ORDER BY id RANGE UNBOUNDED PRECEDING) max FROM t11 ORDER BY p,id
2024-05-01T14:11:39.664257Z	    9 Query	SELECT user_id, MIN(user_id) OVER w, MAX(user_id) OVER w FROM t2 WINDOW w AS (ORDER BY user_id)
2024-05-01T14:11:39.664801Z	    9 Query	SELECT p, user_id, MIN(user_id) OVER w, MAX(user_id) OVER w FROM t22 WINDOW w AS (PARTITION BY p ORDER BY user_id) ORDER BY p
2024-05-01T14:11:39.665482Z	    9 Query	SELECT user_id, MIN(user_id) OVER w, MAX(user_id) OVER w1 FROM t2
WINDOW w AS (ORDER BY user_id), w1 AS (ORDER BY user_id)
2024-05-01T14:11:39.666155Z	    9 Query	SELECT NTILE(5) OVER w, ROW_NUMBER() OVER w, id, MIN(id) OVER w FROM t1
WINDOW w AS (ORDER BY id DESC RANGE 2 PRECEDING)
2024-05-01T14:11:39.666775Z	    9 Query	SELECT p, NTILE(5) OVER w, ROW_NUMBER() OVER w, id, MAX(id) OVER w FROM t11
WINDOW w AS (PARTITION BY p ORDER BY id DESC RANGE 2 PRECEDING)
2024-05-01T14:11:39.667555Z	    9 Query	SELECT NTILE(5) OVER w, ROW_NUMBER() OVER w, id, MIN(id) OVER w FROM t1
WINDOW w AS (ORDER BY id DESC RANGE INTERVAL 2 MONTH PRECEDING)
2024-05-01T14:11:39.667802Z	    9 Query	DROP TABLE t11,t22,t1,t2
2024-05-01T14:11:42.129757Z	    9 Query	CREATE TABLE t3(d DOUBLE)
2024-05-01T14:11:43.209092Z	    9 Query	INSERT INTO t3 VALUES (1.1)
2024-05-01T14:11:43.320324Z	    9 Query	INSERT INTO t3 VALUES (1.9)
2024-05-01T14:11:43.490843Z	    9 Query	INSERT INTO t3 VALUES (4.0)
2024-05-01T14:11:43.676333Z	    9 Query	INSERT INTO t3 VALUES (8.3)
2024-05-01T14:11:43.910003Z	    9 Query	INSERT INTO t3 VALUES (16.0)
2024-05-01T14:11:44.157217Z	    9 Query	INSERT INTO t3 VALUES (24.0)
2024-05-01T14:11:44.335208Z	    9 Query	INSERT INTO t3 VALUES (20.1)
2024-05-01T14:11:44.435158Z	    9 Query	INSERT INTO t3 VALUES (22.0)
2024-05-01T14:11:44.595946Z	    9 Query	INSERT INTO t3 VALUES (23.0)
2024-05-01T14:11:44.836477Z	    9 Query	SELECT d, MIN(d) OVER w min, MAX(d) OVER w max, COUNT(*) OVER w
FROM t3 WINDOW w AS (ORDER BY d RANGE BETWEEN 2.1 PRECEDING AND 1.1 FOLLOWING)
2024-05-01T14:11:44.838261Z	    9 Query	DROP TABLE t3
2024-05-01T14:11:45.704169Z	    9 Query	CREATE TABLE tj(j JSON, i INT DEFAULT 7)
2024-05-01T14:11:46.851212Z	    9 Query	INSERT INTO tj(j) VALUES ('1')
2024-05-01T14:11:47.126583Z	    9 Query	INSERT INTO tj(j) VALUES ('2')
2024-05-01T14:11:47.296763Z	    9 Query	INSERT INTO tj(j) VALUES ('3')
2024-05-01T14:11:47.465035Z	    9 Query	INSERT INTO tj(j) VALUES ('4')
2024-05-01T14:11:47.620961Z	    9 Query	INSERT INTO tj(j) VALUES ('5')
2024-05-01T14:11:47.944486Z	    9 Query	INSERT INTO tj(j) VALUES (NULL)
2024-05-01T14:11:48.065523Z	    9 Query	INSERT INTO tj(j) VALUES ('3.14')
2024-05-01T14:11:48.143234Z	    9 Query	INSERT INTO tj(j) VALUES ('[1,2,3]')
2024-05-01T14:11:48.288138Z	    9 Query	INSERT INTO tj(j) VALUES (NULL)
2024-05-01T14:11:48.395330Z	    9 Query	SELECT MIN(j) OVER () AS JSON FROM tj
2024-05-01T14:11:48.397977Z	    9 Query	SELECT j, JSON_TYPE(j), MIN(j) OVER (ORDER BY j ROWS 3 PRECEDING) FROM tj
2024-05-01T14:11:48.399492Z	    9 Query	SHOW WARNINGS
2024-05-01T14:11:48.400144Z	    9 Query	SELECT j, JSON_TYPE(j), MAX(j) OVER (ORDER BY j ROWS 3 PRECEDING) FROM tj
2024-05-01T14:11:48.401262Z	    9 Query	SHOW WARNINGS
2024-05-01T14:11:48.402042Z	    9 Query	SELECT j, JSON_TYPE(j), JSON_TYPE(MIN(j) OVER (ORDER BY j RANGE 3 PRECEDING)) FROM tj
2024-05-01T14:11:48.402700Z	    9 Query	INSERT INTO tj(j) VALUES ('3.14')
2024-05-01T14:11:48.533578Z	    9 Query	SELECT j, JSON_TYPE(j), JSON_TYPE(MAX(j) OVER (ORDER BY j ROWS 3 PRECEDING)) FROM tj
2024-05-01T14:11:48.536118Z	    9 Query	SHOW WARNINGS
2024-05-01T14:11:48.538307Z	    9 Query	INSERT INTO tj(j) VALUES ('[1,2,3]')
2024-05-01T14:11:48.812029Z	    9 Query	SELECT j,
JSON_TYPE(j),
MIN(CASE WHEN JSON_TYPE(j) = 'ARRAY' THEN j->"$[0]" ELSE j END)
OVER (ORDER BY j ROWS 3 PRECEDING)
FROM tj
2024-05-01T14:11:48.813900Z	    9 Query	SHOW WARNINGS
2024-05-01T14:11:48.814722Z	    9 Query	SELECT DISTINCT i,NTILE(3) OVER (ORDER BY i), MAX(i) OVER (), COUNT(*) OVER () FROM tj ORDER BY NTILE(3) OVER (ORDER BY i)
2024-05-01T14:11:48.817317Z	    9 Query	UPDATE tj SET i=i+CASE WHEN JSON_TYPE(j) = 'ARRAY' THEN 1 ELSE j END
2024-05-01T14:11:48.967144Z	    9 Query	UPDATE tj SET i=7 where i=8 AND JSON_TYPE(j) != 'ARRAY'
2024-05-01T14:11:49.045930Z	    9 Query	CREATE TABLE tj2 AS SELECT * FROM tj
2024-05-01T14:11:50.166205Z	    9 Query	UPDATE tj2 SET i=MOD(i,3)
2024-05-01T14:11:50.382978Z	    9 Query	SELECT * FROM tj2
2024-05-01T14:11:50.384108Z	    9 Query	SELECT          COUNT(*) OVER (), MOD(MIN(i),2) FROM tj2 GROUP BY i
2024-05-01T14:11:50.385451Z	    9 Query	SELECT DISTINCT COUNT(*) OVER (), MOD(MAX(i),2) FROM tj2 GROUP BY i
2024-05-01T14:11:50.388238Z	    9 Query	SELECT i, MIN(i) OVER (), MOD(MIN(i),2) FROM tj2 GROUP BY i
2024-05-01T14:11:50.390897Z	    9 Query	SELECT i, MAX(MAX(i)) OVER (), MAX(i) OVER (ORDER BY i), MOD(MAX(i),2), MAX(i) FROM tj2 GROUP BY i
2024-05-01T14:11:50.393109Z	    9 Query	SELECT i, MIN(i) OVER (ORDER BY i) FROM tj UNION ALL SELECT i, MIN(i) OVER (ORDER BY i) FROM tj
2024-05-01T14:11:50.397702Z	    9 Query	SELECT j,CAST(MIN(j) OVER (PARTITION BY i) AS JSON), CAST(MAX(j) OVER () AS JSON) FROM tj
2024-05-01T14:11:50.400895Z	    9 Query	SELECT j,CAST(MIN(j) OVER (PARTITION BY i ROWS UNBOUNDED PRECEDING) AS JSON), CAST(MAX(j) OVER (PARTITION BY i ROWS UNBOUNDED PRECEDING) AS JSON) FROM tj
2024-05-01T14:11:50.403174Z	    9 Query	DROP TABLE tj,tj2
2024-05-01T14:11:51.720720Z	    9 Query	CREATE TABLE t1 (i INTEGER, j INTEGER)
2024-05-01T14:11:53.382431Z	    9 Query	INSERT INTO t1 VALUES (NULL,3),(NULL,3),(NULL,30),(NULL,30),(4,3),
(2,5),(3,7),(1,10),(5,20),(3,30)
2024-05-01T14:11:53.638182Z	    9 Query	SELECT i, j, MIN(i) OVER (PARTITION BY j ORDER BY i) FROM t1
2024-05-01T14:11:53.638530Z	    9 Query	DROP TABLE t1
2024-05-01T14:11:54.518795Z	    9 Query	CREATE TABLE t1(a INT)
2024-05-01T14:11:56.327031Z	    9 Query	INSERT INTO t1 VALUES(1),(1),(1),(1),(NULL),(NULL),(NULL),(NULL)
2024-05-01T14:11:56.536162Z	    9 Query	SELECT a, MAX(a) OVER (ORDER BY a DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) FROM t1
2024-05-01T14:11:56.536901Z	    9 Query	SELECT a, MAX(a) OVER (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM t1
2024-05-01T14:11:56.537521Z	    9 Query	SELECT a, MIN(a) OVER (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM t1
2024-05-01T14:11:56.538148Z	    9 Query	TRUNCATE t1
2024-05-01T14:11:58.284076Z	    9 Query	INSERT INTO t1 VALUES (2), (1), (4), (3), (NULL), (NULL), (NULL), (NULL)
2024-05-01T14:11:58.462419Z	    9 Query	SELECT a, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:11:58.462920Z	    9 Query	SELECT a, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:11:58.463351Z	    9 Query	SELECT a, COUNT(a) OVER w, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:11:58.463701Z	    9 Query	SELECT a, COUNT(a) OVER w, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:11:58.463977Z	    9 Query	SELECT a, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:11:58.464240Z	    9 Query	SELECT a, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:11:58.464715Z	    9 Query	SELECT a, COUNT(a) OVER w, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:11:58.465036Z	    9 Query	SELECT a, COUNT(a) OVER w, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:11:58.465322Z	    9 Query	SELECT a, MIN(a) OVER w min, MAX(a) OVER w max FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)
2024-05-01T14:11:58.465596Z	    9 Query	SELECT a, MIN(a) OVER w min, MAX(a) OVER w max FROM t1 WINDOW w AS (ORDER BY a RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:11:58.465994Z	    9 Query	TRUNCATE t1
2024-05-01T14:12:00.348164Z	    9 Query	INSERT INTO t1 VALUES (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL)
2024-05-01T14:12:00.470450Z	    9 Query	SELECT a, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:12:00.470946Z	    9 Query	SELECT a, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:12:00.471311Z	    9 Query	SELECT a, COUNT(a) OVER w, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:12:00.471648Z	    9 Query	SELECT a, COUNT(a) OVER w, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:12:00.471946Z	    9 Query	SELECT a, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:12:00.472232Z	    9 Query	SELECT a, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:12:00.472550Z	    9 Query	SELECT a, COUNT(a) OVER w, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:12:00.472868Z	    9 Query	SELECT a, COUNT(a) OVER w, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:12:00.473140Z	    9 Query	DROP TABLE t1
2024-05-01T14:12:01.439669Z	    9 Query	SELECT MIN(DATE'2000-01-01') OVER () AS c1,
MIN(TIME'12:00:00') OVER () AS c2,
MIN(TIMESTAMP'2000-01-01 12:00:00') OVER () AS c3,
JSON_ARRAY(MIN(CAST('123' AS JSON)) OVER ()) AS c4,
MIN(DATE'2000-01-01') OVER () = DATE'2000-01-01' AS c5,
MIN(TIME'12:00:00') OVER () = TIME '12:00:00' AS c6,
MIN(TIMESTAMP'2000-01-01 12:00:00') OVER () =
TIMESTAMP'2000-01-01 12:00:00' AS c7
2024-05-01T14:12:01.455225Z	    9 Query	SHOW WARNINGS
2024-05-01T14:12:01.457297Z	    9 Quit	
/home/stephanie/mysql-server/build/runtime_output_directory/mysqld, Version: 8.0.36 (Source distribution). started with:
Tcp port: 13000  Unix socket: /home/stephanie/mysql-server/build/mysql-test/var/tmp/mysqld.1.sock
Time                 Id Command    Argument
2024-05-01T14:50:55.252458Z	    9 Query	SET GLOBAL general_log = 'ON'
2024-05-01T14:50:55.252807Z	    9 Query	SET NAMES utf8
2024-05-01T14:50:55.253058Z	    9 Query	SHOW WARNINGS
2024-05-01T14:50:55.253533Z	    9 Query	CREATE TABLE t(i INT, j INT)
2024-05-01T14:50:56.266074Z	    9 Query	INSERT INTO t VALUES (1,1)
2024-05-01T14:50:56.404580Z	    9 Query	INSERT INTO t VALUES (1,4)
2024-05-01T14:50:56.595714Z	    9 Query	INSERT INTO t VALUES (1,2)
2024-05-01T14:50:56.700412Z	    9 Query	INSERT INTO t VALUES (1,4)
2024-05-01T14:50:56.845547Z	    9 Query	ANALYZE TABLE t
2024-05-01T14:50:57.057681Z	    9 Query	SELECT i, j, MIN(i) OVER (ROWS UNBOUNDED PRECEDING) min,
MAX(j) OVER (ROWS UNBOUNDED PRECEDING) max FROM t
2024-05-01T14:50:57.060340Z	    9 Query	SELECT i, j, MIN(i) OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) min,
MAX(j) OVER (ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) max FROM t
2024-05-01T14:50:57.061919Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY j
2024-05-01T14:50:57.063167Z	    9 Query	SELECT i, j, MAX(i+j) OVER (ROWS UNBOUNDED PRECEDING) max FROM t ORDER BY j
2024-05-01T14:50:57.064839Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY j DESC
2024-05-01T14:50:57.066893Z	    9 Query	SELECT i, j, MAX(i+j) OVER (ROWS UNBOUNDED PRECEDING) max FROM t ORDER BY j DESC
2024-05-01T14:50:57.068028Z	    9 Query	SELECT i, j, MIN(i) OVER (ORDER BY j ROWS UNBOUNDED PRECEDING) min,
MAX(j) OVER (ORDER BY j ROWS UNBOUNDED PRECEDING) max FROM t
2024-05-01T14:50:57.069328Z	    9 Query	SELECT i, j, MIN(j) OVER (ORDER BY j ROWS UNBOUNDED PRECEDING) min,
MAX(i) OVER (ORDER BY i ROWS UNBOUNDED PRECEDING) max FROM t ORDER BY j
2024-05-01T14:50:57.070591Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ORDER BY j ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY j DESC
2024-05-01T14:50:57.072126Z	    9 Query	SELECT i, j, MAX(i+j) OVER (ORDER BY j ROWS UNBOUNDED PRECEDING) max FROM t ORDER BY j DESC
2024-05-01T14:50:57.074102Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ORDER BY j DESC ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY j DESC
2024-05-01T14:50:57.075308Z	    9 Query	SELECT i, j, MAX(i+j) OVER (ORDER BY j DESC ROWS UNBOUNDED PRECEDING) max FROM t ORDER BY j DESC
2024-05-01T14:50:57.076357Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY NULL DESC
2024-05-01T14:50:57.077283Z	    9 Query	EXPLAIN FORMAT=JSON SELECT i, j, MIN(i+j) OVER (ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY NULL DESC
2024-05-01T14:50:57.078175Z	    9 Query	SHOW WARNINGS
2024-05-01T14:50:57.078746Z	    9 Query	SELECT i, j, MIN(i+j) OVER (ROWS UNBOUNDED PRECEDING) min FROM t ORDER BY j DESC LIMIT 3
2024-05-01T14:50:57.080972Z	    9 Query	CREATE VIEW v AS
SELECT i, j, MIN(i+j) OVER (ORDER BY j DESC ROWS UNBOUNDED PRECEDING) min,
MAX(i+j) OVER (ORDER BY j DESC ROWS UNBOUNDED PRECEDING) max FROM t
2024-05-01T14:50:57.290794Z	    9 Query	SHOW CREATE VIEW v
2024-05-01T14:50:57.293553Z	    9 Query	SELECT * FROM v
2024-05-01T14:50:57.295138Z	    9 Query	DROP VIEW v
2024-05-01T14:50:57.506101Z	    9 Query	TRUNCATE TABLE t
2024-05-01T14:50:58.775161Z	    9 Query	INSERT INTO t VALUES (999961560, DEFAULT)
2024-05-01T14:50:58.946406Z	    9 Query	INSERT INTO t VALUES (44721, DEFAULT)
2024-05-01T14:50:59.174614Z	    9 Query	SELECT MIN(i) OVER () FROM t
2024-05-01T14:50:59.175818Z	    9 Query	SELECT MAX(i) OVER () FROM t
2024-05-01T14:50:59.176707Z	    9 Query	DROP TABLE t
2024-05-01T14:50:59.876834Z	    9 Query	CREATE TABLE t(i INT, j INT, k INT)
2024-05-01T14:51:00.980500Z	    9 Query	INSERT INTO t VALUES (1,1,1)
2024-05-01T14:51:01.168390Z	    9 Query	INSERT INTO t VALUES (1,4,1)
2024-05-01T14:51:01.302550Z	    9 Query	INSERT INTO t VALUES (1,2,1)
2024-05-01T14:51:01.436441Z	    9 Query	INSERT INTO t VALUES (1,4,1)
2024-05-01T14:51:01.683002Z	    9 Query	INSERT INTO t VALUES (1,4,1)
2024-05-01T14:51:01.858812Z	    9 Query	INSERT INTO t VALUES (1,1,2)
2024-05-01T14:51:02.159332Z	    9 Query	INSERT INTO t VALUES (1,4,2)
2024-05-01T14:51:02.489987Z	    9 Query	INSERT INTO t VALUES (1,2,2)
2024-05-01T14:51:02.729184Z	    9 Query	INSERT INTO t VALUES (1,4,2)
2024-05-01T14:51:02.871032Z	    9 Query	INSERT INTO t VALUES (1,1,3)
2024-05-01T14:51:03.003764Z	    9 Query	INSERT INTO t VALUES (1,4,3)
2024-05-01T14:51:03.093893Z	    9 Query	INSERT INTO t VALUES (1,2,3)
2024-05-01T14:51:03.182999Z	    9 Query	INSERT INTO t VALUES (1,4,3)
2024-05-01T14:51:03.294278Z	    9 Query	INSERT INTO t VALUES (1,1,4)
2024-05-01T14:51:03.383053Z	    9 Query	INSERT INTO t VALUES (1,4,4)
2024-05-01T14:51:03.638971Z	    9 Query	INSERT INTO t VALUES (1,2,4)
2024-05-01T14:51:03.771221Z	    9 Query	INSERT INTO t VALUES (1,4,4)
2024-05-01T14:51:03.884188Z	    9 Query	SELECT k, MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min,
MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max FROM t
2024-05-01T14:51:03.885911Z	    9 Query	SELECT k, MIN(i), SUM(j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min_wf FROM t GROUP BY (k)
2024-05-01T14:51:03.887719Z	    9 Query	SELECT k, MIN(i), SUM(j), MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max_wf FROM t GROUP BY (k)
2024-05-01T14:51:03.889415Z	    9 Query	SELECT k, MIN(i), SUM(j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min_wf FROM t GROUP BY (k) ORDER BY min_wf DESC
2024-05-01T14:51:03.891491Z	    9 Query	SELECT k, MIN(i), SUM(j), MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max_wf FROM t GROUP BY (k) ORDER BY max_wf DESC
2024-05-01T14:51:03.893481Z	    9 Query	SELECT k, GROUP_CONCAT(j ORDER BY j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min,
MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max FROM t GROUP BY (k)
2024-05-01T14:51:03.895750Z	    9 Query	SELECT k, AVG(DISTINCT j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min,
MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max FROM t GROUP BY (k)
2024-05-01T14:51:03.897647Z	    9 Query	SELECT k, GROUP_CONCAT(j ORDER BY j), MIN(k+1) OVER (ROWS UNBOUNDED PRECEDING) min FROM t GROUP BY (k)
2024-05-01T14:51:03.900329Z	    9 Query	SELECT k, GROUP_CONCAT(j ORDER BY j), MAX(k+1) OVER (ROWS UNBOUNDED PRECEDING) max FROM t GROUP BY (k)
2024-05-01T14:51:03.901991Z	    9 Query	SELECT k, GROUP_CONCAT(j ORDER BY j), MIN(k+1) OVER (ORDER BY k DESC ROWS UNBOUNDED PRECEDING) min FROM t GROUP BY (k)
2024-05-01T14:51:03.903572Z	    9 Query	SELECT k, GROUP_CONCAT(j ORDER BY j), MAX(k+1) OVER (ORDER BY k DESC ROWS UNBOUNDED PRECEDING) max FROM t GROUP BY (k)
2024-05-01T14:51:03.904793Z	    9 Query	CREATE TABLE t1 (id INTEGER, sex CHAR(1))
2024-05-01T14:51:05.243535Z	    9 Query	INSERT INTO t1 VALUES (1, 'M')
2024-05-01T14:51:05.343354Z	    9 Query	INSERT INTO t1 VALUES (2, 'F')
2024-05-01T14:51:05.487874Z	    9 Query	INSERT INTO t1 VALUES (3, 'F')
2024-05-01T14:51:05.676800Z	    9 Query	INSERT INTO t1 VALUES (4, 'F')
2024-05-01T14:51:05.844219Z	    9 Query	INSERT INTO t1 VALUES (5, 'M')
2024-05-01T14:51:05.978202Z	    9 Query	INSERT INTO t1 VALUES (10, NULL)
2024-05-01T14:51:06.078580Z	    9 Query	INSERT INTO t1 VALUES (11, NULL)
2024-05-01T14:51:06.200945Z	    9 Query	CREATE TABLE ss(c CHAR(1))
2024-05-01T14:51:07.035915Z	    9 Query	INSERT INTO ss VALUES ('M')
2024-05-01T14:51:07.213936Z	    9 Query	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min, MAX(AVG(id)) OVER w max FROM t1
GROUP BY sex HAVING sex='M' OR sex='F' OR sex IS NULL
WINDOW w AS (ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:51:07.216299Z	    9 Query	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min, MAX(AVG(id)) OVER w max FROM t1
GROUP BY sex HAVING sex=(SELECT c FROM ss LIMIT 1) OR sex='F' OR sex IS NULL
WINDOW w AS (ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:51:07.219273Z	    9 Query	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min, MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1
GROUP BY sex
WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:51:07.221766Z	    9 Query	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min, MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1
GROUP BY sex HAVING sex=(SELECT c FROM ss LIMIT 1) OR sex='F' OR sex IS NULL
WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:51:07.225641Z	    9 Query	SELECT sex, NTILE(2) OVER w , MIN(ASCII(sex)) OVER w min,
MAX(ASCII(sex)) OVER w max FROM t1
HAVING sex=(SELECT c FROM ss LIMIT 1)
WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING)
2024-05-01T14:51:07.227744Z	    9 Query	PREPARE p FROM ...
2024-05-01T14:51:07.237000Z	    9 Prepare	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min,
        MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1
    GROUP BY sex HAVING sex=(SELECT c FROM ss LIMIT 1) OR sex='F' OR sex IS NULL
    WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:51:07.238567Z	    9 Query	EXECUTE p
2024-05-01T14:51:07.239061Z	    9 Execute	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min,
        MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1
    GROUP BY sex HAVING sex=(SELECT c FROM ss LIMIT 1) OR sex='F' OR sex IS NULL
    WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:51:07.241886Z	    9 Query	EXECUTE p
2024-05-01T14:51:07.241996Z	    9 Execute	SELECT sex, AVG(id), MIN(AVG(id)) OVER w min,
        MAX(AVG(id)) OVER w max, NTILE(2) OVER w FROM t1
    GROUP BY sex HAVING sex=(SELECT c FROM ss LIMIT 1) OR sex='F' OR sex IS NULL
    WINDOW w AS (ORDER BY sex ROWS UNBOUNDED PRECEDING) ORDER BY sex DESC
2024-05-01T14:51:07.243617Z	    9 Query	DROP PREPARE p
2024-05-01T14:51:07.243976Z	    9 Query	DROP TABLE t1,ss
2024-05-01T14:51:08.674873Z	    9 Query	SELECT k, MIN(i), SUM(j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min_wf FROM t
GROUP BY (k) WITH ROLLUP
2024-05-01T14:51:08.677311Z	    9 Query	SELECT k, MIN(i), SUM(j), MAX(k) OVER (ROWS UNBOUNDED PRECEDING) max_wf FROM t
GROUP BY (k) WITH ROLLUP
2024-05-01T14:51:08.679754Z	    9 Query	SELECT k, MIN(i), SUM(j), MIN(k) OVER (ORDER BY k DESC ROWS UNBOUNDED PRECEDING) min_wf FROM t
GROUP BY (k) WITH ROLLUP ORDER BY k DESC
2024-05-01T14:51:08.681492Z	    9 Query	SELECT k, MIN(i), SUM(j), MIN(k) OVER (ROWS UNBOUNDED PRECEDING) min_wf FROM t
GROUP BY k,j WITH ROLLUP
2024-05-01T14:51:08.682990Z	    9 Query	DROP TABLE t
2024-05-01T14:51:09.232035Z	    9 Query	CREATE TABLE t3(t3_id INT, k INT)
2024-05-01T14:51:10.145974Z	    9 Query	INSERT INTO t3 VALUES (0, 0)
2024-05-01T14:51:10.290484Z	    9 Query	INSERT INTO t3 VALUES (0, 0)
2024-05-01T14:51:10.390480Z	    9 Query	INSERT INTO t3 VALUES (2, 0)
2024-05-01T14:51:10.611740Z	    9 Query	INSERT INTO t3 VALUES (2, 0)
2024-05-01T14:51:10.937777Z	    9 Query	INSERT INTO t3 VALUES (4, 0)
2024-05-01T14:51:11.026835Z	    9 Query	INSERT INTO t3 VALUES (4, 0)
2024-05-01T14:51:11.171462Z	    9 Query	INSERT INTO t3 VALUES (6, 0)
2024-05-01T14:51:11.327408Z	    9 Query	INSERT INTO t3 VALUES (6, 0)
2024-05-01T14:51:11.483724Z	    9 Query	INSERT INTO t3 VALUES (8, 0)
2024-05-01T14:51:11.700673Z	    9 Query	INSERT INTO t3 VALUES (8, 0)
2024-05-01T14:51:11.850972Z	    9 Query	INSERT INTO t3 VALUES (1, 1)
2024-05-01T14:51:11.952069Z	    9 Query	INSERT INTO t3 VALUES (1, 1)
2024-05-01T14:51:12.106854Z	    9 Query	INSERT INTO t3 VALUES (3, 1)
2024-05-01T14:51:12.196513Z	    9 Query	INSERT INTO t3 VALUES (3, 1)
2024-05-01T14:51:12.296752Z	    9 Query	INSERT INTO t3 VALUES (5, 1)
2024-05-01T14:51:12.418466Z	    9 Query	INSERT INTO t3 VALUES (5, 1)
2024-05-01T14:51:12.641355Z	    9 Query	INSERT INTO t3 VALUES (7, 1)
2024-05-01T14:51:12.830044Z	    9 Query	INSERT INTO t3 VALUES (7, 1)
2024-05-01T14:51:12.953036Z	    9 Query	INSERT INTO t3 VALUES (9, 1)
2024-05-01T14:51:13.087526Z	    9 Query	INSERT INTO t3 VALUES (9, 1)
2024-05-01T14:51:13.210227Z	    9 Query	SELECT t3_id, MIN(t3_id) OVER w min,
MAX(t3_id) OVER w max,
CUME_DIST() OVER w c_dist,
LEAD(t3_id, 2) OVER w lead2,
NTH_VALUE(t3_id, 3) OVER w nth,
k FROM t3
WINDOW w AS (PARTITION BY k ORDER BY t3_id)
2024-05-01T14:51:13.212784Z	    9 Query	SELECT t3_id, MIN(t3_id) OVER w min,
MAX(t3_id) OVER w max,
CUME_DIST() OVER w c_dist,
LEAD(t3_id, 2) OVER w lead2,
NTH_VALUE(t3_id, 3) OVER w nth,
k FROM t3
WINDOW w AS (PARTITION BY k ORDER BY t3_id RANGE UNBOUNDED PRECEDING)
2024-05-01T14:51:13.214724Z	    9 Query	DROP TABLE t3
2024-05-01T14:51:14.114221Z	    9 Query	CREATE TABLE t(i INT, j INT)
2024-05-01T14:51:14.860060Z	    9 Query	INSERT INTO t VALUES (1,NULL)
2024-05-01T14:51:15.037896Z	    9 Query	INSERT INTO t VALUES (1,NULL)
2024-05-01T14:51:15.149697Z	    9 Query	INSERT INTO t VALUES (1,1)
2024-05-01T14:51:15.271955Z	    9 Query	INSERT INTO t VALUES (1,NULL)
2024-05-01T14:51:15.483376Z	    9 Query	INSERT INTO t VALUES (1,2)
2024-05-01T14:51:15.694151Z	    9 Query	INSERT INTO t VALUES (2,1)
2024-05-01T14:51:15.961692Z	    9 Query	INSERT INTO t VALUES (2,2)
2024-05-01T14:51:16.084469Z	    9 Query	INSERT INTO t VALUES (2,NULL)
2024-05-01T14:51:16.272355Z	    9 Query	INSERT INTO t VALUES (2,NULL)
2024-05-01T14:51:16.368478Z	    9 Query	CREATE TABLE t1 (id INTEGER, sex CHAR(1))
2024-05-01T14:51:17.098622Z	    9 Query	INSERT INTO t1 VALUES (1, 'M')
2024-05-01T14:51:17.221714Z	    9 Query	INSERT INTO t1 VALUES (2, 'F')
2024-05-01T14:51:17.332465Z	    9 Query	INSERT INTO t1 VALUES (3, 'F')
2024-05-01T14:51:17.423336Z	    9 Query	INSERT INTO t1 VALUES (4, 'F')
2024-05-01T14:51:17.599827Z	    9 Query	INSERT INTO t1 VALUES (5, 'M')
2024-05-01T14:51:17.812062Z	    9 Query	CREATE TABLE t2 (user_id INTEGER NOT NULL, date DATE)
2024-05-01T14:51:18.958974Z	    9 Query	INSERT INTO t2 VALUES (1, '2002-06-09')
2024-05-01T14:51:19.125395Z	    9 Query	INSERT INTO t2 VALUES (2, '2002-06-09')
2024-05-01T14:51:19.227235Z	    9 Query	INSERT INTO t2 VALUES (1, '2002-06-09')
2024-05-01T14:51:19.336875Z	    9 Query	INSERT INTO t2 VALUES (3, '2002-06-09')
2024-05-01T14:51:19.437800Z	    9 Query	INSERT INTO t2 VALUES (4, '2002-06-09')
2024-05-01T14:51:19.604822Z	    9 Query	INSERT INTO t2 VALUES (4, '2002-06-09')
2024-05-01T14:51:19.740649Z	    9 Query	INSERT INTO t2 VALUES (5, '2002-06-09')
2024-05-01T14:51:20.152191Z	    9 Query	SELECT t.*, MIN(t.rank) OVER (ROWS UNBOUNDED PRECEDING) min,
MAX(t.rank) OVER (ROWS UNBOUNDED PRECEDING) max FROM
(SELECT sex, id, date, ROW_NUMBER() OVER w AS row_no, RANK() OVER w AS `rank` FROM t1,t2
WHERE t1.id=t2.user_id
WINDOW w AS (PARTITION BY date ORDER BY id)
) AS t
2024-05-01T14:51:20.154440Z	    9 Query	SELECT t1.*, RANK() OVER (ORDER BY sex) `rank`, MIN(id) OVER (ORDER BY sex,id ROWS UNBOUNDED PRECEDING) min FROM t1
2024-05-01T14:51:20.155356Z	    9 Query	SELECT t1.*, PERCENT_RANK() OVER (ORDER BY sex) p_rank, MAX(id) OVER (ORDER BY sex,id ROWS UNBOUNDED PRECEDING) max FROM t1
2024-05-01T14:51:20.156292Z	    9 Query	SELECT t1.*, CUME_DIST() OVER (ORDER BY sex) c_dist, MIN(id) OVER (ORDER BY sex,id ROWS UNBOUNDED PRECEDING) min FROM t1
2024-05-01T14:51:20.157182Z	    9 Query	SELECT * from (SELECT t1.*, MIN(id) OVER (ROWS UNBOUNDED PRECEDING) min, RANK() OVER (ORDER BY sex) `rank` FROM t1) alias ORDER BY id
2024-05-01T14:51:20.158128Z	    9 Query	SELECT * from (SELECT t1.*, MAX(id) OVER (ROWS UNBOUNDED PRECEDING) max, PERCENT_RANK() OVER (ORDER BY sex) p_rank FROM t1) alias ORDER BY id
2024-05-01T14:51:20.159309Z	    9 Query	SELECT * from (SELECT t1.*, MAX(id) OVER (ROWS UNBOUNDED PRECEDING) max, CUME_DIST() OVER (ORDER BY sex) c_dist FROM t1) alias ORDER BY id
2024-05-01T14:51:20.160399Z	    9 Query	SELECT t1.*, MIN(id) OVER (ORDER BY id ROWS UNBOUNDED PRECEDING) min,
MAX(id) OVER (ORDER BY id ROWS UNBOUNDED PRECEDING) max,
RANK() OVER (ORDER BY sex,id) `rank`,
ROW_NUMBER() OVER (ORDER BY sex,id) row_num
FROM t1
2024-05-01T14:51:20.161778Z	    9 Query	SELECT t.*, MIN(id + r00 + r01) OVER (ORDER BY id ROWS UNBOUNDED PRECEDING) AS min,
MAX(id + r00 + r01) OVER (ORDER BY id ROWS UNBOUNDED PRECEDING) AS max FROM (
SELECT t1.*,
RANK() OVER (ORDER BY sex, id) AS r00,
RANK() OVER (ORDER BY sex, id DESC) AS r01,
RANK() OVER (ORDER BY sex, id DESC) AS r02,
RANK() OVER (PARTITION BY id ORDER BY sex) AS r03,
RANK() OVER (ORDER BY sex,id) AS r04,
RANK() OVER (ORDER BY sex,id) AS r05,
RANK() OVER (ORDER BY sex, id) AS r06,
RANK() OVER (ORDER BY sex, id) AS r07,
RANK() OVER (ORDER BY sex, id) AS r08,
RANK() OVER (ORDER BY sex, id) AS r09,
RANK() OVER (ORDER BY sex, id) AS r10,
RANK() OVER (ORDER BY sex, id) AS r11,
RANK() OVER (ORDER BY sex, id) AS r12,
RANK() OVER (ORDER BY sex, id) AS r13,
RANK() OVER (ORDER BY sex, id) AS r14
FROM t1) t
2024-05-01T14:51:20.164548Z	    9 Query	DROP TABLE t
2024-05-01T14:51:21.623806Z	    9 Query	SELECT AVG(id) OVER w, MIN(id) OVER w min, MAX(id) OVER w max FROM t1
WINDOW w AS (PARTITION BY sex)
2024-05-01T14:51:21.625672Z	    9 Query	SELECT * FROM (
SELECT id, SUM(id) OVER w, MIN(id) OVER w min, MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex)
) alias ORDER BY id
2024-05-01T14:51:21.628609Z	    9 Query	SELECT MIN(id) OVER w min FROM t1 WINDOW w AS (PARTITION BY sex)
2024-05-01T14:51:21.630052Z	    9 Query	SELECT MAX(id) OVER w max FROM t1 WINDOW w AS (PARTITION BY sex)
2024-05-01T14:51:21.631672Z	    9 Query	SELECT id, MIN(id) OVER w min, MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING)
2024-05-01T14:51:21.635902Z	    9 Query	CREATE VIEW v AS
SELECT id, SUM(id) OVER w, MIN(id) OVER w min, MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING)
2024-05-01T14:51:21.857386Z	    9 Query	SHOW CREATE VIEW v
2024-05-01T14:51:21.861810Z	    9 Query	SELECT * FROM v
2024-05-01T14:51:21.864219Z	    9 Query	DROP VIEW v
2024-05-01T14:51:22.190253Z	    9 Query	SELECT SUM(id) OVER w, MIN(id) OVER w min,
MAX(id) OVER w max FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING)
2024-05-01T14:51:22.192209Z	    9 Query	SELECT id, SUM(id) OVER w, MIN(id) OVER w min,
MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 1 FOLLOWING AND 2 FOLLOWING)
2024-05-01T14:51:22.194115Z	    9 Query	SELECT SUM(id) OVER w, COUNT(*) OVER w, MIN(id) OVER w min,
MAX(id) OVER w max FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 1 FOLLOWING AND 2 FOLLOWING)
2024-05-01T14:51:22.195854Z	    9 Query	SELECT id, AVG(id) OVER (ROWS UNBOUNDED PRECEDING) avg,
MIN(id) OVER (ROWS UNBOUNDED PRECEDING) min FROM t1
2024-05-01T14:51:22.197068Z	    9 Query	SELECT id, AVG(id) OVER (ROWS UNBOUNDED PRECEDING),
MAX(id) OVER (ROWS UNBOUNDED PRECEDING) max FROM t1
2024-05-01T14:51:22.198188Z	    9 Query	SELECT id, AVG(id) OVER w avg, COUNT(id) OVER w count, MIN(id) OVER w min,
MAX(id) OVER w max FROM t1
WINDOW w AS (ORDER BY id ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)
2024-05-01T14:51:22.199446Z	    9 Query	CREATE TABLE td(d DOUBLE)
2024-05-01T14:51:22.994383Z	    9 Query	INSERT INTO td VALUES (2)
2024-05-01T14:51:23.284650Z	    9 Query	INSERT INTO td VALUES (2)
2024-05-01T14:51:23.429409Z	    9 Query	INSERT INTO td VALUES (3)
2024-05-01T14:51:23.584390Z	    9 Query	INSERT INTO td VALUES (1)
2024-05-01T14:51:23.674363Z	    9 Query	INSERT INTO td VALUES (1.2)
2024-05-01T14:51:23.785764Z	    9 Query	INSERT INTO td VALUES (NULL)
2024-05-01T14:51:24.041008Z	    9 Query	SELECT d, MIN(d) OVER (ORDER BY d) min, MAX(d) OVER (ORDER BY d) max FROM td
2024-05-01T14:51:24.042069Z	    9 Query	SELECT d, MIN(d) OVER () min, MAX(d) OVER () max FROM td
2024-05-01T14:51:24.042702Z	    9 Query	SELECT d, MIN(d) OVER (ORDER BY d ROWS BETWEEN 2 PRECEDING AND 1 FOLLOWING) min FROM td
2024-05-01T14:51:24.043530Z	    9 Query	SELECT d, MAX(d) OVER (ORDER BY d ROWS BETWEEN 2 PRECEDING AND 1 FOLLOWING) max FROM td
2024-05-01T14:51:24.044291Z	    9 Query	TRUNCATE td
2024-05-01T14:51:25.580704Z	    9 Query	INSERT INTO td VALUES (10)
2024-05-01T14:51:25.670353Z	    9 Query	INSERT INTO td VALUES (1)
2024-05-01T14:51:25.771056Z	    9 Query	INSERT INTO td VALUES (2)
2024-05-01T14:51:25.981540Z	    9 Query	INSERT INTO td VALUES (3)
2024-05-01T14:51:26.203718Z	    9 Query	INSERT INTO td VALUES (4)
2024-05-01T14:51:26.355232Z	    9 Query	INSERT INTO td VALUES (5)
2024-05-01T14:51:26.483145Z	    9 Query	INSERT INTO td VALUES (6)
2024-05-01T14:51:26.583607Z	    9 Query	INSERT INTO td VALUES (7)
2024-05-01T14:51:26.749632Z	    9 Query	INSERT INTO td VALUES (8)
2024-05-01T14:51:26.973157Z	    9 Query	INSERT INTO td VALUES (9)
2024-05-01T14:51:27.185216Z	    9 Query	SELECT d, MIN(d) OVER w min, MAX(d) OVER w max FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN 2 PRECEDING AND CURRENT ROW)
2024-05-01T14:51:27.186652Z	    9 Query	SELECT d, SUM(d) OVER w sum, MIN(d) OVER w min, MAX(d) OVER w max FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN 2 PRECEDING AND 2 FOLLOWING)
2024-05-01T14:51:27.187993Z	    9 Query	SELECT d, SUM(d) OVER w sum, MIN(d) OVER w min, MAX(d) OVER w max FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN CURRENT ROW AND 2 FOLLOWING)
2024-05-01T14:51:27.189279Z	    9 Query	INSERT INTO td SELECT * FROM td
2024-05-01T14:51:27.462201Z	    9 Query	SELECT d, SUM(d) OVER w sum, MAX(d) OVER w max, MIN(d) OVER w min FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN 2 PRECEDING AND CURRENT ROW)
2024-05-01T14:51:27.465391Z	    9 Query	SELECT d, SUM(d) OVER w sum, MAX(d) OVER w max, MIN(d) OVER w min FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN 2 PRECEDING AND 2 FOLLOWING)
2024-05-01T14:51:27.468075Z	    9 Query	SELECT d, SUM(d) OVER w sum, MAX(d) OVER w max, MIN(d) OVER w min FROM td
WINDOW w AS (ORDER BY d RANGE BETWEEN CURRENT ROW AND 2 FOLLOWING)
2024-05-01T14:51:27.470485Z	    9 Query	DROP TABLE td
2024-05-01T14:51:28.218800Z	    9 Query	SELECT ROW_NUMBER() OVER w `row_number`, id, MIN(id) OVER w min, MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)
2024-05-01T14:51:28.219330Z	    9 Query	SELECT ROW_NUMBER() OVER w `row_number`, MIN(id) OVER w min,
MAX(id) OVER w max FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 1 FOLLOWING AND 2 FOLLOWING)
2024-05-01T14:51:28.219686Z	    9 Query	INSERT INTO t1 VALUES (10, NULL)
2024-05-01T14:51:28.308596Z	    9 Query	SELECT RANK() OVER w `rank`, id, MIN(id) OVER w min, MAX(id) OVER w max, sex FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id)
2024-05-01T14:51:28.310675Z	    9 Query	SELECT RANK() OVER w `rank`, MIN(id) OVER w min,
MAX(id) OVER w max FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id
ROWS BETWEEN 1 FOLLOWING AND 2 FOLLOWING)
2024-05-01T14:51:28.313227Z	    9 Query	SELECT id, sex, MIN(id) OVER w min,
MAX(id) OVER w max,
ROW_NUMBER() OVER w `row_number`,
RANK() OVER w  `rank` FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING)
2024-05-01T14:51:28.315555Z	    9 Query	SELECT id, sex, MIN(id) OVER w min,
MAX(id) OVER w max,
ROW_NUMBER() OVER w `row_number`,
CUME_DIST() OVER w  `cume_dist` FROM t1
WINDOW w AS (PARTITION BY sex ORDER BY id ROWS BETWEEN 2 PRECEDING AND 1 PRECEDING)
2024-05-01T14:51:28.317821Z	    9 Query	CREATE TABLE t11 (id INTEGER, sex CHAR(1), p INTEGER DEFAULT 1)
2024-05-01T14:51:29.296387Z	    9 Query	INSERT INTO t11(id, sex) SELECT * FROM t1
2024-05-01T14:51:29.518092Z	    9 Query	UPDATE t11 SET p=p+1
2024-05-01T14:51:29.640570Z	    9 Query	INSERT INTO t11(id, sex) SELECT * FROM t1
2024-05-01T14:51:29.821650Z	    9 Query	CREATE TABLE t22 (user_id INTEGER NOT NULL, date DATE, p INTEGER DEFAULT 1)
2024-05-01T14:51:30.868877Z	    9 Query	INSERT INTO t22(user_id, date) SELECT * FROM t2
2024-05-01T14:51:31.397363Z	    9 Query	UPDATE t22 SET p=p+1
2024-05-01T14:51:31.589396Z	    9 Query	INSERT INTO t22(user_id, date) SELECT * FROM t2
2024-05-01T14:51:32.266945Z	    9 Query	SELECT id, MIN(id) OVER (ORDER BY id RANGE 2 PRECEDING) min FROM t1 ORDER BY id
2024-05-01T14:51:32.268979Z	    9 Query	SELECT id, MIN(id) OVER (ORDER BY id RANGE 2 PRECEDING) max FROM t1 ORDER BY id
2024-05-01T14:51:32.270183Z	    9 Query	SELECT id, MIN(id) OVER (ORDER BY id RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) min FROM t1 ORDER BY id
2024-05-01T14:51:32.271386Z	    9 Query	SELECT id, MAX(id) OVER (ORDER BY id RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) max FROM t1 ORDER BY id
2024-05-01T14:51:32.272425Z	    9 Query	SELECT id, MIN(id) OVER (ORDER BY id RANGE UNBOUNDED PRECEDING) min FROM t1 ORDER BY id
2024-05-01T14:51:32.273343Z	    9 Query	SELECT id, MAX(id) OVER (ORDER BY id RANGE UNBOUNDED PRECEDING) max FROM t1 ORDER BY id
2024-05-01T14:51:32.274233Z	    9 Query	SELECT p, id, MIN(id) OVER (PARTITION BY p ORDER BY id RANGE 2 PRECEDING) min FROM t11 ORDER BY p,id
2024-05-01T14:51:32.275367Z	    9 Query	SELECT p, id, MAX(id) OVER (PARTITION BY p ORDER BY id RANGE 2 PRECEDING) max FROM t11 ORDER BY p,id
2024-05-01T14:51:32.276452Z	    9 Query	SELECT p, id, MIN(id) OVER (PARTITION BY p ORDER BY id RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) min FROM t11 ORDER BY p,id
2024-05-01T14:51:32.277583Z	    9 Query	SELECT p, id, MAX(id) OVER (PARTITION BY p ORDER BY id RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) max FROM t11 ORDER BY p,id
2024-05-01T14:51:32.279067Z	    9 Query	SELECT p, id, MIN(id) OVER (PARTITION BY p ORDER BY id RANGE UNBOUNDED PRECEDING) min FROM t11 ORDER BY p,id
2024-05-01T14:51:32.280319Z	    9 Query	SELECT p, id, MAX(id) OVER (PARTITION BY p ORDER BY id RANGE UNBOUNDED PRECEDING) max FROM t11 ORDER BY p,id
2024-05-01T14:51:32.281530Z	    9 Query	SELECT user_id, MIN(user_id) OVER w, MAX(user_id) OVER w FROM t2 WINDOW w AS (ORDER BY user_id)
2024-05-01T14:51:32.282548Z	    9 Query	SELECT p, user_id, MIN(user_id) OVER w, MAX(user_id) OVER w FROM t22 WINDOW w AS (PARTITION BY p ORDER BY user_id) ORDER BY p
2024-05-01T14:51:32.283729Z	    9 Query	SELECT user_id, MIN(user_id) OVER w, MAX(user_id) OVER w1 FROM t2
WINDOW w AS (ORDER BY user_id), w1 AS (ORDER BY user_id)
2024-05-01T14:51:32.284984Z	    9 Query	SELECT NTILE(5) OVER w, ROW_NUMBER() OVER w, id, MIN(id) OVER w FROM t1
WINDOW w AS (ORDER BY id DESC RANGE 2 PRECEDING)
2024-05-01T14:51:32.285956Z	    9 Query	SELECT p, NTILE(5) OVER w, ROW_NUMBER() OVER w, id, MAX(id) OVER w FROM t11
WINDOW w AS (PARTITION BY p ORDER BY id DESC RANGE 2 PRECEDING)
2024-05-01T14:51:32.287332Z	    9 Query	SELECT NTILE(5) OVER w, ROW_NUMBER() OVER w, id, MIN(id) OVER w FROM t1
WINDOW w AS (ORDER BY id DESC RANGE INTERVAL 2 MONTH PRECEDING)
2024-05-01T14:51:32.288087Z	    9 Query	DROP TABLE t11,t22,t1,t2
2024-05-01T14:51:33.371011Z	    9 Query	CREATE TABLE t3(d DOUBLE)
2024-05-01T14:51:34.748511Z	    9 Query	INSERT INTO t3 VALUES (1.1)
2024-05-01T14:51:34.896942Z	    9 Query	INSERT INTO t3 VALUES (1.9)
2024-05-01T14:51:35.150228Z	    9 Query	INSERT INTO t3 VALUES (4.0)
2024-05-01T14:51:35.343085Z	    9 Query	INSERT INTO t3 VALUES (8.3)
2024-05-01T14:51:35.454101Z	    9 Query	INSERT INTO t3 VALUES (16.0)
2024-05-01T14:51:35.664850Z	    9 Query	INSERT INTO t3 VALUES (24.0)
2024-05-01T14:51:35.843918Z	    9 Query	INSERT INTO t3 VALUES (20.1)
2024-05-01T14:51:36.065563Z	    9 Query	INSERT INTO t3 VALUES (22.0)
2024-05-01T14:51:36.200348Z	    9 Query	INSERT INTO t3 VALUES (23.0)
2024-05-01T14:51:36.289424Z	    9 Query	SELECT d, MIN(d) OVER w min, MAX(d) OVER w max, COUNT(*) OVER w
FROM t3 WINDOW w AS (ORDER BY d RANGE BETWEEN 2.1 PRECEDING AND 1.1 FOLLOWING)
2024-05-01T14:51:36.290674Z	    9 Query	DROP TABLE t3
2024-05-01T14:51:37.094107Z	    9 Query	CREATE TABLE tj(j JSON, i INT DEFAULT 7)
2024-05-01T14:51:37.950294Z	    9 Query	INSERT INTO tj(j) VALUES ('1')
2024-05-01T14:51:38.083756Z	    9 Query	INSERT INTO tj(j) VALUES ('2')
2024-05-01T14:51:38.207224Z	    9 Query	INSERT INTO tj(j) VALUES ('3')
2024-05-01T14:51:38.329661Z	    9 Query	INSERT INTO tj(j) VALUES ('4')
2024-05-01T14:51:38.446238Z	    9 Query	INSERT INTO tj(j) VALUES ('5')
2024-05-01T14:51:38.619998Z	    9 Query	INSERT INTO tj(j) VALUES (NULL)
2024-05-01T14:51:38.860013Z	    9 Query	INSERT INTO tj(j) VALUES ('3.14')
2024-05-01T14:51:39.196740Z	    9 Query	INSERT INTO tj(j) VALUES ('[1,2,3]')
2024-05-01T14:51:39.274211Z	    9 Query	INSERT INTO tj(j) VALUES (NULL)
2024-05-01T14:51:39.375574Z	    9 Query	SELECT MIN(j) OVER () AS JSON FROM tj
2024-05-01T14:51:39.376520Z	    9 Query	SELECT j, JSON_TYPE(j), MIN(j) OVER (ORDER BY j ROWS 3 PRECEDING) FROM tj
2024-05-01T14:51:39.377177Z	    9 Query	SHOW WARNINGS
2024-05-01T14:51:39.377573Z	    9 Query	SELECT j, JSON_TYPE(j), MAX(j) OVER (ORDER BY j ROWS 3 PRECEDING) FROM tj
2024-05-01T14:51:39.378272Z	    9 Query	SHOW WARNINGS
2024-05-01T14:51:39.378959Z	    9 Query	SELECT j, JSON_TYPE(j), JSON_TYPE(MIN(j) OVER (ORDER BY j RANGE 3 PRECEDING)) FROM tj
2024-05-01T14:51:39.379312Z	    9 Query	INSERT INTO tj(j) VALUES ('3.14')
2024-05-01T14:51:39.690670Z	    9 Query	SELECT j, JSON_TYPE(j), JSON_TYPE(MAX(j) OVER (ORDER BY j ROWS 3 PRECEDING)) FROM tj
2024-05-01T14:51:39.692347Z	    9 Query	SHOW WARNINGS
2024-05-01T14:51:39.693026Z	    9 Query	INSERT INTO tj(j) VALUES ('[1,2,3]')
2024-05-01T14:51:39.887192Z	    9 Query	SELECT j,
JSON_TYPE(j),
MIN(CASE WHEN JSON_TYPE(j) = 'ARRAY' THEN j->"$[0]" ELSE j END)
OVER (ORDER BY j ROWS 3 PRECEDING)
FROM tj
2024-05-01T14:51:39.889175Z	    9 Query	SHOW WARNINGS
2024-05-01T14:51:39.889755Z	    9 Query	SELECT DISTINCT i,NTILE(3) OVER (ORDER BY i), MAX(i) OVER (), COUNT(*) OVER () FROM tj ORDER BY NTILE(3) OVER (ORDER BY i)
2024-05-01T14:51:39.892029Z	    9 Query	UPDATE tj SET i=i+CASE WHEN JSON_TYPE(j) = 'ARRAY' THEN 1 ELSE j END
2024-05-01T14:51:39.965838Z	    9 Query	UPDATE tj SET i=7 where i=8 AND JSON_TYPE(j) != 'ARRAY'
2024-05-01T14:51:40.099933Z	    9 Query	CREATE TABLE tj2 AS SELECT * FROM tj
2024-05-01T14:51:41.214036Z	    9 Query	UPDATE tj2 SET i=MOD(i,3)
2024-05-01T14:51:41.336914Z	    9 Query	SELECT * FROM tj2
2024-05-01T14:51:41.337297Z	    9 Query	SELECT          COUNT(*) OVER (), MOD(MIN(i),2) FROM tj2 GROUP BY i
2024-05-01T14:51:41.337802Z	    9 Query	SELECT DISTINCT COUNT(*) OVER (), MOD(MAX(i),2) FROM tj2 GROUP BY i
2024-05-01T14:51:41.338591Z	    9 Query	SELECT i, MIN(i) OVER (), MOD(MIN(i),2) FROM tj2 GROUP BY i
2024-05-01T14:51:41.339699Z	    9 Query	SELECT i, MAX(MAX(i)) OVER (), MAX(i) OVER (ORDER BY i), MOD(MAX(i),2), MAX(i) FROM tj2 GROUP BY i
2024-05-01T14:51:41.340514Z	    9 Query	SELECT i, MIN(i) OVER (ORDER BY i) FROM tj UNION ALL SELECT i, MIN(i) OVER (ORDER BY i) FROM tj
2024-05-01T14:51:41.341376Z	    9 Query	SELECT j,CAST(MIN(j) OVER (PARTITION BY i) AS JSON), CAST(MAX(j) OVER () AS JSON) FROM tj
2024-05-01T14:51:41.342244Z	    9 Query	SELECT j,CAST(MIN(j) OVER (PARTITION BY i ROWS UNBOUNDED PRECEDING) AS JSON), CAST(MAX(j) OVER (PARTITION BY i ROWS UNBOUNDED PRECEDING) AS JSON) FROM tj
2024-05-01T14:51:41.343643Z	    9 Query	DROP TABLE tj,tj2
2024-05-01T14:51:42.294933Z	    9 Query	CREATE TABLE t1 (i INTEGER, j INTEGER)
2024-05-01T14:51:43.545820Z	    9 Query	INSERT INTO t1 VALUES (NULL,3),(NULL,3),(NULL,30),(NULL,30),(4,3),
(2,5),(3,7),(1,10),(5,20),(3,30)
2024-05-01T14:51:43.773070Z	    9 Query	SELECT i, j, MIN(i) OVER (PARTITION BY j ORDER BY i) FROM t1
2024-05-01T14:51:43.773489Z	    9 Query	DROP TABLE t1
2024-05-01T14:51:44.658978Z	    9 Query	CREATE TABLE t1(a INT)
2024-05-01T14:51:45.507851Z	    9 Query	INSERT INTO t1 VALUES(1),(1),(1),(1),(NULL),(NULL),(NULL),(NULL)
2024-05-01T14:51:45.792323Z	    9 Query	SELECT a, MAX(a) OVER (ORDER BY a DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) FROM t1
2024-05-01T14:51:45.792835Z	    9 Query	SELECT a, MAX(a) OVER (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM t1
2024-05-01T14:51:45.793297Z	    9 Query	SELECT a, MIN(a) OVER (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) FROM t1
2024-05-01T14:51:45.793813Z	    9 Query	TRUNCATE t1
2024-05-01T14:51:47.400546Z	    9 Query	INSERT INTO t1 VALUES (2), (1), (4), (3), (NULL), (NULL), (NULL), (NULL)
2024-05-01T14:51:47.568485Z	    9 Query	SELECT a, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:51:47.569856Z	    9 Query	SELECT a, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:51:47.571345Z	    9 Query	SELECT a, COUNT(a) OVER w, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:51:47.572534Z	    9 Query	SELECT a, COUNT(a) OVER w, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:51:47.573799Z	    9 Query	SELECT a, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:51:47.574998Z	    9 Query	SELECT a, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:51:47.576204Z	    9 Query	SELECT a, COUNT(a) OVER w, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:51:47.577474Z	    9 Query	SELECT a, COUNT(a) OVER w, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:51:47.578660Z	    9 Query	SELECT a, MIN(a) OVER w min, MAX(a) OVER w max FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)
2024-05-01T14:51:47.579830Z	    9 Query	SELECT a, MIN(a) OVER w min, MAX(a) OVER w max FROM t1 WINDOW w AS (ORDER BY a RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:51:47.580837Z	    9 Query	TRUNCATE t1
2024-05-01T14:51:49.238897Z	    9 Query	INSERT INTO t1 VALUES (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL)
2024-05-01T14:51:49.348942Z	    9 Query	SELECT a, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:51:49.349384Z	    9 Query	SELECT a, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:51:49.349767Z	    9 Query	SELECT a, COUNT(a) OVER w, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:51:49.350138Z	    9 Query	SELECT a, COUNT(a) OVER w, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:51:49.350479Z	    9 Query	SELECT a, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:51:49.350809Z	    9 Query	SELECT a, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING)
2024-05-01T14:51:49.351237Z	    9 Query	SELECT a, COUNT(a) OVER w, MAX(a) OVER w, MIN(a) OVER w FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:51:49.351701Z	    9 Query	SELECT a, COUNT(a) OVER w, MIN(a) OVER w                FROM t1 WINDOW w AS (ORDER BY a DESC RANGE BETWEEN 1 PRECEDING AND CURRENT ROW)
2024-05-01T14:51:49.352086Z	    9 Query	DROP TABLE t1
2024-05-01T14:51:50.132348Z	    9 Query	SELECT MIN(DATE'2000-01-01') OVER () AS c1,
MIN(TIME'12:00:00') OVER () AS c2,
MIN(TIMESTAMP'2000-01-01 12:00:00') OVER () AS c3,
JSON_ARRAY(MIN(CAST('123' AS JSON)) OVER ()) AS c4,
MIN(DATE'2000-01-01') OVER () = DATE'2000-01-01' AS c5,
MIN(TIME'12:00:00') OVER () = TIME '12:00:00' AS c6,
MIN(TIMESTAMP'2000-01-01 12:00:00') OVER () =
TIMESTAMP'2000-01-01 12:00:00' AS c7
2024-05-01T14:51:50.152039Z	    9 Query	SHOW WARNINGS
2024-05-01T14:51:50.153606Z	    9 Quit	
